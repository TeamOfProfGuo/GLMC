Namespace(dataset='cifar10', root='../dataset/', arch='resnet32', num_classes=10, imbanlance_rate=0.01, lr=0.01, epochs=200, batch_size=64, momentum=0.9, resample_weighting=0.0, label_weighting=1.2, contrast_weight=4, beta=0.5, loss='vs', eps=0.05, seed=3407, print_freq=1000, gpu=0, workers=4, resume=None, start_epoch=0, root_model='./output/', store_name='cifar10_resnet32/0.01/name_2023-11-29', debug=10, knn=True, weight_decay=0.005, category_image_counts=[5000, 5000, 5000, 5000, 5000, 50, 50, 50, 50, 50], gamma=0.15, tau=1.25)
Use GPU: 0 for training
=> creating model 'resnet32'
  + Number of params: 7.44M
Files already downloaded and verified
Files already downloaded and verified
load cifar10
Training started!
Epoch: [1/200][0/395], Time 7.402 (7.402), Loss 2.6159 (2.6159)
11/29 10:57 EPOCH: 1 Train: Time 0.295 (0.062), Loss 1.0456 (1.2574)
===> Calculating KNN centroids.
Test: [0/157], Time 0.234 (0.234), Prec@1 25.000 (25.000), Prec@5 92.188 (92.188)
11/29 10:58 EPOCH: 1 Val: Prec@1 35.330 Prec@5 90.500
11/29 10:58 many acc 46.38, med acc 24.28, few acc 0.00
Best Prec@1: 35.330

Epoch: [2/200][0/395], Time 0.088 (0.088), Loss 0.9256 (0.9256)
11/29 10:58 EPOCH: 2 Train: Time 0.037 (0.043), Loss 1.0290 (0.8665)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 53.125 (53.125), Prec@5 95.312 (95.312)
11/29 10:58 EPOCH: 2 Val: Prec@1 40.660 Prec@5 92.590
11/29 10:58 many acc 58.74, med acc 22.58, few acc 0.00
Best Prec@1: 40.660

Epoch: [3/200][0/395], Time 0.098 (0.098), Loss 0.6152 (0.6152)
11/29 10:58 EPOCH: 3 Train: Time 0.037 (0.043), Loss 0.8611 (0.7005)
===> Calculating KNN centroids.
Test: [0/157], Time 0.050 (0.050), Prec@1 54.688 (54.688), Prec@5 93.750 (93.750)
11/29 10:58 EPOCH: 3 Val: Prec@1 43.230 Prec@5 93.530
11/29 10:58 many acc 61.44, med acc 25.02, few acc 0.00
Best Prec@1: 43.230

Epoch: [4/200][0/395], Time 0.065 (0.065), Loss 0.5329 (0.5329)
11/29 10:59 EPOCH: 4 Train: Time 0.037 (0.043), Loss 0.6240 (0.6038)
===> Calculating KNN centroids.
Test: [0/157], Time 0.052 (0.052), Prec@1 82.812 (82.812), Prec@5 92.188 (92.188)
11/29 10:59 EPOCH: 4 Val: Prec@1 47.910 Prec@5 94.990
11/29 10:59 many acc 65.94, med acc 29.88, few acc 0.00
Best Prec@1: 47.910

Epoch: [5/200][0/395], Time 0.087 (0.087), Loss 0.5219 (0.5219)
11/29 10:59 EPOCH: 5 Train: Time 0.037 (0.043), Loss 0.8080 (0.5421)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 71.875 (71.875), Prec@5 93.750 (93.750)
11/29 10:59 EPOCH: 5 Val: Prec@1 50.580 Prec@5 95.020
11/29 10:59 many acc 67.88, med acc 33.28, few acc 0.00
Best Prec@1: 50.580

Epoch: [6/200][0/395], Time 0.094 (0.094), Loss 0.5937 (0.5937)
11/29 10:59 EPOCH: 6 Train: Time 0.037 (0.043), Loss 0.3945 (0.4904)
===> Calculating KNN centroids.
Test: [0/157], Time 0.059 (0.059), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/29 11:00 EPOCH: 6 Val: Prec@1 51.730 Prec@5 95.640
11/29 11:00 many acc 72.14, med acc 31.32, few acc 0.00
Best Prec@1: 51.730

Epoch: [7/200][0/395], Time 0.110 (0.110), Loss 0.8696 (0.8696)
11/29 11:00 EPOCH: 7 Train: Time 0.037 (0.043), Loss 0.3334 (0.4652)
===> Calculating KNN centroids.
Test: [0/157], Time 0.058 (0.058), Prec@1 81.250 (81.250), Prec@5 93.750 (93.750)
11/29 11:00 EPOCH: 7 Val: Prec@1 53.260 Prec@5 96.500
11/29 11:00 many acc 69.06, med acc 37.46, few acc 0.00
Best Prec@1: 53.260

Epoch: [8/200][0/395], Time 0.092 (0.092), Loss 0.4890 (0.4890)
11/29 11:00 EPOCH: 8 Train: Time 0.037 (0.043), Loss 0.6343 (0.4507)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 56.250 (56.250), Prec@5 98.438 (98.438)
11/29 11:00 EPOCH: 8 Val: Prec@1 54.400 Prec@5 96.560
11/29 11:00 many acc 70.36, med acc 38.44, few acc 0.00
Best Prec@1: 54.400

Epoch: [9/200][0/395], Time 0.089 (0.089), Loss 0.2750 (0.2750)
11/29 11:01 EPOCH: 9 Train: Time 0.037 (0.043), Loss 0.3406 (0.4202)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 82.812 (82.812), Prec@5 95.312 (95.312)
11/29 11:01 EPOCH: 9 Val: Prec@1 56.100 Prec@5 96.590
11/29 11:01 many acc 74.24, med acc 37.96, few acc 0.00
Best Prec@1: 56.100

Epoch: [10/200][0/395], Time 0.103 (0.103), Loss 0.3236 (0.3236)
11/29 11:01 EPOCH: 10 Train: Time 0.037 (0.043), Loss 0.3947 (0.4161)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_9.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_9.png
11/29 11:01 Loss:9.457, Acc:0.39, NC1:40.717,
Wnorm:[1.307,1.489,1.297,1.109,1.321,0.488,0.409,0.443,0.524,0.535]
Hnorm:[3.783,5.311,2.874,3.027,3.643,2.686,1.632,1.796,2.454,2.577]
Wcos:[-0.160,-0.155,-0.138,-0.106,-0.123,-0.033,-0.019,-0.028,-0.091,-0.077]
WHcos:[0.860,0.802,0.928,0.842,0.899,0.771,0.406,0.594,0.772,0.830]
===> Calculating KNN centroids.
Test: [0/157], Time 0.059 (0.059), Prec@1 78.125 (78.125), Prec@5 96.875 (96.875)
11/29 11:02 EPOCH: 10 Val: Prec@1 55.290 Prec@5 96.150
11/29 11:02 many acc 76.02, med acc 34.56, few acc 0.00
Best Prec@1: 56.100

Epoch: [11/200][0/395], Time 0.093 (0.093), Loss 0.3917 (0.3917)
11/29 11:02 EPOCH: 11 Train: Time 0.037 (0.043), Loss 0.6091 (0.4034)
===> Calculating KNN centroids.
Test: [0/157], Time 0.059 (0.059), Prec@1 85.938 (85.938), Prec@5 98.438 (98.438)
11/29 11:02 EPOCH: 11 Val: Prec@1 51.920 Prec@5 96.370
11/29 11:02 many acc 75.42, med acc 28.42, few acc 0.00
Best Prec@1: 56.100

Epoch: [12/200][0/395], Time 0.087 (0.087), Loss 0.2952 (0.2952)
11/29 11:02 EPOCH: 12 Train: Time 0.037 (0.043), Loss 0.3123 (0.3921)
===> Calculating KNN centroids.
Test: [0/157], Time 0.056 (0.056), Prec@1 79.688 (79.688), Prec@5 96.875 (96.875)
11/29 11:02 EPOCH: 12 Val: Prec@1 53.500 Prec@5 96.600
11/29 11:02 many acc 76.86, med acc 30.14, few acc 0.00
Best Prec@1: 56.100

Epoch: [13/200][0/395], Time 0.073 (0.073), Loss 0.3515 (0.3515)
11/29 11:03 EPOCH: 13 Train: Time 0.037 (0.043), Loss 0.6439 (0.3992)
===> Calculating KNN centroids.
Test: [0/157], Time 0.049 (0.049), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/29 11:03 EPOCH: 13 Val: Prec@1 52.130 Prec@5 95.470
11/29 11:03 many acc 71.26, med acc 33.00, few acc 0.00
Best Prec@1: 56.100

Epoch: [14/200][0/395], Time 0.090 (0.090), Loss 0.3342 (0.3342)
11/29 11:03 EPOCH: 14 Train: Time 0.037 (0.043), Loss 0.5145 (0.3908)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 81.250 (81.250), Prec@5 93.750 (93.750)
11/29 11:03 EPOCH: 14 Val: Prec@1 51.200 Prec@5 95.090
11/29 11:03 many acc 75.52, med acc 26.88, few acc 0.00
Best Prec@1: 56.100

Epoch: [15/200][0/395], Time 0.102 (0.102), Loss 0.4847 (0.4847)
11/29 11:04 EPOCH: 15 Train: Time 0.037 (0.043), Loss 0.3160 (0.3765)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 79.688 (79.688), Prec@5 95.312 (95.312)
11/29 11:04 EPOCH: 15 Val: Prec@1 52.270 Prec@5 96.230
11/29 11:04 many acc 73.52, med acc 31.02, few acc 0.00
Best Prec@1: 56.100

Epoch: [16/200][0/395], Time 0.092 (0.092), Loss 0.3055 (0.3055)
11/29 11:04 EPOCH: 16 Train: Time 0.037 (0.043), Loss 0.4991 (0.3749)
===> Calculating KNN centroids.
Test: [0/157], Time 0.050 (0.050), Prec@1 87.500 (87.500), Prec@5 98.438 (98.438)
11/29 11:04 EPOCH: 16 Val: Prec@1 53.580 Prec@5 96.280
11/29 11:04 many acc 75.64, med acc 31.52, few acc 0.00
Best Prec@1: 56.100

Epoch: [17/200][0/395], Time 0.094 (0.094), Loss 0.3739 (0.3739)
11/29 11:04 EPOCH: 17 Train: Time 0.037 (0.043), Loss 0.7834 (0.3793)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 90.625 (90.625), Prec@5 93.750 (93.750)
11/29 11:05 EPOCH: 17 Val: Prec@1 51.460 Prec@5 96.010
11/29 11:05 many acc 76.16, med acc 26.76, few acc 0.00
Best Prec@1: 56.100

Epoch: [18/200][0/395], Time 0.081 (0.081), Loss 0.5212 (0.5212)
11/29 11:05 EPOCH: 18 Train: Time 0.037 (0.043), Loss 0.4523 (0.3731)
===> Calculating KNN centroids.
Test: [0/157], Time 0.059 (0.059), Prec@1 79.688 (79.688), Prec@5 96.875 (96.875)
11/29 11:05 EPOCH: 18 Val: Prec@1 56.860 Prec@5 96.800
11/29 11:05 many acc 76.62, med acc 37.10, few acc 0.00
Best Prec@1: 56.860

Epoch: [19/200][0/395], Time 0.104 (0.104), Loss 0.1492 (0.1492)
11/29 11:05 EPOCH: 19 Train: Time 0.037 (0.043), Loss 0.2803 (0.3667)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 79.688 (79.688), Prec@5 95.312 (95.312)
11/29 11:05 EPOCH: 19 Val: Prec@1 54.420 Prec@5 96.570
11/29 11:05 many acc 76.84, med acc 32.00, few acc 0.00
Best Prec@1: 56.860

Epoch: [20/200][0/395], Time 0.090 (0.090), Loss 0.2339 (0.2339)
11/29 11:06 EPOCH: 20 Train: Time 0.037 (0.043), Loss 0.2522 (0.3578)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_19.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_19.png
11/29 11:06 Loss:8.933, Acc:0.54, NC1:51.672,
Wnorm:[1.482,1.631,1.491,1.274,1.497,0.442,0.323,0.362,0.452,0.492]
Hnorm:[2.957,4.819,2.349,1.858,2.809,1.789,1.466,1.233,1.738,1.893]
Wcos:[-0.204,-0.203,-0.177,-0.131,-0.155,0.031,0.041,0.040,-0.044,-0.023]
WHcos:[0.882,0.858,0.922,0.861,0.916,0.675,0.465,0.521,0.749,0.751]
===> Calculating KNN centroids.
Test: [0/157], Time 0.057 (0.057), Prec@1 75.000 (75.000), Prec@5 95.312 (95.312)
11/29 11:06 EPOCH: 20 Val: Prec@1 50.370 Prec@5 96.040
11/29 11:06 many acc 75.72, med acc 25.02, few acc 0.00
Best Prec@1: 56.860

Epoch: [21/200][0/395], Time 0.081 (0.081), Loss 0.2367 (0.2367)
11/29 11:06 EPOCH: 21 Train: Time 0.037 (0.043), Loss 0.5728 (0.3635)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 84.375 (84.375), Prec@5 96.875 (96.875)
11/29 11:06 EPOCH: 21 Val: Prec@1 56.590 Prec@5 96.650
11/29 11:06 many acc 74.48, med acc 38.70, few acc 0.00
Best Prec@1: 56.860

Epoch: [22/200][0/395], Time 0.092 (0.092), Loss 0.3556 (0.3556)
11/29 11:07 EPOCH: 22 Train: Time 0.037 (0.043), Loss 0.3545 (0.3531)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 65.625 (65.625), Prec@5 96.875 (96.875)
11/29 11:07 EPOCH: 22 Val: Prec@1 54.080 Prec@5 96.460
11/29 11:07 many acc 77.32, med acc 30.84, few acc 0.00
Best Prec@1: 56.860

Epoch: [23/200][0/395], Time 0.101 (0.101), Loss 0.3811 (0.3811)
11/29 11:07 EPOCH: 23 Train: Time 0.037 (0.043), Loss 0.2702 (0.3518)
===> Calculating KNN centroids.
Test: [0/157], Time 0.057 (0.057), Prec@1 70.312 (70.312), Prec@5 96.875 (96.875)
11/29 11:07 EPOCH: 23 Val: Prec@1 53.480 Prec@5 95.390
11/29 11:07 many acc 77.56, med acc 29.40, few acc 0.00
Best Prec@1: 56.860

Epoch: [24/200][0/395], Time 0.099 (0.099), Loss 0.4042 (0.4042)
11/29 11:08 EPOCH: 24 Train: Time 0.037 (0.043), Loss 0.2906 (0.3552)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 70.312 (70.312), Prec@5 96.875 (96.875)
11/29 11:08 EPOCH: 24 Val: Prec@1 53.350 Prec@5 96.350
11/29 11:08 many acc 73.94, med acc 32.76, few acc 0.00
Best Prec@1: 56.860

Epoch: [25/200][0/395], Time 0.100 (0.100), Loss 0.3980 (0.3980)
11/29 11:08 EPOCH: 25 Train: Time 0.037 (0.043), Loss 0.1807 (0.3461)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 84.375 (84.375), Prec@5 96.875 (96.875)
11/29 11:08 EPOCH: 25 Val: Prec@1 51.890 Prec@5 96.110
11/29 11:08 many acc 79.12, med acc 24.66, few acc 0.00
Best Prec@1: 56.860

Epoch: [26/200][0/395], Time 0.074 (0.074), Loss 0.4216 (0.4216)
11/29 11:08 EPOCH: 26 Train: Time 0.037 (0.043), Loss 0.3411 (0.3493)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 81.250 (81.250), Prec@5 96.875 (96.875)
11/29 11:09 EPOCH: 26 Val: Prec@1 54.020 Prec@5 96.490
11/29 11:09 many acc 77.58, med acc 30.46, few acc 0.00
Best Prec@1: 56.860

Epoch: [27/200][0/395], Time 0.100 (0.100), Loss 0.2720 (0.2720)
11/29 11:09 EPOCH: 27 Train: Time 0.037 (0.043), Loss 0.1606 (0.3463)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 89.062 (89.062), Prec@5 98.438 (98.438)
11/29 11:09 EPOCH: 27 Val: Prec@1 50.410 Prec@5 95.400
11/29 11:09 many acc 77.52, med acc 23.30, few acc 0.00
Best Prec@1: 56.860

Epoch: [28/200][0/395], Time 0.097 (0.097), Loss 0.2252 (0.2252)
11/29 11:09 EPOCH: 28 Train: Time 0.037 (0.043), Loss 0.4439 (0.3449)
===> Calculating KNN centroids.
Test: [0/157], Time 0.056 (0.056), Prec@1 89.062 (89.062), Prec@5 98.438 (98.438)
11/29 11:09 EPOCH: 28 Val: Prec@1 57.620 Prec@5 96.770
11/29 11:09 many acc 80.44, med acc 34.80, few acc 0.00
Best Prec@1: 57.620

Epoch: [29/200][0/395], Time 0.091 (0.091), Loss 0.2681 (0.2681)
11/29 11:10 EPOCH: 29 Train: Time 0.037 (0.043), Loss 0.2171 (0.3422)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 90.625 (90.625), Prec@5 93.750 (93.750)
11/29 11:10 EPOCH: 29 Val: Prec@1 53.910 Prec@5 96.510
11/29 11:10 many acc 80.96, med acc 26.86, few acc 0.00
Best Prec@1: 57.620

Epoch: [30/200][0/395], Time 0.097 (0.097), Loss 0.3719 (0.3719)
11/29 11:10 EPOCH: 30 Train: Time 0.037 (0.043), Loss 0.5602 (0.3384)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_29.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_29.png
11/29 11:10 Loss:9.206, Acc:0.49, NC1:45.978,
Wnorm:[1.476,1.609,1.493,1.294,1.497,0.426,0.337,0.368,0.439,0.486]
Hnorm:[3.046,4.058,3.147,2.443,3.449,1.967,1.469,1.783,2.094,1.916]
Wcos:[-0.207,-0.207,-0.182,-0.137,-0.164,0.036,0.046,0.047,-0.028,-0.012]
WHcos:[0.928,0.875,0.916,0.862,0.903,0.760,0.475,0.569,0.701,0.744]
===> Calculating KNN centroids.
Test: [0/157], Time 0.049 (0.049), Prec@1 81.250 (81.250), Prec@5 100.000 (100.000)
11/29 11:11 EPOCH: 30 Val: Prec@1 53.640 Prec@5 96.680
11/29 11:11 many acc 80.18, med acc 27.10, few acc 0.00
Best Prec@1: 57.620

Epoch: [31/200][0/395], Time 0.103 (0.103), Loss 0.4065 (0.4065)
11/29 11:11 EPOCH: 31 Train: Time 0.037 (0.043), Loss 0.4924 (0.3338)
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 71.875 (71.875), Prec@5 98.438 (98.438)
11/29 11:11 EPOCH: 31 Val: Prec@1 54.810 Prec@5 97.000
11/29 11:11 many acc 78.44, med acc 31.18, few acc 0.00
Best Prec@1: 57.620

Epoch: [32/200][0/395], Time 0.105 (0.105), Loss 0.4044 (0.4044)
11/29 11:11 EPOCH: 32 Train: Time 0.037 (0.043), Loss 0.3932 (0.3384)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 78.125 (78.125), Prec@5 96.875 (96.875)
11/29 11:11 EPOCH: 32 Val: Prec@1 51.200 Prec@5 94.590
11/29 11:11 many acc 72.40, med acc 30.00, few acc 0.00
Best Prec@1: 57.620

Epoch: [33/200][0/395], Time 0.086 (0.086), Loss 0.2152 (0.2152)
11/29 11:12 EPOCH: 33 Train: Time 0.037 (0.043), Loss 0.2872 (0.3280)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 81.250 (81.250), Prec@5 93.750 (93.750)
11/29 11:12 EPOCH: 33 Val: Prec@1 54.540 Prec@5 96.710
11/29 11:12 many acc 81.22, med acc 27.86, few acc 0.00
Best Prec@1: 57.620

Epoch: [34/200][0/395], Time 0.084 (0.084), Loss 0.5092 (0.5092)
11/29 11:12 EPOCH: 34 Train: Time 0.037 (0.043), Loss 0.1777 (0.3225)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 84.375 (84.375), Prec@5 95.312 (95.312)
11/29 11:12 EPOCH: 34 Val: Prec@1 53.540 Prec@5 96.710
11/29 11:12 many acc 79.02, med acc 28.06, few acc 0.00
Best Prec@1: 57.620

Epoch: [35/200][0/395], Time 0.095 (0.095), Loss 0.3874 (0.3874)
11/29 11:13 EPOCH: 35 Train: Time 0.037 (0.043), Loss 0.2753 (0.3275)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 79.688 (79.688), Prec@5 98.438 (98.438)
11/29 11:13 EPOCH: 35 Val: Prec@1 58.170 Prec@5 97.900
11/29 11:13 many acc 77.70, med acc 38.64, few acc 0.00
Best Prec@1: 58.170

Epoch: [36/200][0/395], Time 0.097 (0.097), Loss 0.1819 (0.1819)
11/29 11:13 EPOCH: 36 Train: Time 0.037 (0.043), Loss 0.3167 (0.3220)
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 76.562 (76.562), Prec@5 96.875 (96.875)
11/29 11:13 EPOCH: 36 Val: Prec@1 55.500 Prec@5 96.660
11/29 11:13 many acc 78.34, med acc 32.66, few acc 0.00
Best Prec@1: 58.170

Epoch: [37/200][0/395], Time 0.099 (0.099), Loss 0.2561 (0.2561)
11/29 11:13 EPOCH: 37 Train: Time 0.037 (0.043), Loss 0.1384 (0.3258)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 68.750 (68.750), Prec@5 100.000 (100.000)
11/29 11:13 EPOCH: 37 Val: Prec@1 54.740 Prec@5 97.200
11/29 11:13 many acc 77.98, med acc 31.50, few acc 0.00
Best Prec@1: 58.170

Epoch: [38/200][0/395], Time 0.100 (0.100), Loss 0.1793 (0.1793)
11/29 11:14 EPOCH: 38 Train: Time 0.037 (0.043), Loss 0.5020 (0.3216)
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 85.938 (85.938), Prec@5 100.000 (100.000)
11/29 11:14 EPOCH: 38 Val: Prec@1 55.770 Prec@5 97.150
11/29 11:14 many acc 80.98, med acc 30.56, few acc 0.00
Best Prec@1: 58.170

Epoch: [39/200][0/395], Time 0.097 (0.097), Loss 0.6094 (0.6094)
11/29 11:14 EPOCH: 39 Train: Time 0.037 (0.043), Loss 0.0865 (0.3224)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 54.688 (54.688), Prec@5 95.312 (95.312)
11/29 11:14 EPOCH: 39 Val: Prec@1 56.760 Prec@5 95.860
11/29 11:14 many acc 71.00, med acc 42.52, few acc 0.00
Best Prec@1: 58.170

Epoch: [40/200][0/395], Time 0.101 (0.101), Loss 0.3692 (0.3692)
11/29 11:15 EPOCH: 40 Train: Time 0.037 (0.043), Loss 0.2547 (0.3183)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_39.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_39.png
11/29 11:15 Loss:9.403, Acc:0.49, NC1:37.809,
Wnorm:[1.468,1.620,1.474,1.302,1.477,0.430,0.320,0.368,0.446,0.507]
Hnorm:[2.835,4.232,2.753,2.697,2.683,2.141,1.244,1.388,1.955,2.371]
Wcos:[-0.208,-0.212,-0.175,-0.133,-0.158,0.030,0.041,0.044,-0.032,-0.018]
WHcos:[0.917,0.934,0.977,0.889,0.885,0.836,0.382,0.872,0.588,0.927]
===> Calculating KNN centroids.
Test: [0/157], Time 0.076 (0.076), Prec@1 75.000 (75.000), Prec@5 96.875 (96.875)
11/29 11:15 EPOCH: 40 Val: Prec@1 56.340 Prec@5 96.640
11/29 11:15 many acc 75.74, med acc 36.94, few acc 0.00
Best Prec@1: 58.170

Epoch: [41/200][0/395], Time 0.104 (0.104), Loss 0.2895 (0.2895)
11/29 11:15 EPOCH: 41 Train: Time 0.037 (0.043), Loss 0.6791 (0.3159)
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/29 11:15 EPOCH: 41 Val: Prec@1 54.680 Prec@5 95.840
11/29 11:15 many acc 82.84, med acc 26.52, few acc 0.00
Best Prec@1: 58.170

Epoch: [42/200][0/395], Time 0.088 (0.088), Loss 0.2793 (0.2793)
11/29 11:16 EPOCH: 42 Train: Time 0.037 (0.043), Loss 0.4525 (0.3156)
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/29 11:16 EPOCH: 42 Val: Prec@1 54.200 Prec@5 95.790
11/29 11:16 many acc 72.76, med acc 35.64, few acc 0.00
Best Prec@1: 58.170

Epoch: [43/200][0/395], Time 0.074 (0.074), Loss 0.3647 (0.3647)
11/29 11:16 EPOCH: 43 Train: Time 0.037 (0.043), Loss 0.2834 (0.3081)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 81.250 (81.250), Prec@5 98.438 (98.438)
11/29 11:16 EPOCH: 43 Val: Prec@1 54.870 Prec@5 96.090
11/29 11:16 many acc 75.38, med acc 34.36, few acc 0.00
Best Prec@1: 58.170

Epoch: [44/200][0/395], Time 0.108 (0.108), Loss 0.2781 (0.2781)
11/29 11:17 EPOCH: 44 Train: Time 0.037 (0.043), Loss 0.2282 (0.3115)
===> Calculating KNN centroids.
Test: [0/157], Time 0.050 (0.050), Prec@1 82.812 (82.812), Prec@5 96.875 (96.875)
11/29 11:17 EPOCH: 44 Val: Prec@1 59.660 Prec@5 97.560
11/29 11:17 many acc 81.66, med acc 37.66, few acc 0.00
Best Prec@1: 59.660

Epoch: [45/200][0/395], Time 0.105 (0.105), Loss 0.2720 (0.2720)
11/29 11:17 EPOCH: 45 Train: Time 0.037 (0.043), Loss 0.3274 (0.3133)
===> Calculating KNN centroids.
Test: [0/157], Time 0.058 (0.058), Prec@1 81.250 (81.250), Prec@5 96.875 (96.875)
11/29 11:17 EPOCH: 45 Val: Prec@1 54.970 Prec@5 95.940
11/29 11:17 many acc 77.78, med acc 32.16, few acc 0.00
Best Prec@1: 59.660

Epoch: [46/200][0/395], Time 0.108 (0.108), Loss 0.2653 (0.2653)
11/29 11:17 EPOCH: 46 Train: Time 0.037 (0.043), Loss 0.4044 (0.3144)
===> Calculating KNN centroids.
Test: [0/157], Time 0.057 (0.057), Prec@1 76.562 (76.562), Prec@5 95.312 (95.312)
11/29 11:18 EPOCH: 46 Val: Prec@1 55.830 Prec@5 95.980
11/29 11:18 many acc 78.96, med acc 32.70, few acc 0.00
Best Prec@1: 59.660

Epoch: [47/200][0/395], Time 0.081 (0.081), Loss 0.2515 (0.2515)
11/29 11:18 EPOCH: 47 Train: Time 0.037 (0.043), Loss 0.6074 (0.3060)
===> Calculating KNN centroids.
Test: [0/157], Time 0.050 (0.050), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/29 11:18 EPOCH: 47 Val: Prec@1 58.130 Prec@5 97.540
11/29 11:18 many acc 82.86, med acc 33.40, few acc 0.00
Best Prec@1: 59.660

Epoch: [48/200][0/395], Time 0.066 (0.066), Loss 0.2862 (0.2862)
11/29 11:18 EPOCH: 48 Train: Time 0.037 (0.043), Loss 0.2958 (0.3011)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 79.688 (79.688), Prec@5 96.875 (96.875)
11/29 11:18 EPOCH: 48 Val: Prec@1 57.260 Prec@5 97.220
11/29 11:18 many acc 77.70, med acc 36.82, few acc 0.00
Best Prec@1: 59.660

Epoch: [49/200][0/395], Time 0.086 (0.086), Loss 0.2296 (0.2296)
11/29 11:19 EPOCH: 49 Train: Time 0.037 (0.043), Loss 0.3651 (0.3027)
===> Calculating KNN centroids.
Test: [0/157], Time 0.072 (0.072), Prec@1 82.812 (82.812), Prec@5 95.312 (95.312)
11/29 11:19 EPOCH: 49 Val: Prec@1 55.870 Prec@5 96.520
11/29 11:19 many acc 82.04, med acc 29.70, few acc 0.00
Best Prec@1: 59.660

Epoch: [50/200][0/395], Time 0.100 (0.100), Loss 0.2541 (0.2541)
11/29 11:19 EPOCH: 50 Train: Time 0.037 (0.043), Loss 0.6287 (0.2998)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_49.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_49.png
11/29 11:19 Loss:9.783, Acc:0.51, NC1:32.839,
Wnorm:[1.498,1.609,1.477,1.282,1.483,0.426,0.326,0.368,0.444,0.521]
Hnorm:[3.189,4.433,2.681,2.966,3.235,2.107,1.434,1.386,2.291,2.277]
Wcos:[-0.210,-0.215,-0.175,-0.128,-0.158,0.032,0.042,0.046,-0.036,-0.019]
WHcos:[0.927,0.938,0.962,0.911,0.953,0.767,0.463,0.676,0.928,0.942]
11/29 11:19 -- Has saved the NC analysis result to ./output/cifar10_resnet32/0.01/name_2023-11-29/analysis49.pkl
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 81.250 (81.250), Prec@5 96.875 (96.875)
11/29 11:19 EPOCH: 50 Val: Prec@1 57.520 Prec@5 96.770
11/29 11:19 many acc 78.24, med acc 36.80, few acc 0.00
Best Prec@1: 59.660

Epoch: [51/200][0/395], Time 0.061 (0.061), Loss 0.2987 (0.2987)
11/29 11:20 EPOCH: 51 Train: Time 0.037 (0.043), Loss 0.2811 (0.2985)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 81.250 (81.250), Prec@5 95.312 (95.312)
11/29 11:20 EPOCH: 51 Val: Prec@1 58.820 Prec@5 97.170
11/29 11:20 many acc 83.30, med acc 34.34, few acc 0.00
Best Prec@1: 59.660

Epoch: [52/200][0/395], Time 0.099 (0.099), Loss 0.2568 (0.2568)
11/29 11:20 EPOCH: 52 Train: Time 0.037 (0.043), Loss 0.1844 (0.3011)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 78.125 (78.125), Prec@5 95.312 (95.312)
11/29 11:20 EPOCH: 52 Val: Prec@1 60.020 Prec@5 97.540
11/29 11:20 many acc 79.76, med acc 40.28, few acc 0.00
Best Prec@1: 60.020

Epoch: [53/200][0/395], Time 0.109 (0.109), Loss 0.2734 (0.2734)
11/29 11:21 EPOCH: 53 Train: Time 0.037 (0.043), Loss 0.3636 (0.2981)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/29 11:21 EPOCH: 53 Val: Prec@1 52.480 Prec@5 96.700
11/29 11:21 many acc 78.50, med acc 26.46, few acc 0.00
Best Prec@1: 60.020

Epoch: [54/200][0/395], Time 0.089 (0.089), Loss 0.2395 (0.2395)
11/29 11:21 EPOCH: 54 Train: Time 0.037 (0.043), Loss 0.2781 (0.2962)
===> Calculating KNN centroids.
Test: [0/157], Time 0.056 (0.056), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/29 11:21 EPOCH: 54 Val: Prec@1 52.820 Prec@5 96.110
11/29 11:21 many acc 80.74, med acc 24.90, few acc 0.00
Best Prec@1: 60.020

Epoch: [55/200][0/395], Time 0.101 (0.101), Loss 0.2513 (0.2513)
11/29 11:21 EPOCH: 55 Train: Time 0.037 (0.043), Loss 0.5879 (0.2920)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 87.500 (87.500), Prec@5 95.312 (95.312)
11/29 11:22 EPOCH: 55 Val: Prec@1 57.490 Prec@5 97.210
11/29 11:22 many acc 79.40, med acc 35.58, few acc 0.00
Best Prec@1: 60.020

Epoch: [56/200][0/395], Time 0.100 (0.100), Loss 0.2549 (0.2549)
11/29 11:22 EPOCH: 56 Train: Time 0.037 (0.043), Loss 0.4740 (0.2897)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 75.000 (75.000), Prec@5 98.438 (98.438)
11/29 11:22 EPOCH: 56 Val: Prec@1 59.340 Prec@5 97.700
11/29 11:22 many acc 82.28, med acc 36.40, few acc 0.00
Best Prec@1: 60.020

Epoch: [57/200][0/395], Time 0.097 (0.097), Loss 0.3789 (0.3789)
11/29 11:22 EPOCH: 57 Train: Time 0.037 (0.043), Loss 0.4651 (0.2917)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/29 11:22 EPOCH: 57 Val: Prec@1 58.190 Prec@5 97.420
11/29 11:22 many acc 83.98, med acc 32.40, few acc 0.00
Best Prec@1: 60.020

Epoch: [58/200][0/395], Time 0.088 (0.088), Loss 0.1948 (0.1948)
11/29 11:23 EPOCH: 58 Train: Time 0.037 (0.043), Loss 0.3677 (0.2943)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/29 11:23 EPOCH: 58 Val: Prec@1 60.190 Prec@5 97.990
11/29 11:23 many acc 83.48, med acc 36.90, few acc 0.00
Best Prec@1: 60.190

Epoch: [59/200][0/395], Time 0.084 (0.084), Loss 0.2823 (0.2823)
11/29 11:23 EPOCH: 59 Train: Time 0.037 (0.043), Loss 0.4559 (0.2879)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/29 11:23 EPOCH: 59 Val: Prec@1 56.380 Prec@5 96.270
11/29 11:23 many acc 80.18, med acc 32.58, few acc 0.00
Best Prec@1: 60.190

Epoch: [60/200][0/395], Time 0.096 (0.096), Loss 0.2026 (0.2026)
11/29 11:24 EPOCH: 60 Train: Time 0.037 (0.043), Loss 0.2961 (0.2840)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_59.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_59.png
11/29 11:24 Loss:7.362, Acc:0.63, NC1:25.801,
Wnorm:[1.518,1.617,1.482,1.294,1.489,0.424,0.320,0.375,0.457,0.517]
Hnorm:[2.772,3.970,2.889,2.502,3.394,1.551,1.335,1.330,1.638,2.342]
Wcos:[-0.215,-0.214,-0.173,-0.124,-0.158,0.033,0.042,0.046,-0.038,-0.018]
WHcos:[0.953,0.925,0.957,0.900,0.926,0.667,0.503,0.756,0.753,0.870]
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/29 11:24 EPOCH: 60 Val: Prec@1 55.100 Prec@5 96.740
11/29 11:24 many acc 84.86, med acc 25.34, few acc 0.00
Best Prec@1: 60.190

Epoch: [61/200][0/395], Time 0.092 (0.092), Loss 0.3220 (0.3220)
11/29 11:24 EPOCH: 61 Train: Time 0.037 (0.043), Loss 0.4492 (0.2908)
===> Calculating KNN centroids.
Test: [0/157], Time 0.056 (0.056), Prec@1 82.812 (82.812), Prec@5 96.875 (96.875)
11/29 11:24 EPOCH: 61 Val: Prec@1 61.110 Prec@5 97.680
11/29 11:24 many acc 81.92, med acc 40.30, few acc 0.00
Best Prec@1: 61.110

Epoch: [62/200][0/395], Time 0.098 (0.098), Loss 0.1259 (0.1259)
11/29 11:25 EPOCH: 62 Train: Time 0.037 (0.043), Loss 0.3232 (0.2811)
===> Calculating KNN centroids.
Test: [0/157], Time 0.050 (0.050), Prec@1 73.438 (73.438), Prec@5 95.312 (95.312)
11/29 11:25 EPOCH: 62 Val: Prec@1 59.260 Prec@5 97.190
11/29 11:25 many acc 80.26, med acc 38.26, few acc 0.00
Best Prec@1: 61.110

Epoch: [63/200][0/395], Time 0.093 (0.093), Loss 0.1845 (0.1845)
11/29 11:25 EPOCH: 63 Train: Time 0.037 (0.043), Loss 0.2637 (0.2883)
===> Calculating KNN centroids.
Test: [0/157], Time 0.081 (0.081), Prec@1 92.188 (92.188), Prec@5 98.438 (98.438)
11/29 11:25 EPOCH: 63 Val: Prec@1 58.810 Prec@5 97.390
11/29 11:25 many acc 84.32, med acc 33.30, few acc 0.00
Best Prec@1: 61.110

Epoch: [64/200][0/395], Time 0.092 (0.092), Loss 0.2545 (0.2545)
11/29 11:26 EPOCH: 64 Train: Time 0.037 (0.043), Loss 0.1112 (0.2750)
===> Calculating KNN centroids.
Test: [0/157], Time 0.053 (0.053), Prec@1 78.125 (78.125), Prec@5 95.312 (95.312)
11/29 11:26 EPOCH: 64 Val: Prec@1 59.520 Prec@5 97.290
11/29 11:26 many acc 79.98, med acc 39.06, few acc 0.00
Best Prec@1: 61.110

Epoch: [65/200][0/395], Time 0.110 (0.110), Loss 0.3226 (0.3226)
11/29 11:26 EPOCH: 65 Train: Time 0.037 (0.043), Loss 0.3021 (0.2806)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 82.812 (82.812), Prec@5 95.312 (95.312)
11/29 11:26 EPOCH: 65 Val: Prec@1 61.150 Prec@5 97.730
11/29 11:26 many acc 84.12, med acc 38.18, few acc 0.00
Best Prec@1: 61.150

Epoch: [66/200][0/395], Time 0.112 (0.112), Loss 0.4423 (0.4423)
11/29 11:26 EPOCH: 66 Train: Time 0.037 (0.043), Loss 0.3102 (0.2777)
===> Calculating KNN centroids.
Test: [0/157], Time 0.073 (0.073), Prec@1 89.062 (89.062), Prec@5 98.438 (98.438)
11/29 11:27 EPOCH: 66 Val: Prec@1 58.020 Prec@5 97.420
11/29 11:27 many acc 83.88, med acc 32.16, few acc 0.00
Best Prec@1: 61.150

Epoch: [67/200][0/395], Time 0.093 (0.093), Loss 0.1290 (0.1290)
11/29 11:27 EPOCH: 67 Train: Time 0.037 (0.043), Loss 0.4258 (0.2722)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 82.812 (82.812), Prec@5 96.875 (96.875)
11/29 11:27 EPOCH: 67 Val: Prec@1 60.860 Prec@5 97.290
11/29 11:27 many acc 80.26, med acc 41.46, few acc 0.00
Best Prec@1: 61.150

Epoch: [68/200][0/395], Time 0.089 (0.089), Loss 0.1878 (0.1878)
11/29 11:27 EPOCH: 68 Train: Time 0.037 (0.043), Loss 0.1559 (0.2757)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 90.625 (90.625), Prec@5 98.438 (98.438)
11/29 11:27 EPOCH: 68 Val: Prec@1 58.710 Prec@5 97.250
11/29 11:27 many acc 83.86, med acc 33.56, few acc 0.00
Best Prec@1: 61.150

Epoch: [69/200][0/395], Time 0.110 (0.110), Loss 0.2231 (0.2231)
11/29 11:28 EPOCH: 69 Train: Time 0.037 (0.043), Loss 0.3698 (0.2718)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 89.062 (89.062), Prec@5 100.000 (100.000)
11/29 11:28 EPOCH: 69 Val: Prec@1 58.210 Prec@5 96.240
11/29 11:28 many acc 80.62, med acc 35.80, few acc 0.00
Best Prec@1: 61.150

Epoch: [70/200][0/395], Time 0.094 (0.094), Loss 0.1553 (0.1553)
11/29 11:28 EPOCH: 70 Train: Time 0.037 (0.043), Loss 0.4067 (0.2662)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_69.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_69.png
11/29 11:28 Loss:10.293, Acc:0.55, NC1:26.240,
Wnorm:[1.520,1.614,1.464,1.304,1.504,0.417,0.323,0.383,0.470,0.492]
Hnorm:[3.643,3.901,3.737,3.445,2.953,2.842,1.467,1.726,3.366,6.277]
Wcos:[-0.214,-0.214,-0.168,-0.125,-0.164,0.033,0.039,0.045,-0.031,-0.018]
WHcos:[0.947,0.963,0.939,0.948,0.955,0.635,0.389,0.822,0.923,0.954]
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 84.375 (84.375), Prec@5 93.750 (93.750)
11/29 11:28 EPOCH: 70 Val: Prec@1 57.580 Prec@5 96.420
11/29 11:28 many acc 75.26, med acc 39.90, few acc 0.00
Best Prec@1: 61.150

Epoch: [71/200][0/395], Time 0.089 (0.089), Loss 0.2390 (0.2390)
11/29 11:29 EPOCH: 71 Train: Time 0.037 (0.043), Loss 0.3494 (0.2691)
===> Calculating KNN centroids.
Test: [0/157], Time 0.055 (0.055), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/29 11:29 EPOCH: 71 Val: Prec@1 57.200 Prec@5 97.700
11/29 11:29 many acc 83.76, med acc 30.64, few acc 0.00
Best Prec@1: 61.150

Epoch: [72/200][0/395], Time 0.093 (0.093), Loss 0.2161 (0.2161)
11/29 11:29 EPOCH: 72 Train: Time 0.037 (0.043), Loss 0.1584 (0.2615)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/29 11:29 EPOCH: 72 Val: Prec@1 60.010 Prec@5 96.950
11/29 11:29 many acc 83.58, med acc 36.44, few acc 0.00
Best Prec@1: 61.150

Epoch: [73/200][0/395], Time 0.108 (0.108), Loss 0.3961 (0.3961)
11/29 11:30 EPOCH: 73 Train: Time 0.037 (0.043), Loss 0.3512 (0.2659)
===> Calculating KNN centroids.
Test: [0/157], Time 0.058 (0.058), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/29 11:30 EPOCH: 73 Val: Prec@1 52.270 Prec@5 96.370
11/29 11:30 many acc 82.34, med acc 22.20, few acc 0.00
Best Prec@1: 61.150

Epoch: [74/200][0/395], Time 0.061 (0.061), Loss 0.3835 (0.3835)
11/29 11:30 EPOCH: 74 Train: Time 0.037 (0.043), Loss 0.4182 (0.2619)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 84.375 (84.375), Prec@5 98.438 (98.438)
11/29 11:30 EPOCH: 74 Val: Prec@1 63.200 Prec@5 97.970
11/29 11:30 many acc 82.64, med acc 43.76, few acc 0.00
Best Prec@1: 63.200

Epoch: [75/200][0/395], Time 0.075 (0.075), Loss 0.3220 (0.3220)
11/29 11:30 EPOCH: 75 Train: Time 0.037 (0.043), Loss 0.2828 (0.2565)
===> Calculating KNN centroids.
Test: [0/157], Time 0.049 (0.049), Prec@1 89.062 (89.062), Prec@5 98.438 (98.438)
11/29 11:31 EPOCH: 75 Val: Prec@1 62.220 Prec@5 97.430
11/29 11:31 many acc 84.72, med acc 39.72, few acc 0.00
Best Prec@1: 63.200

Epoch: [76/200][0/395], Time 0.099 (0.099), Loss 0.1225 (0.1225)
11/29 11:31 EPOCH: 76 Train: Time 0.037 (0.043), Loss 0.2960 (0.2553)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 82.812 (82.812), Prec@5 93.750 (93.750)
11/29 11:31 EPOCH: 76 Val: Prec@1 57.920 Prec@5 96.540
11/29 11:31 many acc 78.68, med acc 37.16, few acc 0.00
Best Prec@1: 63.200

Epoch: [77/200][0/395], Time 0.078 (0.078), Loss 0.2465 (0.2465)
11/29 11:31 EPOCH: 77 Train: Time 0.037 (0.043), Loss 0.4121 (0.2607)
===> Calculating KNN centroids.
Test: [0/157], Time 0.051 (0.051), Prec@1 92.188 (92.188), Prec@5 98.438 (98.438)
11/29 11:31 EPOCH: 77 Val: Prec@1 58.600 Prec@5 97.820
11/29 11:31 many acc 86.80, med acc 30.40, few acc 0.00
Best Prec@1: 63.200

Epoch: [78/200][0/395], Time 0.098 (0.098), Loss 0.1667 (0.1667)
11/29 11:32 EPOCH: 78 Train: Time 0.037 (0.043), Loss 0.2107 (0.2538)
===> Calculating KNN centroids.
Test: [0/157], Time 0.051 (0.051), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/29 11:32 EPOCH: 78 Val: Prec@1 61.380 Prec@5 97.860
11/29 11:32 many acc 85.26, med acc 37.50, few acc 0.00
Best Prec@1: 63.200

Epoch: [79/200][0/395], Time 0.065 (0.065), Loss 0.2740 (0.2740)
11/29 11:32 EPOCH: 79 Train: Time 0.037 (0.043), Loss 0.4167 (0.2526)
===> Calculating KNN centroids.
Test: [0/157], Time 0.051 (0.051), Prec@1 89.062 (89.062), Prec@5 98.438 (98.438)
11/29 11:32 EPOCH: 79 Val: Prec@1 61.050 Prec@5 97.010
11/29 11:32 many acc 83.92, med acc 38.18, few acc 0.00
Best Prec@1: 63.200

Epoch: [80/200][0/395], Time 0.095 (0.095), Loss 0.1886 (0.1886)
11/29 11:33 EPOCH: 80 Train: Time 0.037 (0.043), Loss 0.1755 (0.2508)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_79.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_79.png
11/29 11:33 Loss:7.347, Acc:0.64, NC1:25.932,
Wnorm:[1.534,1.590,1.462,1.311,1.493,0.424,0.333,0.381,0.469,0.477]
Hnorm:[3.874,4.776,3.855,3.394,3.502,2.226,1.981,2.365,4.384,4.070]
Wcos:[-0.214,-0.210,-0.172,-0.130,-0.166,0.030,0.041,0.047,-0.024,-0.016]
WHcos:[0.964,0.976,0.964,0.952,0.958,0.787,0.237,0.894,0.971,0.939]
===> Calculating KNN centroids.
Test: [0/157], Time 0.054 (0.054), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/29 11:33 EPOCH: 80 Val: Prec@1 63.180 Prec@5 97.450
11/29 11:33 many acc 85.82, med acc 40.54, few acc 0.00
Best Prec@1: 63.200

Epoch: [81/200][0/395], Time 0.079 (0.079), Loss 0.2582 (0.2582)
11/29 11:33 EPOCH: 81 Train: Time 0.037 (0.043), Loss 0.1141 (0.2381)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/29 11:33 EPOCH: 81 Val: Prec@1 61.320 Prec@5 96.700
11/29 11:33 many acc 84.72, med acc 37.92, few acc 0.00
Best Prec@1: 63.200

Epoch: [82/200][0/395], Time 0.075 (0.075), Loss 0.3026 (0.3026)
11/29 11:34 EPOCH: 82 Train: Time 0.037 (0.043), Loss 0.3647 (0.2552)
===> Calculating KNN centroids.
Test: [0/157], Time 0.059 (0.059), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/29 11:34 EPOCH: 82 Val: Prec@1 56.200 Prec@5 96.590
11/29 11:34 many acc 84.46, med acc 27.94, few acc 0.00
Best Prec@1: 63.200

Epoch: [83/200][0/395], Time 0.082 (0.082), Loss 0.1156 (0.1156)
11/29 11:34 EPOCH: 83 Train: Time 0.037 (0.043), Loss 0.1776 (0.2392)
===> Calculating KNN centroids.
Test: [0/157], Time 0.056 (0.056), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 11:34 EPOCH: 83 Val: Prec@1 60.440 Prec@5 97.010
11/29 11:34 many acc 87.14, med acc 33.74, few acc 0.00
Best Prec@1: 63.200

Epoch: [84/200][0/395], Time 0.098 (0.098), Loss 0.2275 (0.2275)
11/29 11:34 EPOCH: 84 Train: Time 0.037 (0.043), Loss 0.1768 (0.2466)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 90.625 (90.625), Prec@5 98.438 (98.438)
11/29 11:35 EPOCH: 84 Val: Prec@1 61.330 Prec@5 97.600
11/29 11:35 many acc 86.00, med acc 36.66, few acc 0.00
Best Prec@1: 63.200

Epoch: [85/200][0/395], Time 0.068 (0.068), Loss 0.1521 (0.1521)
11/29 11:35 EPOCH: 85 Train: Time 0.037 (0.043), Loss 0.4474 (0.2381)
===> Calculating KNN centroids.
Test: [0/157], Time 0.051 (0.051), Prec@1 87.500 (87.500), Prec@5 98.438 (98.438)
11/29 11:35 EPOCH: 85 Val: Prec@1 58.870 Prec@5 96.410
11/29 11:35 many acc 82.48, med acc 35.26, few acc 0.00
Best Prec@1: 63.200

Epoch: [86/200][0/395], Time 0.080 (0.080), Loss 0.1266 (0.1266)
11/29 11:35 EPOCH: 86 Train: Time 0.037 (0.043), Loss 0.4075 (0.2406)
===> Calculating KNN centroids.
Test: [0/157], Time 0.049 (0.049), Prec@1 89.062 (89.062), Prec@5 98.438 (98.438)
11/29 11:35 EPOCH: 86 Val: Prec@1 59.750 Prec@5 97.850
11/29 11:35 many acc 86.80, med acc 32.70, few acc 0.00
Best Prec@1: 63.200

Epoch: [87/200][0/395], Time 0.087 (0.087), Loss 0.3314 (0.3314)
11/29 11:36 EPOCH: 87 Train: Time 0.037 (0.043), Loss 0.1162 (0.2420)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 79.688 (79.688), Prec@5 96.875 (96.875)
11/29 11:36 EPOCH: 87 Val: Prec@1 62.290 Prec@5 97.630
11/29 11:36 many acc 83.96, med acc 40.62, few acc 0.00
Best Prec@1: 63.200

Epoch: [88/200][0/395], Time 0.096 (0.096), Loss 0.2232 (0.2232)
11/29 11:36 EPOCH: 88 Train: Time 0.037 (0.043), Loss 0.2160 (0.2367)
===> Calculating KNN centroids.
Test: [0/157], Time 0.053 (0.053), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/29 11:36 EPOCH: 88 Val: Prec@1 60.530 Prec@5 97.940
11/29 11:36 many acc 85.12, med acc 35.94, few acc 0.00
Best Prec@1: 63.200

Epoch: [89/200][0/395], Time 0.064 (0.064), Loss 0.5507 (0.5507)
11/29 11:37 EPOCH: 89 Train: Time 0.037 (0.043), Loss 0.1239 (0.2355)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/29 11:37 EPOCH: 89 Val: Prec@1 62.050 Prec@5 96.100
11/29 11:37 many acc 82.46, med acc 41.64, few acc 0.00
Best Prec@1: 63.200

Epoch: [90/200][0/395], Time 0.091 (0.091), Loss 0.1571 (0.1571)
11/29 11:37 EPOCH: 90 Train: Time 0.037 (0.043), Loss 0.3316 (0.2302)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_89.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_89.png
11/29 11:37 Loss:7.248, Acc:0.66, NC1:25.838,
Wnorm:[1.532,1.592,1.478,1.309,1.510,0.427,0.329,0.386,0.449,0.473]
Hnorm:[3.618,4.256,4.464,3.284,3.902,1.353,1.440,1.616,4.110,6.086]
Wcos:[-0.214,-0.210,-0.175,-0.131,-0.170,0.033,0.042,0.049,-0.019,-0.009]
WHcos:[0.927,0.955,0.958,0.943,0.943,0.726,-0.027,0.891,0.933,0.924]
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 90.625 (90.625), Prec@5 98.438 (98.438)
11/29 11:37 EPOCH: 90 Val: Prec@1 59.560 Prec@5 97.150
11/29 11:37 many acc 84.66, med acc 34.46, few acc 0.00
Best Prec@1: 63.200

Epoch: [91/200][0/395], Time 0.096 (0.096), Loss 0.2152 (0.2152)
11/29 11:38 EPOCH: 91 Train: Time 0.037 (0.043), Loss 0.1969 (0.2245)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/29 11:38 EPOCH: 91 Val: Prec@1 58.330 Prec@5 97.280
11/29 11:38 many acc 85.38, med acc 31.28, few acc 0.00
Best Prec@1: 63.200

Epoch: [92/200][0/395], Time 0.101 (0.101), Loss 0.4350 (0.4350)
11/29 11:38 EPOCH: 92 Train: Time 0.037 (0.043), Loss 0.2255 (0.2247)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/29 11:38 EPOCH: 92 Val: Prec@1 60.350 Prec@5 97.990
11/29 11:38 many acc 86.64, med acc 34.06, few acc 0.00
Best Prec@1: 63.200

Epoch: [93/200][0/395], Time 0.097 (0.097), Loss 0.1682 (0.1682)
11/29 11:39 EPOCH: 93 Train: Time 0.037 (0.043), Loss 0.1022 (0.2242)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 84.375 (84.375), Prec@5 95.312 (95.312)
11/29 11:39 EPOCH: 93 Val: Prec@1 61.890 Prec@5 97.190
11/29 11:39 many acc 84.28, med acc 39.50, few acc 0.00
Best Prec@1: 63.200

Epoch: [94/200][0/395], Time 0.112 (0.112), Loss 0.3366 (0.3366)
11/29 11:39 EPOCH: 94 Train: Time 0.037 (0.043), Loss 0.2178 (0.2232)
===> Calculating KNN centroids.
Test: [0/157], Time 0.056 (0.056), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/29 11:39 EPOCH: 94 Val: Prec@1 58.350 Prec@5 97.310
11/29 11:39 many acc 83.82, med acc 32.88, few acc 0.00
Best Prec@1: 63.200

Epoch: [95/200][0/395], Time 0.098 (0.098), Loss 0.1758 (0.1758)
11/29 11:39 EPOCH: 95 Train: Time 0.037 (0.043), Loss 0.2879 (0.2232)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/29 11:39 EPOCH: 95 Val: Prec@1 62.440 Prec@5 97.430
11/29 11:39 many acc 85.62, med acc 39.26, few acc 0.00
Best Prec@1: 63.200

Epoch: [96/200][0/395], Time 0.101 (0.101), Loss 0.1114 (0.1114)
11/29 11:40 EPOCH: 96 Train: Time 0.037 (0.043), Loss 0.1475 (0.2208)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 87.500 (87.500), Prec@5 95.312 (95.312)
11/29 11:40 EPOCH: 96 Val: Prec@1 62.120 Prec@5 95.940
11/29 11:40 many acc 84.16, med acc 40.08, few acc 0.00
Best Prec@1: 63.200

Epoch: [97/200][0/395], Time 0.084 (0.084), Loss 0.1666 (0.1666)
11/29 11:40 EPOCH: 97 Train: Time 0.037 (0.043), Loss 0.1772 (0.2155)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 84.375 (84.375), Prec@5 93.750 (93.750)
11/29 11:40 EPOCH: 97 Val: Prec@1 59.500 Prec@5 97.570
11/29 11:40 many acc 86.62, med acc 32.38, few acc 0.00
Best Prec@1: 63.200

Epoch: [98/200][0/395], Time 0.095 (0.095), Loss 0.1547 (0.1547)
11/29 11:41 EPOCH: 98 Train: Time 0.037 (0.043), Loss 0.3250 (0.2145)
===> Calculating KNN centroids.
Test: [0/157], Time 0.056 (0.056), Prec@1 87.500 (87.500), Prec@5 95.312 (95.312)
11/29 11:41 EPOCH: 98 Val: Prec@1 63.740 Prec@5 97.530
11/29 11:41 many acc 88.34, med acc 39.14, few acc 0.00
Best Prec@1: 63.740

Epoch: [99/200][0/395], Time 0.097 (0.097), Loss 0.1938 (0.1938)
11/29 11:41 EPOCH: 99 Train: Time 0.037 (0.043), Loss 0.1396 (0.2136)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 82.812 (82.812), Prec@5 93.750 (93.750)
11/29 11:41 EPOCH: 99 Val: Prec@1 59.040 Prec@5 97.000
11/29 11:41 many acc 85.06, med acc 33.02, few acc 0.00
Best Prec@1: 63.740

Epoch: [100/200][0/395], Time 0.061 (0.061), Loss 0.4508 (0.4508)
11/29 11:41 EPOCH: 100 Train: Time 0.037 (0.043), Loss 0.2730 (0.2015)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_99.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_99.png
11/29 11:42 Loss:7.389, Acc:0.68, NC1:696.008,
Wnorm:[1.538,1.583,1.476,1.336,1.506,0.419,0.330,0.363,0.446,0.463]
Hnorm:[5.262,4.803,4.791,4.123,4.496,2.485,1.524,6.502,2.153,6.495]
Wcos:[-0.219,-0.213,-0.179,-0.137,-0.169,0.039,0.052,0.058,-0.010,0.000]
WHcos:[0.930,0.934,0.911,0.935,0.957,0.912,0.397,0.888,0.931,0.908]
11/29 11:42 -- Has saved the NC analysis result to ./output/cifar10_resnet32/0.01/name_2023-11-29/analysis99.pkl
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 87.500 (87.500), Prec@5 93.750 (93.750)
11/29 11:42 EPOCH: 100 Val: Prec@1 64.800 Prec@5 95.940
11/29 11:42 many acc 82.80, med acc 46.80, few acc 0.00
Best Prec@1: 64.800

Epoch: [101/200][0/395], Time 0.066 (0.066), Loss 0.1611 (0.1611)
11/29 11:42 EPOCH: 101 Train: Time 0.037 (0.043), Loss 0.1564 (0.2057)
===> Calculating KNN centroids.
Test: [0/157], Time 0.051 (0.051), Prec@1 90.625 (90.625), Prec@5 100.000 (100.000)
11/29 11:42 EPOCH: 101 Val: Prec@1 63.900 Prec@5 97.710
11/29 11:42 many acc 87.54, med acc 40.26, few acc 0.00
Best Prec@1: 64.800

Epoch: [102/200][0/395], Time 0.088 (0.088), Loss 0.3447 (0.3447)
11/29 11:43 EPOCH: 102 Train: Time 0.037 (0.043), Loss 0.2941 (0.1979)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/29 11:43 EPOCH: 102 Val: Prec@1 62.660 Prec@5 95.840
11/29 11:43 many acc 85.50, med acc 39.82, few acc 0.00
Best Prec@1: 64.800

Epoch: [103/200][0/395], Time 0.109 (0.109), Loss 0.1373 (0.1373)
11/29 11:43 EPOCH: 103 Train: Time 0.037 (0.043), Loss 0.1305 (0.2009)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/29 11:43 EPOCH: 103 Val: Prec@1 62.860 Prec@5 96.780
11/29 11:43 many acc 86.32, med acc 39.40, few acc 0.00
Best Prec@1: 64.800

Epoch: [104/200][0/395], Time 0.099 (0.099), Loss 0.2620 (0.2620)
11/29 11:43 EPOCH: 104 Train: Time 0.037 (0.043), Loss 0.1546 (0.1990)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/29 11:44 EPOCH: 104 Val: Prec@1 59.910 Prec@5 97.720
11/29 11:44 many acc 89.06, med acc 30.76, few acc 0.00
Best Prec@1: 64.800

Epoch: [105/200][0/395], Time 0.092 (0.092), Loss 0.1406 (0.1406)
11/29 11:44 EPOCH: 105 Train: Time 0.037 (0.043), Loss 0.2918 (0.1975)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/29 11:44 EPOCH: 105 Val: Prec@1 60.450 Prec@5 97.250
11/29 11:44 many acc 84.72, med acc 36.18, few acc 0.00
Best Prec@1: 64.800

Epoch: [106/200][0/395], Time 0.096 (0.096), Loss 0.2918 (0.2918)
11/29 11:44 EPOCH: 106 Train: Time 0.037 (0.043), Loss 0.1988 (0.1925)
===> Calculating KNN centroids.
Test: [0/157], Time 0.057 (0.057), Prec@1 87.500 (87.500), Prec@5 95.312 (95.312)
11/29 11:44 EPOCH: 106 Val: Prec@1 61.340 Prec@5 97.350
11/29 11:44 many acc 86.70, med acc 35.98, few acc 0.00
Best Prec@1: 64.800

Epoch: [107/200][0/395], Time 0.093 (0.093), Loss 0.1965 (0.1965)
11/29 11:45 EPOCH: 107 Train: Time 0.037 (0.043), Loss 0.0948 (0.1891)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 92.188 (92.188), Prec@5 98.438 (98.438)
11/29 11:45 EPOCH: 107 Val: Prec@1 61.930 Prec@5 97.920
11/29 11:45 many acc 89.60, med acc 34.26, few acc 0.00
Best Prec@1: 64.800

Epoch: [108/200][0/395], Time 0.078 (0.078), Loss 0.0978 (0.0978)
11/29 11:45 EPOCH: 108 Train: Time 0.037 (0.043), Loss 0.0744 (0.1865)
===> Calculating KNN centroids.
Test: [0/157], Time 0.058 (0.058), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/29 11:45 EPOCH: 108 Val: Prec@1 65.510 Prec@5 97.590
11/29 11:45 many acc 88.88, med acc 42.14, few acc 0.00
Best Prec@1: 65.510

Epoch: [109/200][0/395], Time 0.077 (0.077), Loss 0.0753 (0.0753)
11/29 11:46 EPOCH: 109 Train: Time 0.037 (0.043), Loss 0.1065 (0.1879)
===> Calculating KNN centroids.
Test: [0/157], Time 0.059 (0.059), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/29 11:46 EPOCH: 109 Val: Prec@1 64.320 Prec@5 96.960
11/29 11:46 many acc 87.28, med acc 41.36, few acc 0.00
Best Prec@1: 65.510

Epoch: [110/200][0/395], Time 0.079 (0.079), Loss 0.0826 (0.0826)
11/29 11:46 EPOCH: 110 Train: Time 0.037 (0.043), Loss 0.1596 (0.1798)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_109.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_109.png
11/29 11:46 Loss:4.691, Acc:0.80, NC1:17.808,
Wnorm:[1.535,1.568,1.492,1.350,1.509,0.422,0.335,0.361,0.444,0.442]
Hnorm:[3.983,4.750,3.867,3.634,4.432,2.200,3.037,3.524,2.587,3.163]
Wcos:[-0.215,-0.207,-0.185,-0.145,-0.171,0.042,0.052,0.061,-0.006,0.006]
WHcos:[0.966,0.955,0.948,0.969,0.968,0.865,0.754,0.903,0.952,0.947]
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/29 11:46 EPOCH: 110 Val: Prec@1 61.230 Prec@5 97.630
11/29 11:46 many acc 89.66, med acc 32.80, few acc 0.00
Best Prec@1: 65.510

Epoch: [111/200][0/395], Time 0.104 (0.104), Loss 0.0759 (0.0759)
11/29 11:47 EPOCH: 111 Train: Time 0.037 (0.043), Loss 0.1948 (0.1834)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/29 11:47 EPOCH: 111 Val: Prec@1 60.230 Prec@5 97.070
11/29 11:47 many acc 90.02, med acc 30.44, few acc 0.00
Best Prec@1: 65.510

Epoch: [112/200][0/395], Time 0.084 (0.084), Loss 0.0766 (0.0766)
11/29 11:47 EPOCH: 112 Train: Time 0.038 (0.043), Loss 0.2040 (0.1788)
===> Calculating KNN centroids.
Test: [0/157], Time 0.057 (0.057), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/29 11:47 EPOCH: 112 Val: Prec@1 60.380 Prec@5 97.360
11/29 11:47 many acc 88.76, med acc 32.00, few acc 0.00
Best Prec@1: 65.510

Epoch: [113/200][0/395], Time 0.083 (0.083), Loss 0.0643 (0.0643)
11/29 11:47 EPOCH: 113 Train: Time 0.037 (0.043), Loss 0.3352 (0.1806)
===> Calculating KNN centroids.
Test: [0/157], Time 0.072 (0.072), Prec@1 93.750 (93.750), Prec@5 100.000 (100.000)
11/29 11:48 EPOCH: 113 Val: Prec@1 65.230 Prec@5 98.190
11/29 11:48 many acc 90.54, med acc 39.92, few acc 0.00
Best Prec@1: 65.510

Epoch: [114/200][0/395], Time 0.077 (0.077), Loss 0.2296 (0.2296)
11/29 11:48 EPOCH: 114 Train: Time 0.037 (0.043), Loss 0.2739 (0.1721)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 82.812 (82.812), Prec@5 95.312 (95.312)
11/29 11:48 EPOCH: 114 Val: Prec@1 62.380 Prec@5 96.990
11/29 11:48 many acc 86.78, med acc 37.98, few acc 0.00
Best Prec@1: 65.510

Epoch: [115/200][0/395], Time 0.095 (0.095), Loss 0.0780 (0.0780)
11/29 11:48 EPOCH: 115 Train: Time 0.037 (0.043), Loss 0.0900 (0.1749)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 89.062 (89.062), Prec@5 90.625 (90.625)
11/29 11:48 EPOCH: 115 Val: Prec@1 62.470 Prec@5 96.600
11/29 11:48 many acc 84.94, med acc 40.00, few acc 0.00
Best Prec@1: 65.510

Epoch: [116/200][0/395], Time 0.104 (0.104), Loss 0.1070 (0.1070)
11/29 11:49 EPOCH: 116 Train: Time 0.037 (0.043), Loss 0.4145 (0.1688)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 85.938 (85.938), Prec@5 95.312 (95.312)
11/29 11:49 EPOCH: 116 Val: Prec@1 64.640 Prec@5 95.410
11/29 11:49 many acc 85.82, med acc 43.46, few acc 0.00
Best Prec@1: 65.510

Epoch: [117/200][0/395], Time 0.099 (0.099), Loss 0.1271 (0.1271)
11/29 11:49 EPOCH: 117 Train: Time 0.037 (0.043), Loss 0.2110 (0.1647)
===> Calculating KNN centroids.
Test: [0/157], Time 0.056 (0.056), Prec@1 92.188 (92.188), Prec@5 96.875 (96.875)
11/29 11:49 EPOCH: 117 Val: Prec@1 61.520 Prec@5 97.290
11/29 11:49 many acc 89.48, med acc 33.56, few acc 0.00
Best Prec@1: 65.510

Epoch: [118/200][0/395], Time 0.093 (0.093), Loss 0.0829 (0.0829)
11/29 11:50 EPOCH: 118 Train: Time 0.037 (0.043), Loss 0.1843 (0.1591)
===> Calculating KNN centroids.
Test: [0/157], Time 0.058 (0.058), Prec@1 92.188 (92.188), Prec@5 95.312 (95.312)
11/29 11:50 EPOCH: 118 Val: Prec@1 65.320 Prec@5 97.420
11/29 11:50 many acc 89.48, med acc 41.16, few acc 0.00
Best Prec@1: 65.510

Epoch: [119/200][0/395], Time 0.102 (0.102), Loss 0.0618 (0.0618)
11/29 11:50 EPOCH: 119 Train: Time 0.037 (0.043), Loss 0.2045 (0.1590)
===> Calculating KNN centroids.
Test: [0/157], Time 0.056 (0.056), Prec@1 87.500 (87.500), Prec@5 98.438 (98.438)
11/29 11:50 EPOCH: 119 Val: Prec@1 63.440 Prec@5 98.010
11/29 11:50 many acc 91.14, med acc 35.74, few acc 0.00
Best Prec@1: 65.510

Epoch: [120/200][0/395], Time 0.103 (0.103), Loss 0.1713 (0.1713)
11/29 11:50 EPOCH: 120 Train: Time 0.037 (0.043), Loss 0.2005 (0.1604)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_119.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_119.png
11/29 11:51 Loss:3.796, Acc:0.86, NC1:208.993,
Wnorm:[1.539,1.558,1.492,1.373,1.504,0.409,0.344,0.358,0.427,0.426]
Hnorm:[4.708,4.913,4.599,4.052,4.521,2.128,2.255,2.500,5.473,4.509]
Wcos:[-0.214,-0.204,-0.189,-0.152,-0.175,0.044,0.058,0.065,0.005,0.013]
WHcos:[0.932,0.958,0.950,0.941,0.957,0.738,0.807,0.963,0.909,0.948]
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 11:51 EPOCH: 120 Val: Prec@1 62.260 Prec@5 97.910
11/29 11:51 many acc 91.14, med acc 33.38, few acc 0.00
Best Prec@1: 65.510

Epoch: [121/200][0/395], Time 0.096 (0.096), Loss 0.1996 (0.1996)
11/29 11:51 EPOCH: 121 Train: Time 0.037 (0.043), Loss 0.1272 (0.1571)
===> Calculating KNN centroids.
Test: [0/157], Time 0.072 (0.072), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/29 11:51 EPOCH: 121 Val: Prec@1 59.820 Prec@5 97.550
11/29 11:51 many acc 91.56, med acc 28.08, few acc 0.00
Best Prec@1: 65.510

Epoch: [122/200][0/395], Time 0.104 (0.104), Loss 0.0466 (0.0466)
11/29 11:52 EPOCH: 122 Train: Time 0.037 (0.043), Loss 0.0428 (0.1513)
===> Calculating KNN centroids.
Test: [0/157], Time 0.059 (0.059), Prec@1 89.062 (89.062), Prec@5 93.750 (93.750)
11/29 11:52 EPOCH: 122 Val: Prec@1 63.760 Prec@5 96.510
11/29 11:52 many acc 88.12, med acc 39.40, few acc 0.00
Best Prec@1: 65.510

Epoch: [123/200][0/395], Time 0.097 (0.097), Loss 0.0911 (0.0911)
11/29 11:52 EPOCH: 123 Train: Time 0.037 (0.043), Loss 0.2593 (0.1435)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 92.188 (92.188), Prec@5 98.438 (98.438)
11/29 11:52 EPOCH: 123 Val: Prec@1 65.700 Prec@5 96.860
11/29 11:52 many acc 89.52, med acc 41.88, few acc 0.00
Best Prec@1: 65.700

Epoch: [124/200][0/395], Time 0.104 (0.104), Loss 0.1689 (0.1689)
11/29 11:52 EPOCH: 124 Train: Time 0.037 (0.043), Loss 0.1911 (0.1502)
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 90.625 (90.625), Prec@5 95.312 (95.312)
11/29 11:52 EPOCH: 124 Val: Prec@1 65.420 Prec@5 97.220
11/29 11:52 many acc 89.72, med acc 41.12, few acc 0.00
Best Prec@1: 65.700

Epoch: [125/200][0/395], Time 0.095 (0.095), Loss 0.2755 (0.2755)
11/29 11:53 EPOCH: 125 Train: Time 0.037 (0.043), Loss 0.3403 (0.1418)
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 84.375 (84.375), Prec@5 90.625 (90.625)
11/29 11:53 EPOCH: 125 Val: Prec@1 67.470 Prec@5 94.700
11/29 11:53 many acc 83.24, med acc 51.70, few acc 0.00
Best Prec@1: 67.470

Epoch: [126/200][0/395], Time 0.067 (0.067), Loss 0.1508 (0.1508)
11/29 11:53 EPOCH: 126 Train: Time 0.037 (0.043), Loss 0.1119 (0.1428)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/29 11:53 EPOCH: 126 Val: Prec@1 56.480 Prec@5 97.330
11/29 11:53 many acc 92.46, med acc 20.50, few acc 0.00
Best Prec@1: 67.470

Epoch: [127/200][0/395], Time 0.090 (0.090), Loss 0.1470 (0.1470)
11/29 11:54 EPOCH: 127 Train: Time 0.037 (0.043), Loss 0.0470 (0.1393)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/29 11:54 EPOCH: 127 Val: Prec@1 63.570 Prec@5 96.830
11/29 11:54 many acc 89.20, med acc 37.94, few acc 0.00
Best Prec@1: 67.470

Epoch: [128/200][0/395], Time 0.094 (0.094), Loss 0.1132 (0.1132)
11/29 11:54 EPOCH: 128 Train: Time 0.037 (0.043), Loss 0.2011 (0.1318)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 95.312 (95.312), Prec@5 100.000 (100.000)
11/29 11:54 EPOCH: 128 Val: Prec@1 61.320 Prec@5 97.580
11/29 11:54 many acc 91.04, med acc 31.60, few acc 0.00
Best Prec@1: 67.470

Epoch: [129/200][0/395], Time 0.073 (0.073), Loss 0.0292 (0.0292)
11/29 11:54 EPOCH: 129 Train: Time 0.037 (0.043), Loss 0.2278 (0.1368)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 84.375 (84.375), Prec@5 96.875 (96.875)
11/29 11:55 EPOCH: 129 Val: Prec@1 60.380 Prec@5 96.490
11/29 11:55 many acc 87.74, med acc 33.02, few acc 0.00
Best Prec@1: 67.470

Epoch: [130/200][0/395], Time 0.098 (0.098), Loss 0.2039 (0.2039)
11/29 11:55 EPOCH: 130 Train: Time 0.037 (0.043), Loss 0.1530 (0.1350)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_129.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_129.png
11/29 11:55 Loss:3.495, Acc:0.89, NC1:132.884,
Wnorm:[1.527,1.541,1.501,1.397,1.510,0.406,0.345,0.347,0.415,0.419]
Hnorm:[4.861,5.491,4.800,4.632,5.122,4.124,2.013,1.066,7.566,5.386]
Wcos:[-0.212,-0.205,-0.190,-0.159,-0.178,0.049,0.064,0.070,0.011,0.019]
WHcos:[0.912,0.957,0.883,0.931,0.920,0.910,0.911,0.357,0.877,0.902]
===> Calculating KNN centroids.
Test: [0/157], Time 0.071 (0.071), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/29 11:55 EPOCH: 130 Val: Prec@1 61.960 Prec@5 97.520
11/29 11:55 many acc 91.60, med acc 32.32, few acc 0.00
Best Prec@1: 67.470

Epoch: [131/200][0/395], Time 0.102 (0.102), Loss 0.2315 (0.2315)
11/29 11:56 EPOCH: 131 Train: Time 0.037 (0.043), Loss 0.2149 (0.1224)
===> Calculating KNN centroids.
Test: [0/157], Time 0.079 (0.079), Prec@1 89.062 (89.062), Prec@5 93.750 (93.750)
11/29 11:56 EPOCH: 131 Val: Prec@1 61.330 Prec@5 96.400
11/29 11:56 many acc 90.88, med acc 31.78, few acc 0.00
Best Prec@1: 67.470

Epoch: [132/200][0/395], Time 0.060 (0.060), Loss 0.0765 (0.0765)
11/29 11:56 EPOCH: 132 Train: Time 0.037 (0.043), Loss 0.1137 (0.1232)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/29 11:56 EPOCH: 132 Val: Prec@1 68.100 Prec@5 96.980
11/29 11:56 many acc 89.82, med acc 46.38, few acc 0.00
Best Prec@1: 68.100

Epoch: [133/200][0/395], Time 0.108 (0.108), Loss 0.1935 (0.1935)
11/29 11:56 EPOCH: 133 Train: Time 0.037 (0.043), Loss 0.0635 (0.1172)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 96.875 (96.875), Prec@5 100.000 (100.000)
11/29 11:57 EPOCH: 133 Val: Prec@1 61.570 Prec@5 97.970
11/29 11:57 many acc 92.48, med acc 30.66, few acc 0.00
Best Prec@1: 68.100

Epoch: [134/200][0/395], Time 0.091 (0.091), Loss 0.0663 (0.0663)
11/29 11:57 EPOCH: 134 Train: Time 0.037 (0.043), Loss 0.0945 (0.1147)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 95.312 (95.312), Prec@5 100.000 (100.000)
11/29 11:57 EPOCH: 134 Val: Prec@1 63.810 Prec@5 95.010
11/29 11:57 many acc 86.10, med acc 41.52, few acc 0.00
Best Prec@1: 68.100

Epoch: [135/200][0/395], Time 0.099 (0.099), Loss 0.0343 (0.0343)
11/29 11:57 EPOCH: 135 Train: Time 0.037 (0.043), Loss 0.0868 (0.1097)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 85.938 (85.938), Prec@5 95.312 (95.312)
11/29 11:57 EPOCH: 135 Val: Prec@1 65.330 Prec@5 95.650
11/29 11:57 many acc 87.00, med acc 43.66, few acc 0.00
Best Prec@1: 68.100

Epoch: [136/200][0/395], Time 0.095 (0.095), Loss 0.0901 (0.0901)
11/29 11:58 EPOCH: 136 Train: Time 0.037 (0.043), Loss 0.0222 (0.1130)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 90.625 (90.625), Prec@5 95.312 (95.312)
11/29 11:58 EPOCH: 136 Val: Prec@1 63.170 Prec@5 97.440
11/29 11:58 many acc 91.56, med acc 34.78, few acc 0.00
Best Prec@1: 68.100

Epoch: [137/200][0/395], Time 0.086 (0.086), Loss 0.1649 (0.1649)
11/29 11:58 EPOCH: 137 Train: Time 0.037 (0.043), Loss 0.0519 (0.1143)
===> Calculating KNN centroids.
Test: [0/157], Time 0.059 (0.059), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/29 11:58 EPOCH: 137 Val: Prec@1 64.440 Prec@5 97.720
11/29 11:58 many acc 90.46, med acc 38.42, few acc 0.00
Best Prec@1: 68.100

Epoch: [138/200][0/395], Time 0.097 (0.097), Loss 0.2174 (0.2174)
11/29 11:59 EPOCH: 138 Train: Time 0.037 (0.043), Loss 0.0401 (0.1047)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 89.062 (89.062), Prec@5 92.188 (92.188)
11/29 11:59 EPOCH: 138 Val: Prec@1 66.120 Prec@5 96.520
11/29 11:59 many acc 89.48, med acc 42.76, few acc 0.00
Best Prec@1: 68.100

Epoch: [139/200][0/395], Time 0.110 (0.110), Loss 0.0567 (0.0567)
11/29 11:59 EPOCH: 139 Train: Time 0.037 (0.043), Loss 0.0185 (0.1004)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/29 11:59 EPOCH: 139 Val: Prec@1 65.510 Prec@5 97.060
11/29 11:59 many acc 92.50, med acc 38.52, few acc 0.00
Best Prec@1: 68.100

Epoch: [140/200][0/395], Time 0.097 (0.097), Loss 0.0359 (0.0359)
11/29 11:59 EPOCH: 140 Train: Time 0.037 (0.043), Loss 0.2381 (0.0968)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_139.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_139.png
11/29 12:00 Loss:3.184, Acc:0.91, NC1:195.794,
Wnorm:[1.532,1.521,1.508,1.417,1.509,0.398,0.335,0.343,0.403,0.410]
Hnorm:[5.383,5.808,5.260,4.847,4.881,3.341,6.996,2.750,4.532,3.461]
Wcos:[-0.211,-0.204,-0.192,-0.163,-0.181,0.053,0.071,0.077,0.018,0.026]
WHcos:[0.911,0.894,0.902,0.887,0.872,0.941,0.842,0.923,0.928,0.975]
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 90.625 (90.625), Prec@5 95.312 (95.312)
11/29 12:00 EPOCH: 140 Val: Prec@1 62.210 Prec@5 97.350
11/29 12:00 many acc 90.86, med acc 33.56, few acc 0.00
Best Prec@1: 68.100

Epoch: [141/200][0/395], Time 0.089 (0.089), Loss 0.0608 (0.0608)
11/29 12:00 EPOCH: 141 Train: Time 0.037 (0.043), Loss 0.1236 (0.1006)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 92.188 (92.188), Prec@5 96.875 (96.875)
11/29 12:00 EPOCH: 141 Val: Prec@1 64.150 Prec@5 96.630
11/29 12:00 many acc 90.86, med acc 37.44, few acc 0.00
Best Prec@1: 68.100

Epoch: [142/200][0/395], Time 0.082 (0.082), Loss 0.0623 (0.0623)
11/29 12:00 EPOCH: 142 Train: Time 0.037 (0.043), Loss 0.1708 (0.0963)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 89.062 (89.062), Prec@5 92.188 (92.188)
11/29 12:01 EPOCH: 142 Val: Prec@1 66.280 Prec@5 96.900
11/29 12:01 many acc 89.14, med acc 43.42, few acc 0.00
Best Prec@1: 68.100

Epoch: [143/200][0/395], Time 0.107 (0.107), Loss 0.1485 (0.1485)
11/29 12:01 EPOCH: 143 Train: Time 0.037 (0.043), Loss 0.0273 (0.0916)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/29 12:01 EPOCH: 143 Val: Prec@1 66.720 Prec@5 95.720
11/29 12:01 many acc 87.88, med acc 45.56, few acc 0.00
Best Prec@1: 68.100

Epoch: [144/200][0/395], Time 0.071 (0.071), Loss 0.0395 (0.0395)
11/29 12:01 EPOCH: 144 Train: Time 0.037 (0.043), Loss 0.0253 (0.0850)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/29 12:01 EPOCH: 144 Val: Prec@1 63.430 Prec@5 97.430
11/29 12:01 many acc 92.96, med acc 33.90, few acc 0.00
Best Prec@1: 68.100

Epoch: [145/200][0/395], Time 0.105 (0.105), Loss 0.0521 (0.0521)
11/29 12:02 EPOCH: 145 Train: Time 0.037 (0.043), Loss 0.0209 (0.0843)
===> Calculating KNN centroids.
Test: [0/157], Time 0.057 (0.057), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/29 12:02 EPOCH: 145 Val: Prec@1 61.870 Prec@5 97.850
11/29 12:02 many acc 92.90, med acc 30.84, few acc 0.00
Best Prec@1: 68.100

Epoch: [146/200][0/395], Time 0.075 (0.075), Loss 0.1492 (0.1492)
11/29 12:02 EPOCH: 146 Train: Time 0.037 (0.043), Loss 0.0213 (0.0822)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/29 12:02 EPOCH: 146 Val: Prec@1 62.410 Prec@5 98.330
11/29 12:02 many acc 93.82, med acc 31.00, few acc 0.00
Best Prec@1: 68.100

Epoch: [147/200][0/395], Time 0.088 (0.088), Loss 0.0155 (0.0155)
11/29 12:03 EPOCH: 147 Train: Time 0.037 (0.043), Loss 0.0353 (0.0792)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 92.188 (92.188), Prec@5 96.875 (96.875)
11/29 12:03 EPOCH: 147 Val: Prec@1 63.700 Prec@5 97.700
11/29 12:03 many acc 92.64, med acc 34.76, few acc 0.00
Best Prec@1: 68.100

Epoch: [148/200][0/395], Time 0.085 (0.085), Loss 0.0277 (0.0277)
11/29 12:03 EPOCH: 148 Train: Time 0.037 (0.043), Loss 0.2434 (0.0750)
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/29 12:03 EPOCH: 148 Val: Prec@1 61.830 Prec@5 97.900
11/29 12:03 many acc 94.38, med acc 29.28, few acc 0.00
Best Prec@1: 68.100

Epoch: [149/200][0/395], Time 0.101 (0.101), Loss 0.0879 (0.0879)
11/29 12:03 EPOCH: 149 Train: Time 0.037 (0.043), Loss 0.0985 (0.0765)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 92.188 (92.188), Prec@5 95.312 (95.312)
11/29 12:04 EPOCH: 149 Val: Prec@1 64.760 Prec@5 98.390
11/29 12:04 many acc 94.48, med acc 35.04, few acc 0.00
Best Prec@1: 68.100

Epoch: [150/200][0/395], Time 0.061 (0.061), Loss 0.0712 (0.0712)
11/29 12:04 EPOCH: 150 Train: Time 0.037 (0.043), Loss 0.1042 (0.0699)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_149.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_149.png
11/29 12:04 Loss:2.167, Acc:0.95, NC1:149.944,
Wnorm:[1.522,1.501,1.507,1.433,1.504,0.392,0.331,0.329,0.396,0.401]
Hnorm:[6.295,6.548,6.438,5.959,6.287,3.940,6.181,4.397,7.409,4.536]
Wcos:[-0.211,-0.204,-0.193,-0.168,-0.181,0.059,0.076,0.081,0.022,0.030]
WHcos:[0.853,0.883,0.869,0.845,0.836,0.946,0.866,0.940,0.871,0.974]
11/29 12:04 -- Has saved the NC analysis result to ./output/cifar10_resnet32/0.01/name_2023-11-29/analysis149.pkl
===> Calculating KNN centroids.
Test: [0/157], Time 0.078 (0.078), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/29 12:04 EPOCH: 150 Val: Prec@1 63.550 Prec@5 97.810
11/29 12:04 many acc 92.96, med acc 34.14, few acc 0.00
Best Prec@1: 68.100

Epoch: [151/200][0/395], Time 0.096 (0.096), Loss 0.1109 (0.1109)
11/29 12:05 EPOCH: 151 Train: Time 0.037 (0.043), Loss 0.0711 (0.0702)
===> Calculating KNN centroids.
Test: [0/157], Time 0.049 (0.049), Prec@1 92.188 (92.188), Prec@5 98.438 (98.438)
11/29 12:05 EPOCH: 151 Val: Prec@1 67.020 Prec@5 95.970
11/29 12:05 many acc 89.62, med acc 44.42, few acc 0.00
Best Prec@1: 68.100

Epoch: [152/200][0/395], Time 0.091 (0.091), Loss 0.1415 (0.1415)
11/29 12:05 EPOCH: 152 Train: Time 0.037 (0.043), Loss 0.0138 (0.0658)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/29 12:05 EPOCH: 152 Val: Prec@1 68.380 Prec@5 96.770
11/29 12:05 many acc 91.10, med acc 45.66, few acc 0.00
Best Prec@1: 68.380

Epoch: [153/200][0/395], Time 0.094 (0.094), Loss 0.0338 (0.0338)
11/29 12:05 EPOCH: 153 Train: Time 0.037 (0.043), Loss 0.0989 (0.0653)
===> Calculating KNN centroids.
Test: [0/157], Time 0.053 (0.053), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/29 12:06 EPOCH: 153 Val: Prec@1 65.730 Prec@5 97.760
11/29 12:06 many acc 92.96, med acc 38.50, few acc 0.00
Best Prec@1: 68.380

Epoch: [154/200][0/395], Time 0.080 (0.080), Loss 0.1328 (0.1328)
11/29 12:06 EPOCH: 154 Train: Time 0.037 (0.043), Loss 0.1121 (0.0639)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:06 EPOCH: 154 Val: Prec@1 60.810 Prec@5 97.980
11/29 12:06 many acc 93.78, med acc 27.84, few acc 0.00
Best Prec@1: 68.380

Epoch: [155/200][0/395], Time 0.092 (0.092), Loss 0.1162 (0.1162)
11/29 12:06 EPOCH: 155 Train: Time 0.037 (0.043), Loss 0.0808 (0.0567)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/29 12:06 EPOCH: 155 Val: Prec@1 65.880 Prec@5 97.840
11/29 12:06 many acc 93.06, med acc 38.70, few acc 0.00
Best Prec@1: 68.380

Epoch: [156/200][0/395], Time 0.097 (0.097), Loss 0.0902 (0.0902)
11/29 12:07 EPOCH: 156 Train: Time 0.037 (0.043), Loss 0.0456 (0.0529)
===> Calculating KNN centroids.
Test: [0/157], Time 0.049 (0.049), Prec@1 92.188 (92.188), Prec@5 96.875 (96.875)
11/29 12:07 EPOCH: 156 Val: Prec@1 66.920 Prec@5 97.690
11/29 12:07 many acc 93.56, med acc 40.28, few acc 0.00
Best Prec@1: 68.380

Epoch: [157/200][0/395], Time 0.103 (0.103), Loss 0.0172 (0.0172)
11/29 12:07 EPOCH: 157 Train: Time 0.037 (0.043), Loss 0.0191 (0.0564)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 96.875 (96.875), Prec@5 100.000 (100.000)
11/29 12:07 EPOCH: 157 Val: Prec@1 63.520 Prec@5 97.620
11/29 12:07 many acc 94.02, med acc 33.02, few acc 0.00
Best Prec@1: 68.380

Epoch: [158/200][0/395], Time 0.061 (0.061), Loss 0.0979 (0.0979)
11/29 12:07 EPOCH: 158 Train: Time 0.037 (0.043), Loss 0.1563 (0.0543)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 92.188 (92.188), Prec@5 93.750 (93.750)
11/29 12:08 EPOCH: 158 Val: Prec@1 65.450 Prec@5 97.870
11/29 12:08 many acc 93.82, med acc 37.08, few acc 0.00
Best Prec@1: 68.380

Epoch: [159/200][0/395], Time 0.093 (0.093), Loss 0.0143 (0.0143)
11/29 12:08 EPOCH: 159 Train: Time 0.037 (0.043), Loss 0.1413 (0.0503)
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 87.500 (87.500), Prec@5 92.188 (92.188)
11/29 12:08 EPOCH: 159 Val: Prec@1 66.590 Prec@5 97.230
11/29 12:08 many acc 91.84, med acc 41.34, few acc 0.00
Best Prec@1: 68.380

Epoch: [160/200][0/395], Time 0.098 (0.098), Loss 0.0161 (0.0161)
11/29 12:08 EPOCH: 160 Train: Time 0.037 (0.043), Loss 0.0689 (0.0509)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_159.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_159.png
11/29 12:09 Loss:1.855, Acc:0.97, NC1:800.364,
Wnorm:[1.508,1.477,1.501,1.440,1.492,0.383,0.328,0.325,0.395,0.394]
Hnorm:[7.807,8.045,7.885,7.715,7.891,6.702,5.925,6.672,8.406,7.899]
Wcos:[-0.210,-0.202,-0.192,-0.170,-0.181,0.060,0.077,0.083,0.022,0.029]
WHcos:[0.753,0.789,0.773,0.774,0.743,0.840,0.899,0.933,0.875,0.881]
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/29 12:09 EPOCH: 160 Val: Prec@1 66.510 Prec@5 98.090
11/29 12:09 many acc 94.26, med acc 38.76, few acc 0.00
Best Prec@1: 68.380

Epoch: [161/200][0/395], Time 0.101 (0.101), Loss 0.0409 (0.0409)
11/29 12:09 EPOCH: 161 Train: Time 0.037 (0.043), Loss 0.0502 (0.0471)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/29 12:09 EPOCH: 161 Val: Prec@1 65.900 Prec@5 98.040
11/29 12:09 many acc 93.92, med acc 37.88, few acc 0.00
Best Prec@1: 68.380

Epoch: [162/200][0/395], Time 0.098 (0.098), Loss 0.0080 (0.0080)
11/29 12:09 EPOCH: 162 Train: Time 0.037 (0.043), Loss 0.0146 (0.0404)
===> Calculating KNN centroids.
Test: [0/157], Time 0.073 (0.073), Prec@1 90.625 (90.625), Prec@5 93.750 (93.750)
11/29 12:10 EPOCH: 162 Val: Prec@1 64.070 Prec@5 96.880
11/29 12:10 many acc 91.56, med acc 36.58, few acc 0.00
Best Prec@1: 68.380

Epoch: [163/200][0/395], Time 0.093 (0.093), Loss 0.0516 (0.0516)
11/29 12:10 EPOCH: 163 Train: Time 0.037 (0.043), Loss 0.1596 (0.0421)
===> Calculating KNN centroids.
Test: [0/157], Time 0.049 (0.049), Prec@1 95.312 (95.312), Prec@5 100.000 (100.000)
11/29 12:10 EPOCH: 163 Val: Prec@1 63.740 Prec@5 97.980
11/29 12:10 many acc 94.80, med acc 32.68, few acc 0.00
Best Prec@1: 68.380

Epoch: [164/200][0/395], Time 0.063 (0.063), Loss 0.0108 (0.0108)
11/29 12:10 EPOCH: 164 Train: Time 0.037 (0.043), Loss 0.0134 (0.0395)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/29 12:10 EPOCH: 164 Val: Prec@1 64.700 Prec@5 97.560
11/29 12:10 many acc 93.70, med acc 35.70, few acc 0.00
Best Prec@1: 68.380

Epoch: [165/200][0/395], Time 0.064 (0.064), Loss 0.0495 (0.0495)
11/29 12:11 EPOCH: 165 Train: Time 0.037 (0.043), Loss 0.0114 (0.0364)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/29 12:11 EPOCH: 165 Val: Prec@1 62.610 Prec@5 98.440
11/29 12:11 many acc 95.70, med acc 29.52, few acc 0.00
Best Prec@1: 68.380

Epoch: [166/200][0/395], Time 0.097 (0.097), Loss 0.0051 (0.0051)
11/29 12:11 EPOCH: 166 Train: Time 0.037 (0.043), Loss 0.0530 (0.0348)
===> Calculating KNN centroids.
Test: [0/157], Time 0.055 (0.055), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/29 12:11 EPOCH: 166 Val: Prec@1 64.610 Prec@5 98.390
11/29 12:11 many acc 94.52, med acc 34.70, few acc 0.00
Best Prec@1: 68.380

Epoch: [167/200][0/395], Time 0.110 (0.110), Loss 0.0355 (0.0355)
11/29 12:12 EPOCH: 167 Train: Time 0.037 (0.043), Loss 0.0647 (0.0337)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 93.750 (93.750), Prec@5 95.312 (95.312)
11/29 12:12 EPOCH: 167 Val: Prec@1 64.670 Prec@5 98.160
11/29 12:12 many acc 94.92, med acc 34.42, few acc 0.00
Best Prec@1: 68.380

Epoch: [168/200][0/395], Time 0.102 (0.102), Loss 0.0130 (0.0130)
11/29 12:12 EPOCH: 168 Train: Time 0.037 (0.043), Loss 0.0049 (0.0292)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 96.875 (96.875), Prec@5 96.875 (96.875)
11/29 12:12 EPOCH: 168 Val: Prec@1 63.970 Prec@5 98.520
11/29 12:12 many acc 96.04, med acc 31.90, few acc 0.00
Best Prec@1: 68.380

Epoch: [169/200][0/395], Time 0.099 (0.099), Loss 0.0055 (0.0055)
11/29 12:12 EPOCH: 169 Train: Time 0.037 (0.043), Loss 0.0069 (0.0306)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:13 EPOCH: 169 Val: Prec@1 62.790 Prec@5 98.510
11/29 12:13 many acc 95.78, med acc 29.80, few acc 0.00
Best Prec@1: 68.380

Epoch: [170/200][0/395], Time 0.093 (0.093), Loss 0.1009 (0.1009)
11/29 12:13 EPOCH: 170 Train: Time 0.037 (0.043), Loss 0.0105 (0.0281)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_169.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_169.png
11/29 12:13 Loss:1.275, Acc:0.99, NC1:85.653,
Wnorm:[1.491,1.452,1.489,1.436,1.475,0.379,0.327,0.317,0.394,0.392]
Hnorm:[8.935,9.062,8.868,8.829,8.928,8.779,7.089,7.849,8.899,9.200]
Wcos:[-0.209,-0.201,-0.190,-0.170,-0.179,0.058,0.076,0.081,0.018,0.025]
WHcos:[0.733,0.744,0.709,0.749,0.737,0.863,0.922,0.903,0.892,0.881]
===> Calculating KNN centroids.
Test: [0/157], Time 0.056 (0.056), Prec@1 96.875 (96.875), Prec@5 98.438 (98.438)
11/29 12:13 EPOCH: 170 Val: Prec@1 64.080 Prec@5 98.250
11/29 12:13 many acc 95.72, med acc 32.44, few acc 0.00
Best Prec@1: 68.380

Epoch: [171/200][0/395], Time 0.102 (0.102), Loss 0.0323 (0.0323)
11/29 12:13 EPOCH: 171 Train: Time 0.037 (0.043), Loss 0.0081 (0.0264)
===> Calculating KNN centroids.
Test: [0/157], Time 0.049 (0.049), Prec@1 96.875 (96.875), Prec@5 98.438 (98.438)
11/29 12:14 EPOCH: 171 Val: Prec@1 65.590 Prec@5 98.300
11/29 12:14 many acc 95.82, med acc 35.36, few acc 0.00
Best Prec@1: 68.380

Epoch: [172/200][0/395], Time 0.089 (0.089), Loss 0.0285 (0.0285)
11/29 12:14 EPOCH: 172 Train: Time 0.037 (0.043), Loss 0.0054 (0.0251)
===> Calculating KNN centroids.
Test: [0/157], Time 0.076 (0.076), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/29 12:14 EPOCH: 172 Val: Prec@1 63.970 Prec@5 98.600
11/29 12:14 many acc 95.98, med acc 31.96, few acc 0.00
Best Prec@1: 68.380

Epoch: [173/200][0/395], Time 0.082 (0.082), Loss 0.0068 (0.0068)
11/29 12:14 EPOCH: 173 Train: Time 0.037 (0.043), Loss 0.1229 (0.0244)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/29 12:14 EPOCH: 173 Val: Prec@1 62.670 Prec@5 98.540
11/29 12:14 many acc 96.26, med acc 29.08, few acc 0.00
Best Prec@1: 68.380

Epoch: [174/200][0/395], Time 0.095 (0.095), Loss 0.0308 (0.0308)
11/29 12:15 EPOCH: 174 Train: Time 0.037 (0.043), Loss 0.0556 (0.0246)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/29 12:15 EPOCH: 174 Val: Prec@1 62.910 Prec@5 98.510
11/29 12:15 many acc 96.02, med acc 29.80, few acc 0.00
Best Prec@1: 68.380

Epoch: [175/200][0/395], Time 0.100 (0.100), Loss 0.0339 (0.0339)
11/29 12:15 EPOCH: 175 Train: Time 0.037 (0.043), Loss 0.1569 (0.0238)
===> Calculating KNN centroids.
Test: [0/157], Time 0.055 (0.055), Prec@1 93.750 (93.750), Prec@5 95.312 (95.312)
11/29 12:15 EPOCH: 175 Val: Prec@1 61.130 Prec@5 98.550
11/29 12:15 many acc 96.56, med acc 25.70, few acc 0.00
Best Prec@1: 68.380

Epoch: [176/200][0/395], Time 0.136 (0.136), Loss 0.0060 (0.0060)
11/29 12:16 EPOCH: 176 Train: Time 0.037 (0.043), Loss 0.0105 (0.0230)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:16 EPOCH: 176 Val: Prec@1 62.400 Prec@5 98.730
11/29 12:16 many acc 96.16, med acc 28.64, few acc 0.00
Best Prec@1: 68.380

Epoch: [177/200][0/395], Time 0.091 (0.091), Loss 0.0084 (0.0084)
11/29 12:16 EPOCH: 177 Train: Time 0.037 (0.043), Loss 0.0080 (0.0237)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:16 EPOCH: 177 Val: Prec@1 61.770 Prec@5 98.600
11/29 12:16 many acc 96.06, med acc 27.48, few acc 0.00
Best Prec@1: 68.380

Epoch: [178/200][0/395], Time 0.071 (0.071), Loss 0.0065 (0.0065)
11/29 12:16 EPOCH: 178 Train: Time 0.037 (0.043), Loss 0.0614 (0.0229)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:17 EPOCH: 178 Val: Prec@1 62.320 Prec@5 98.540
11/29 12:17 many acc 95.82, med acc 28.82, few acc 0.00
Best Prec@1: 68.380

Epoch: [179/200][0/395], Time 0.063 (0.063), Loss 0.0077 (0.0077)
11/29 12:17 EPOCH: 179 Train: Time 0.037 (0.043), Loss 0.0550 (0.0224)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 96.875 (96.875), Prec@5 98.438 (98.438)
11/29 12:17 EPOCH: 179 Val: Prec@1 63.320 Prec@5 98.700
11/29 12:17 many acc 96.02, med acc 30.62, few acc 0.00
Best Prec@1: 68.380

Epoch: [180/200][0/395], Time 0.093 (0.093), Loss 0.0297 (0.0297)
11/29 12:17 EPOCH: 180 Train: Time 0.037 (0.043), Loss 0.0056 (0.0222)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_179.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_179.png
11/29 12:18 Loss:0.991, Acc:0.99, NC1:157.566,
Wnorm:[1.475,1.431,1.476,1.428,1.459,0.379,0.325,0.315,0.400,0.393]
Hnorm:[9.274,9.284,9.126,9.039,9.037,9.161,7.959,7.872,9.572,9.377]
Wcos:[-0.209,-0.199,-0.187,-0.169,-0.176,0.054,0.071,0.078,0.011,0.018]
WHcos:[0.760,0.766,0.722,0.743,0.720,0.908,0.936,0.939,0.917,0.895]
===> Calculating KNN centroids.
Test: [0/157], Time 0.057 (0.057), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/29 12:18 EPOCH: 180 Val: Prec@1 63.090 Prec@5 98.630
11/29 12:18 many acc 96.06, med acc 30.12, few acc 0.00
Best Prec@1: 68.380

Epoch: [181/200][0/395], Time 0.099 (0.099), Loss 0.0050 (0.0050)
11/29 12:18 EPOCH: 181 Train: Time 0.037 (0.043), Loss 0.0048 (0.0219)
===> Calculating KNN centroids.
Test: [0/157], Time 0.059 (0.059), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/29 12:18 EPOCH: 181 Val: Prec@1 62.750 Prec@5 98.650
11/29 12:18 many acc 96.14, med acc 29.36, few acc 0.00
Best Prec@1: 68.380

Epoch: [182/200][0/395], Time 0.095 (0.095), Loss 0.0062 (0.0062)
11/29 12:18 EPOCH: 182 Train: Time 0.037 (0.043), Loss 0.0876 (0.0220)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:19 EPOCH: 182 Val: Prec@1 62.370 Prec@5 98.730
11/29 12:19 many acc 96.56, med acc 28.18, few acc 0.00
Best Prec@1: 68.380

Epoch: [183/200][0/395], Time 0.105 (0.105), Loss 0.0054 (0.0054)
11/29 12:19 EPOCH: 183 Train: Time 0.037 (0.043), Loss 0.0594 (0.0222)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/29 12:19 EPOCH: 183 Val: Prec@1 61.850 Prec@5 98.780
11/29 12:19 many acc 96.46, med acc 27.24, few acc 0.00
Best Prec@1: 68.380

Epoch: [184/200][0/395], Time 0.096 (0.096), Loss 0.0569 (0.0569)
11/29 12:19 EPOCH: 184 Train: Time 0.037 (0.043), Loss 0.0556 (0.0220)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/29 12:19 EPOCH: 184 Val: Prec@1 62.190 Prec@5 98.750
11/29 12:19 many acc 96.34, med acc 28.04, few acc 0.00
Best Prec@1: 68.380

Epoch: [185/200][0/395], Time 0.097 (0.097), Loss 0.0340 (0.0340)
11/29 12:20 EPOCH: 185 Train: Time 0.037 (0.043), Loss 0.0036 (0.0223)
===> Calculating KNN centroids.
Test: [0/157], Time 0.059 (0.059), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:20 EPOCH: 185 Val: Prec@1 63.170 Prec@5 98.770
11/29 12:20 many acc 96.40, med acc 29.94, few acc 0.00
Best Prec@1: 68.380

Epoch: [186/200][0/395], Time 0.093 (0.093), Loss 0.0657 (0.0657)
11/29 12:20 EPOCH: 186 Train: Time 0.037 (0.043), Loss 0.0055 (0.0217)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:20 EPOCH: 186 Val: Prec@1 62.530 Prec@5 98.830
11/29 12:20 many acc 96.64, med acc 28.42, few acc 0.00
Best Prec@1: 68.380

Epoch: [187/200][0/395], Time 0.097 (0.097), Loss 0.1059 (0.1059)
11/29 12:20 EPOCH: 187 Train: Time 0.037 (0.043), Loss 0.0063 (0.0218)
===> Calculating KNN centroids.
Test: [0/157], Time 0.058 (0.058), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:21 EPOCH: 187 Val: Prec@1 62.210 Prec@5 98.830
11/29 12:21 many acc 96.72, med acc 27.70, few acc 0.00
Best Prec@1: 68.380

Epoch: [188/200][0/395], Time 0.095 (0.095), Loss 0.0358 (0.0358)
11/29 12:21 EPOCH: 188 Train: Time 0.037 (0.043), Loss 0.0067 (0.0214)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:21 EPOCH: 188 Val: Prec@1 62.240 Prec@5 98.730
11/29 12:21 many acc 96.58, med acc 27.90, few acc 0.00
Best Prec@1: 68.380

Epoch: [189/200][0/395], Time 0.108 (0.108), Loss 0.0046 (0.0046)
11/29 12:21 EPOCH: 189 Train: Time 0.037 (0.043), Loss 0.0493 (0.0217)
===> Calculating KNN centroids.
Test: [0/157], Time 0.057 (0.057), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:21 EPOCH: 189 Val: Prec@1 63.940 Prec@5 98.720
11/29 12:21 many acc 96.72, med acc 31.16, few acc 0.00
Best Prec@1: 68.380

Epoch: [190/200][0/395], Time 0.102 (0.102), Loss 0.0055 (0.0055)
11/29 12:22 EPOCH: 190 Train: Time 0.037 (0.043), Loss 0.0090 (0.0216)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_189.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_189.png
11/29 12:22 Loss:0.996, Acc:0.99, NC1:524.397,
Wnorm:[1.469,1.424,1.470,1.423,1.452,0.380,0.325,0.315,0.402,0.395]
Hnorm:[9.232,9.263,8.955,8.866,8.891,9.482,8.214,8.014,9.352,8.891]
Wcos:[-0.209,-0.199,-0.186,-0.168,-0.174,0.051,0.069,0.076,0.007,0.014]
WHcos:[0.767,0.763,0.717,0.740,0.726,0.923,0.951,0.942,0.922,0.904]
===> Calculating KNN centroids.
Test: [0/157], Time 0.057 (0.057), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:22 EPOCH: 190 Val: Prec@1 62.430 Prec@5 98.760
11/29 12:22 many acc 96.58, med acc 28.28, few acc 0.00
Best Prec@1: 68.380

Epoch: [191/200][0/395], Time 0.104 (0.104), Loss 0.0040 (0.0040)
11/29 12:22 EPOCH: 191 Train: Time 0.037 (0.043), Loss 0.0076 (0.0215)
===> Calculating KNN centroids.
Test: [0/157], Time 0.057 (0.057), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:23 EPOCH: 191 Val: Prec@1 62.680 Prec@5 98.830
11/29 12:23 many acc 96.64, med acc 28.72, few acc 0.00
Best Prec@1: 68.380

Epoch: [192/200][0/395], Time 0.075 (0.075), Loss 0.0314 (0.0314)
11/29 12:23 EPOCH: 192 Train: Time 0.037 (0.043), Loss 0.0592 (0.0221)
===> Calculating KNN centroids.
Test: [0/157], Time 0.051 (0.051), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:23 EPOCH: 192 Val: Prec@1 64.060 Prec@5 98.810
11/29 12:23 many acc 96.62, med acc 31.50, few acc 0.00
Best Prec@1: 68.380

Epoch: [193/200][0/395], Time 0.086 (0.086), Loss 0.0044 (0.0044)
11/29 12:23 EPOCH: 193 Train: Time 0.037 (0.043), Loss 0.0580 (0.0216)
===> Calculating KNN centroids.
Test: [0/157], Time 0.054 (0.054), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:23 EPOCH: 193 Val: Prec@1 63.920 Prec@5 98.800
11/29 12:23 many acc 96.52, med acc 31.32, few acc 0.00
Best Prec@1: 68.380

Epoch: [194/200][0/395], Time 0.093 (0.093), Loss 0.0058 (0.0058)
11/29 12:24 EPOCH: 194 Train: Time 0.037 (0.043), Loss 0.0066 (0.0214)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:24 EPOCH: 194 Val: Prec@1 62.850 Prec@5 98.850
11/29 12:24 many acc 96.64, med acc 29.06, few acc 0.00
Best Prec@1: 68.380

Epoch: [195/200][0/395], Time 0.096 (0.096), Loss 0.0062 (0.0062)
11/29 12:24 EPOCH: 195 Train: Time 0.037 (0.043), Loss 0.0130 (0.0212)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:24 EPOCH: 195 Val: Prec@1 63.270 Prec@5 98.780
11/29 12:24 many acc 96.58, med acc 29.96, few acc 0.00
Best Prec@1: 68.380

Epoch: [196/200][0/395], Time 0.090 (0.090), Loss 0.0051 (0.0051)
11/29 12:25 EPOCH: 196 Train: Time 0.037 (0.043), Loss 0.0072 (0.0216)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:25 EPOCH: 196 Val: Prec@1 63.200 Prec@5 98.840
11/29 12:25 many acc 96.70, med acc 29.70, few acc 0.00
Best Prec@1: 68.380

Epoch: [197/200][0/395], Time 0.059 (0.059), Loss 0.0257 (0.0257)
11/29 12:25 EPOCH: 197 Train: Time 0.037 (0.043), Loss 0.0614 (0.0215)
===> Calculating KNN centroids.
Test: [0/157], Time 0.055 (0.055), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:25 EPOCH: 197 Val: Prec@1 62.690 Prec@5 98.850
11/29 12:25 many acc 96.72, med acc 28.66, few acc 0.00
Best Prec@1: 68.380

Epoch: [198/200][0/395], Time 0.086 (0.086), Loss 0.0039 (0.0039)
11/29 12:25 EPOCH: 198 Train: Time 0.037 (0.043), Loss 0.0129 (0.0215)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:26 EPOCH: 198 Val: Prec@1 64.180 Prec@5 98.830
11/29 12:26 many acc 96.62, med acc 31.74, few acc 0.00
Best Prec@1: 68.380

Epoch: [199/200][0/395], Time 0.085 (0.085), Loss 0.0556 (0.0556)
11/29 12:26 EPOCH: 199 Train: Time 0.037 (0.043), Loss 0.0055 (0.0217)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:26 EPOCH: 199 Val: Prec@1 63.290 Prec@5 98.850
11/29 12:26 many acc 96.66, med acc 29.92, few acc 0.00
Best Prec@1: 68.380

Epoch: [200/200][0/395], Time 0.060 (0.060), Loss 0.0039 (0.0039)
11/29 12:26 EPOCH: 200 Train: Time 0.037 (0.043), Loss 0.0502 (0.0215)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VS_5000_50_epoch_199.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VS_5000_50_epoch_199.png
11/29 12:26 Loss:0.997, Acc:0.99, NC1:128.991,
Wnorm:[1.468,1.423,1.470,1.423,1.451,0.380,0.325,0.315,0.403,0.395]
Hnorm:[9.434,9.447,9.058,9.035,9.008,9.674,8.382,8.214,9.777,8.856]
Wcos:[-0.209,-0.199,-0.186,-0.168,-0.174,0.051,0.069,0.075,0.006,0.014]
WHcos:[0.772,0.754,0.719,0.727,0.722,0.921,0.954,0.944,0.917,0.908]
11/29 12:26 -- Has saved the NC analysis result to ./output/cifar10_resnet32/0.01/name_2023-11-29/analysis199.pkl
===> Calculating KNN centroids.
Test: [0/157], Time 0.050 (0.050), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/29 12:27 EPOCH: 200 Val: Prec@1 62.800 Prec@5 98.770
11/29 12:27 many acc 96.58, med acc 29.02, few acc 0.00
Best Prec@1: 68.380

It took 1:29:39.09 to execute the program
