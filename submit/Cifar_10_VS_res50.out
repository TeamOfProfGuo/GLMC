Namespace(dataset='cifar10', root='../dataset/', arch='resnet50', num_classes=10, imbanlance_rate=0.01, lr=0.01, epochs=200, batch_size=64, momentum=0.9, weight_decay=0.005, resample_weighting=0.0, label_weighting=1.2, contrast_weight=4, beta=0.5, loss='vs', eps=0.05, seed=3407, print_freq=1000, gpu=0, workers=4, resume=None, start_epoch=0, root_model='./output/', store_name='cifar10_resnet50/0.01/name_2023-11-20', debug=10, knn=True)
Use GPU: 0 for training
=> creating model 'resnet50'
  + Number of params: 23.82M
Files already downloaded and verified
imbanlance_ration is 100.0
per class num: [5000, 2997, 1796, 1077, 645, 387, 232, 139, 83, 50]
Files already downloaded and verified
load cifar10
Training started!
Epoch: [1/200][0/194], Time 11.365 (11.365), Loss 5.0510 (5.0510)
11/20 03:01 EPOCH: 1 Train: Time 3.113 (0.160), Loss 2.2289 (5.0461)
===> Calculating KNN centroids.
Test: [0/157], Time 0.257 (0.257), Prec@1 14.062 (14.062), Prec@5 68.750 (68.750)
11/20 03:02 EPOCH: 1 Val: Prec@1 18.360 Prec@5 68.110
11/20 03:02 many acc 14.58, med acc 33.50, few acc 0.00
Best Prec@1: 18.360

Epoch: [2/200][0/194], Time 0.122 (0.122), Loss 2.2158 (2.2158)
11/20 03:02 EPOCH: 2 Train: Time 0.084 (0.087), Loss 2.5150 (2.4285)
===> Calculating KNN centroids.
Test: [0/157], Time 0.086 (0.086), Prec@1 26.562 (26.562), Prec@5 85.938 (85.938)
11/20 03:02 EPOCH: 2 Val: Prec@1 25.780 Prec@5 80.440
11/20 03:02 many acc 22.89, med acc 37.35, few acc 0.00
Best Prec@1: 25.780

Epoch: [3/200][0/194], Time 0.137 (0.137), Loss 2.9305 (2.9305)
11/20 03:02 EPOCH: 3 Train: Time 0.084 (0.087), Loss 2.1591 (2.1094)
===> Calculating KNN centroids.
Test: [0/157], Time 0.073 (0.073), Prec@1 20.312 (20.312), Prec@5 84.375 (84.375)
11/20 03:02 EPOCH: 3 Val: Prec@1 28.590 Prec@5 84.380
11/20 03:02 many acc 25.89, med acc 39.40, few acc 0.00
Best Prec@1: 28.590

Epoch: [4/200][0/194], Time 0.115 (0.115), Loss 1.7541 (1.7541)
11/20 03:03 EPOCH: 4 Train: Time 0.084 (0.087), Loss 1.9937 (2.0158)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 23.438 (23.438), Prec@5 84.375 (84.375)
11/20 03:03 EPOCH: 4 Val: Prec@1 29.700 Prec@5 84.720
11/20 03:03 many acc 27.64, med acc 37.95, few acc 0.00
Best Prec@1: 29.700

Epoch: [5/200][0/194], Time 0.107 (0.107), Loss 1.5425 (1.5425)
11/20 03:03 EPOCH: 5 Train: Time 0.084 (0.088), Loss 1.5002 (1.9122)
===> Calculating KNN centroids.
Test: [0/157], Time 0.080 (0.080), Prec@1 12.500 (12.500), Prec@5 82.812 (82.812)
11/20 03:03 EPOCH: 5 Val: Prec@1 29.170 Prec@5 84.450
11/20 03:03 many acc 26.64, med acc 39.30, few acc 0.00
Best Prec@1: 29.700

Epoch: [6/200][0/194], Time 0.109 (0.109), Loss 1.9250 (1.9250)
11/20 03:04 EPOCH: 6 Train: Time 0.085 (0.088), Loss 1.6291 (1.8445)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 21.875 (21.875), Prec@5 85.938 (85.938)
11/20 03:04 EPOCH: 6 Val: Prec@1 34.000 Prec@5 87.140
11/20 03:04 many acc 31.89, med acc 42.45, few acc 0.00
Best Prec@1: 34.000

Epoch: [7/200][0/194], Time 0.122 (0.122), Loss 1.7005 (1.7005)
11/20 03:04 EPOCH: 7 Train: Time 0.085 (0.088), Loss 1.5266 (1.7810)
===> Calculating KNN centroids.
Test: [0/157], Time 0.048 (0.048), Prec@1 15.625 (15.625), Prec@5 84.375 (84.375)
11/20 03:04 EPOCH: 7 Val: Prec@1 34.390 Prec@5 87.930
11/20 03:04 many acc 32.05, med acc 43.75, few acc 0.00
Best Prec@1: 34.390

Epoch: [8/200][0/194], Time 0.110 (0.110), Loss 1.6766 (1.6766)
11/20 03:04 EPOCH: 8 Train: Time 0.084 (0.088), Loss 1.4795 (1.7488)
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 29.688 (29.688), Prec@5 89.062 (89.062)
11/20 03:05 EPOCH: 8 Val: Prec@1 37.110 Prec@5 88.910
11/20 03:05 many acc 34.67, med acc 46.85, few acc 0.00
Best Prec@1: 37.110

Epoch: [9/200][0/194], Time 0.113 (0.113), Loss 1.3490 (1.3490)
11/20 03:05 EPOCH: 9 Train: Time 0.085 (0.088), Loss 1.7751 (1.7207)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 51.562 (51.562), Prec@5 89.062 (89.062)
11/20 03:05 EPOCH: 9 Val: Prec@1 38.420 Prec@5 88.920
11/20 03:05 many acc 35.95, med acc 48.30, few acc 0.00
Best Prec@1: 38.420

Epoch: [10/200][0/194], Time 0.113 (0.113), Loss 1.7745 (1.7745)
11/20 03:05 EPOCH: 10 Train: Time 0.085 (0.088), Loss 1.7169 (1.6826)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_9.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_9.png
11/20 03:06 Loss:46.430, Acc:0.02, NC1:376.407,
Wnorm:[1.236,2.489,0.983,1.030,0.967,1.088,1.189,1.238,1.554,1.677]
Hnorm:[3.275,3.170,1.821,1.980,2.447,2.462,2.925,2.349,4.237,2.828]
Wcos:[-0.038,-0.173,0.058,0.019,0.035,0.012,-0.031,-0.074,-0.184,-0.201]
WHcos:[0.546,0.382,0.515,0.669,0.627,0.812,0.732,0.851,0.885,0.669]
===> Calculating KNN centroids.
Test: [0/157], Time 0.084 (0.084), Prec@1 42.188 (42.188), Prec@5 90.625 (90.625)
11/20 03:06 EPOCH: 10 Val: Prec@1 38.500 Prec@5 89.330
11/20 03:06 many acc 35.96, med acc 48.65, few acc 0.00
Best Prec@1: 38.500

Epoch: [11/200][0/194], Time 0.119 (0.119), Loss 1.9191 (1.9191)
11/20 03:06 EPOCH: 11 Train: Time 0.085 (0.088), Loss 1.7586 (1.7019)
===> Calculating KNN centroids.
Test: [0/157], Time 0.097 (0.097), Prec@1 34.375 (34.375), Prec@5 87.500 (87.500)
11/20 03:06 EPOCH: 11 Val: Prec@1 38.630 Prec@5 89.400
11/20 03:06 many acc 35.74, med acc 50.20, few acc 0.00
Best Prec@1: 38.630

Epoch: [12/200][0/194], Time 0.114 (0.114), Loss 1.5197 (1.5197)
11/20 03:06 EPOCH: 12 Train: Time 0.084 (0.088), Loss 1.4231 (1.6545)
===> Calculating KNN centroids.
Test: [0/157], Time 0.087 (0.087), Prec@1 50.000 (50.000), Prec@5 90.625 (90.625)
11/20 03:07 EPOCH: 12 Val: Prec@1 40.900 Prec@5 90.190
11/20 03:07 many acc 38.93, med acc 48.80, few acc 0.00
Best Prec@1: 40.900

Epoch: [13/200][0/194], Time 0.098 (0.098), Loss 1.7223 (1.7223)
11/20 03:07 EPOCH: 13 Train: Time 0.084 (0.088), Loss 1.5049 (1.6229)
===> Calculating KNN centroids.
Test: [0/157], Time 0.072 (0.072), Prec@1 29.688 (29.688), Prec@5 92.188 (92.188)
11/20 03:07 EPOCH: 13 Val: Prec@1 39.220 Prec@5 89.330
11/20 03:07 many acc 37.51, med acc 46.05, few acc 0.00
Best Prec@1: 40.900

Epoch: [14/200][0/194], Time 0.109 (0.109), Loss 1.3853 (1.3853)
11/20 03:07 EPOCH: 14 Train: Time 0.084 (0.088), Loss 1.4127 (1.5999)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 34.375 (34.375), Prec@5 81.250 (81.250)
11/20 03:07 EPOCH: 14 Val: Prec@1 36.540 Prec@5 87.360
11/20 03:07 many acc 33.05, med acc 50.50, few acc 0.00
Best Prec@1: 40.900

Epoch: [15/200][0/194], Time 0.095 (0.095), Loss 1.7051 (1.7051)
11/20 03:08 EPOCH: 15 Train: Time 0.084 (0.088), Loss 1.6012 (1.6317)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 48.438 (48.438), Prec@5 85.938 (85.938)
11/20 03:08 EPOCH: 15 Val: Prec@1 40.580 Prec@5 89.420
11/20 03:08 many acc 38.79, med acc 47.75, few acc 0.00
Best Prec@1: 40.900

Epoch: [16/200][0/194], Time 0.087 (0.087), Loss 1.7080 (1.7080)
11/20 03:08 EPOCH: 16 Train: Time 0.084 (0.088), Loss 1.7114 (1.5869)
===> Calculating KNN centroids.
Test: [0/157], Time 0.100 (0.100), Prec@1 35.938 (35.938), Prec@5 90.625 (90.625)
11/20 03:08 EPOCH: 16 Val: Prec@1 40.710 Prec@5 89.800
11/20 03:08 many acc 38.29, med acc 50.40, few acc 0.00
Best Prec@1: 40.900

Epoch: [17/200][0/194], Time 0.094 (0.094), Loss 1.4362 (1.4362)
11/20 03:09 EPOCH: 17 Train: Time 0.085 (0.088), Loss 1.6321 (1.5402)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 42.188 (42.188), Prec@5 92.188 (92.188)
11/20 03:09 EPOCH: 17 Val: Prec@1 42.100 Prec@5 90.060
11/20 03:09 many acc 39.06, med acc 54.25, few acc 0.00
Best Prec@1: 42.100

Epoch: [18/200][0/194], Time 0.090 (0.090), Loss 1.2649 (1.2649)
11/20 03:09 EPOCH: 18 Train: Time 0.085 (0.088), Loss 1.1799 (1.5430)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 53.125 (53.125), Prec@5 92.188 (92.188)
11/20 03:09 EPOCH: 18 Val: Prec@1 42.240 Prec@5 90.640
11/20 03:09 many acc 41.70, med acc 44.40, few acc 0.00
Best Prec@1: 42.240

Epoch: [19/200][0/194], Time 0.108 (0.108), Loss 1.6163 (1.6163)
11/20 03:10 EPOCH: 19 Train: Time 0.084 (0.088), Loss 1.6363 (1.5625)
===> Calculating KNN centroids.
Test: [0/157], Time 0.078 (0.078), Prec@1 39.062 (39.062), Prec@5 92.188 (92.188)
11/20 03:10 EPOCH: 19 Val: Prec@1 43.330 Prec@5 91.700
11/20 03:10 many acc 41.67, med acc 49.95, few acc 0.00
Best Prec@1: 43.330

Epoch: [20/200][0/194], Time 0.108 (0.108), Loss 1.6598 (1.6598)
11/20 03:10 EPOCH: 20 Train: Time 0.085 (0.088), Loss 1.3549 (1.5307)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_19.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_19.png
11/20 03:10 Loss:48.507, Acc:0.03, NC1:204.191,
Wnorm:[1.201,1.552,0.925,0.897,1.004,1.071,1.250,1.168,1.568,1.435]
Hnorm:[2.740,3.593,1.746,1.983,2.050,2.309,2.479,2.322,3.501,3.030]
Wcos:[-0.054,-0.131,0.022,-0.001,-0.004,-0.003,-0.070,-0.085,-0.198,-0.263]
WHcos:[0.724,0.726,0.772,0.651,0.700,0.725,0.883,0.879,0.881,0.832]
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 43.750 (43.750), Prec@5 89.062 (89.062)
11/20 03:10 EPOCH: 20 Val: Prec@1 43.150 Prec@5 91.150
11/20 03:10 many acc 41.06, med acc 51.50, few acc 0.00
Best Prec@1: 43.330

Epoch: [21/200][0/194], Time 0.120 (0.120), Loss 1.3259 (1.3259)
11/20 03:11 EPOCH: 21 Train: Time 0.084 (0.088), Loss 1.8763 (1.5384)
===> Calculating KNN centroids.
Test: [0/157], Time 0.084 (0.084), Prec@1 42.188 (42.188), Prec@5 87.500 (87.500)
11/20 03:11 EPOCH: 21 Val: Prec@1 43.520 Prec@5 89.860
11/20 03:11 many acc 40.91, med acc 53.95, few acc 0.00
Best Prec@1: 43.520

Epoch: [22/200][0/194], Time 0.094 (0.094), Loss 1.5572 (1.5572)
11/20 03:11 EPOCH: 22 Train: Time 0.085 (0.088), Loss 2.0274 (1.5109)
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 46.875 (46.875), Prec@5 93.750 (93.750)
11/20 03:11 EPOCH: 22 Val: Prec@1 42.120 Prec@5 90.780
11/20 03:11 many acc 40.09, med acc 50.25, few acc 0.00
Best Prec@1: 43.520

Epoch: [23/200][0/194], Time 0.119 (0.119), Loss 1.3127 (1.3127)
11/20 03:11 EPOCH: 23 Train: Time 0.085 (0.088), Loss 2.0056 (1.5069)
===> Calculating KNN centroids.
Test: [0/157], Time 0.072 (0.072), Prec@1 40.625 (40.625), Prec@5 89.062 (89.062)
11/20 03:12 EPOCH: 23 Val: Prec@1 40.670 Prec@5 89.910
11/20 03:12 many acc 38.58, med acc 49.05, few acc 0.00
Best Prec@1: 43.520

Epoch: [24/200][0/194], Time 0.057 (0.057), Loss 1.6300 (1.6300)
11/20 03:12 EPOCH: 24 Train: Time 0.085 (0.088), Loss 1.4781 (1.4870)
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 34.375 (34.375), Prec@5 85.938 (85.938)
11/20 03:12 EPOCH: 24 Val: Prec@1 42.570 Prec@5 89.470
11/20 03:12 many acc 41.86, med acc 45.40, few acc 0.00
Best Prec@1: 43.520

Epoch: [25/200][0/194], Time 0.057 (0.057), Loss 1.6435 (1.6435)
11/20 03:12 EPOCH: 25 Train: Time 0.084 (0.088), Loss 1.4135 (1.5189)
===> Calculating KNN centroids.
Test: [0/157], Time 0.099 (0.099), Prec@1 40.625 (40.625), Prec@5 90.625 (90.625)
11/20 03:12 EPOCH: 25 Val: Prec@1 45.100 Prec@5 91.220
11/20 03:12 many acc 42.38, med acc 56.00, few acc 0.00
Best Prec@1: 45.100

Epoch: [26/200][0/194], Time 0.119 (0.119), Loss 1.3059 (1.3059)
11/20 03:13 EPOCH: 26 Train: Time 0.084 (0.088), Loss 1.3443 (1.4482)
===> Calculating KNN centroids.
Test: [0/157], Time 0.073 (0.073), Prec@1 54.688 (54.688), Prec@5 90.625 (90.625)
11/20 03:13 EPOCH: 26 Val: Prec@1 45.700 Prec@5 91.750
11/20 03:13 many acc 45.15, med acc 47.90, few acc 0.00
Best Prec@1: 45.700

Epoch: [27/200][0/194], Time 0.125 (0.125), Loss 1.3201 (1.3201)
11/20 03:13 EPOCH: 27 Train: Time 0.084 (0.088), Loss 1.1628 (1.4137)
===> Calculating KNN centroids.
Test: [0/157], Time 0.096 (0.096), Prec@1 42.188 (42.188), Prec@5 89.062 (89.062)
11/20 03:13 EPOCH: 27 Val: Prec@1 43.510 Prec@5 90.430
11/20 03:13 many acc 41.03, med acc 53.45, few acc 0.00
Best Prec@1: 45.700

Epoch: [28/200][0/194], Time 0.096 (0.096), Loss 1.5607 (1.5607)
11/20 03:14 EPOCH: 28 Train: Time 0.084 (0.088), Loss 1.3058 (1.4483)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 31.250 (31.250), Prec@5 87.500 (87.500)
11/20 03:14 EPOCH: 28 Val: Prec@1 47.240 Prec@5 92.000
11/20 03:14 many acc 45.26, med acc 55.15, few acc 0.00
Best Prec@1: 47.240

Epoch: [29/200][0/194], Time 0.088 (0.088), Loss 0.9232 (0.9232)
11/20 03:14 EPOCH: 29 Train: Time 0.085 (0.088), Loss 1.5278 (1.4449)
===> Calculating KNN centroids.
Test: [0/157], Time 0.081 (0.081), Prec@1 45.312 (45.312), Prec@5 90.625 (90.625)
11/20 03:14 EPOCH: 29 Val: Prec@1 47.090 Prec@5 91.650
11/20 03:14 many acc 44.40, med acc 57.85, few acc 0.00
Best Prec@1: 47.240

Epoch: [30/200][0/194], Time 0.079 (0.079), Loss 1.3036 (1.3036)
11/20 03:15 EPOCH: 30 Train: Time 0.085 (0.088), Loss 1.6758 (1.4336)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_29.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_29.png
11/20 03:15 Loss:57.380, Acc:0.02, NC1:95.054,
Wnorm:[1.320,1.590,1.052,1.043,1.088,1.174,1.404,1.334,1.763,1.687]
Hnorm:[2.913,3.233,1.749,1.551,2.364,1.977,2.712,2.926,4.117,3.753]
Wcos:[-0.053,-0.111,0.022,0.004,-0.004,-0.009,-0.063,-0.092,-0.210,-0.273]
WHcos:[0.697,0.779,0.615,0.870,0.641,0.879,0.899,0.962,0.921,0.938]
===> Calculating KNN centroids.
Test: [0/157], Time 0.085 (0.085), Prec@1 35.938 (35.938), Prec@5 87.500 (87.500)
11/20 03:15 EPOCH: 30 Val: Prec@1 44.980 Prec@5 91.650
11/20 03:15 many acc 39.71, med acc 66.05, few acc 0.00
Best Prec@1: 47.240

Epoch: [31/200][0/194], Time 0.109 (0.109), Loss 1.5976 (1.5976)
11/20 03:15 EPOCH: 31 Train: Time 0.085 (0.088), Loss 2.0055 (1.4351)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 12.500 (12.500), Prec@5 87.500 (87.500)
11/20 03:15 EPOCH: 31 Val: Prec@1 39.660 Prec@5 88.420
11/20 03:15 many acc 35.12, med acc 57.80, few acc 0.00
Best Prec@1: 47.240

Epoch: [32/200][0/194], Time 0.080 (0.080), Loss 1.6272 (1.6272)
11/20 03:16 EPOCH: 32 Train: Time 0.085 (0.088), Loss 1.4710 (1.3867)
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 42.188 (42.188), Prec@5 84.375 (84.375)
11/20 03:16 EPOCH: 32 Val: Prec@1 45.680 Prec@5 90.650
11/20 03:16 many acc 42.70, med acc 57.60, few acc 0.00
Best Prec@1: 47.240

Epoch: [33/200][0/194], Time 0.115 (0.115), Loss 1.8359 (1.8359)
11/20 03:16 EPOCH: 33 Train: Time 0.085 (0.088), Loss 2.1570 (1.3635)
===> Calculating KNN centroids.
Test: [0/157], Time 0.083 (0.083), Prec@1 29.688 (29.688), Prec@5 85.938 (85.938)
11/20 03:16 EPOCH: 33 Val: Prec@1 44.480 Prec@5 90.350
11/20 03:16 many acc 41.51, med acc 56.35, few acc 0.00
Best Prec@1: 47.240

Epoch: [34/200][0/194], Time 0.125 (0.125), Loss 2.2190 (2.2190)
11/20 03:16 EPOCH: 34 Train: Time 0.085 (0.088), Loss 1.4332 (1.3732)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 18.750 (18.750), Prec@5 85.938 (85.938)
11/20 03:17 EPOCH: 34 Val: Prec@1 46.980 Prec@5 91.660
11/20 03:17 many acc 42.75, med acc 63.90, few acc 0.00
Best Prec@1: 47.240

Epoch: [35/200][0/194], Time 0.103 (0.103), Loss 1.6254 (1.6254)
11/20 03:17 EPOCH: 35 Train: Time 0.085 (0.088), Loss 1.5280 (1.3784)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 37.500 (37.500), Prec@5 90.625 (90.625)
11/20 03:17 EPOCH: 35 Val: Prec@1 48.330 Prec@5 93.080
11/20 03:17 many acc 44.54, med acc 63.50, few acc 0.00
Best Prec@1: 48.330

Epoch: [36/200][0/194], Time 0.096 (0.096), Loss 1.1139 (1.1139)
11/20 03:17 EPOCH: 36 Train: Time 0.085 (0.088), Loss 1.3587 (1.3762)
===> Calculating KNN centroids.
Test: [0/157], Time 0.076 (0.076), Prec@1 35.938 (35.938), Prec@5 93.750 (93.750)
11/20 03:17 EPOCH: 36 Val: Prec@1 53.690 Prec@5 93.950
11/20 03:17 many acc 49.25, med acc 71.45, few acc 0.00
Best Prec@1: 53.690

Epoch: [37/200][0/194], Time 0.108 (0.108), Loss 1.3475 (1.3475)
11/20 03:18 EPOCH: 37 Train: Time 0.084 (0.088), Loss 0.9463 (1.3217)
===> Calculating KNN centroids.
Test: [0/157], Time 0.091 (0.091), Prec@1 31.250 (31.250), Prec@5 93.750 (93.750)
11/20 03:18 EPOCH: 37 Val: Prec@1 49.990 Prec@5 93.440
11/20 03:18 many acc 47.52, med acc 59.85, few acc 0.00
Best Prec@1: 53.690

Epoch: [38/200][0/194], Time 0.057 (0.057), Loss 1.4330 (1.4330)
11/20 03:18 EPOCH: 38 Train: Time 0.084 (0.088), Loss 1.2575 (1.3036)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 39.062 (39.062), Prec@5 90.625 (90.625)
11/20 03:18 EPOCH: 38 Val: Prec@1 49.900 Prec@5 92.690
11/20 03:18 many acc 47.11, med acc 61.05, few acc 0.00
Best Prec@1: 53.690

Epoch: [39/200][0/194], Time 0.057 (0.057), Loss 1.3080 (1.3080)
11/20 03:19 EPOCH: 39 Train: Time 0.084 (0.088), Loss 1.0775 (1.3385)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 46.875 (46.875), Prec@5 89.062 (89.062)
11/20 03:19 EPOCH: 39 Val: Prec@1 55.190 Prec@5 94.310
11/20 03:19 many acc 51.20, med acc 71.15, few acc 0.00
Best Prec@1: 55.190

Epoch: [40/200][0/194], Time 0.121 (0.121), Loss 1.0956 (1.0956)
11/20 03:19 EPOCH: 40 Train: Time 0.085 (0.088), Loss 0.8523 (1.3106)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_39.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_39.png
11/20 03:19 Loss:44.223, Acc:0.05, NC1:74.821,
Wnorm:[1.428,1.760,1.232,1.039,1.221,1.236,1.356,1.379,1.800,1.737]
Hnorm:[2.669,3.149,1.923,1.659,1.973,2.669,2.772,3.978,3.677,3.774]
Wcos:[-0.075,-0.121,0.001,-0.011,-0.034,-0.014,-0.060,-0.094,-0.199,-0.251]
WHcos:[0.735,0.848,0.910,0.849,0.819,0.938,0.888,0.955,0.878,0.939]
===> Calculating KNN centroids.
Test: [0/157], Time 0.085 (0.085), Prec@1 26.562 (26.562), Prec@5 93.750 (93.750)
11/20 03:19 EPOCH: 40 Val: Prec@1 53.000 Prec@5 93.930
11/20 03:19 many acc 49.74, med acc 66.05, few acc 0.00
Best Prec@1: 55.190

Epoch: [41/200][0/194], Time 0.112 (0.112), Loss 1.1299 (1.1299)
11/20 03:20 EPOCH: 41 Train: Time 0.084 (0.088), Loss 1.1424 (1.2983)
===> Calculating KNN centroids.
Test: [0/157], Time 0.085 (0.085), Prec@1 53.125 (53.125), Prec@5 92.188 (92.188)
11/20 03:20 EPOCH: 41 Val: Prec@1 53.630 Prec@5 94.110
11/20 03:20 many acc 49.04, med acc 72.00, few acc 0.00
Best Prec@1: 55.190

Epoch: [42/200][0/194], Time 0.113 (0.113), Loss 0.8491 (0.8491)
11/20 03:20 EPOCH: 42 Train: Time 0.084 (0.088), Loss 1.1055 (1.2929)
===> Calculating KNN centroids.
Test: [0/157], Time 0.072 (0.072), Prec@1 45.312 (45.312), Prec@5 92.188 (92.188)
11/20 03:20 EPOCH: 42 Val: Prec@1 52.330 Prec@5 93.320
11/20 03:20 many acc 50.46, med acc 59.80, few acc 0.00
Best Prec@1: 55.190

Epoch: [43/200][0/194], Time 0.108 (0.108), Loss 1.2214 (1.2214)
11/20 03:21 EPOCH: 43 Train: Time 0.084 (0.088), Loss 1.5295 (1.2673)
===> Calculating KNN centroids.
Test: [0/157], Time 0.071 (0.071), Prec@1 42.188 (42.188), Prec@5 92.188 (92.188)
11/20 03:21 EPOCH: 43 Val: Prec@1 52.400 Prec@5 92.490
11/20 03:21 many acc 47.24, med acc 73.05, few acc 0.00
Best Prec@1: 55.190

Epoch: [44/200][0/194], Time 0.105 (0.105), Loss 1.0478 (1.0478)
11/20 03:21 EPOCH: 44 Train: Time 0.085 (0.088), Loss 0.9872 (1.3311)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 42.188 (42.188), Prec@5 87.500 (87.500)
11/20 03:21 EPOCH: 44 Val: Prec@1 47.900 Prec@5 92.160
11/20 03:21 many acc 43.71, med acc 64.65, few acc 0.00
Best Prec@1: 55.190

Epoch: [45/200][0/194], Time 0.102 (0.102), Loss 1.1087 (1.1087)
11/20 03:21 EPOCH: 45 Train: Time 0.085 (0.088), Loss 1.5359 (1.2652)
===> Calculating KNN centroids.
Test: [0/157], Time 0.039 (0.039), Prec@1 23.438 (23.438), Prec@5 90.625 (90.625)
11/20 03:22 EPOCH: 45 Val: Prec@1 49.490 Prec@5 93.090
11/20 03:22 many acc 43.45, med acc 73.65, few acc 0.00
Best Prec@1: 55.190

Epoch: [46/200][0/194], Time 0.089 (0.089), Loss 1.0994 (1.0994)
11/20 03:22 EPOCH: 46 Train: Time 0.085 (0.088), Loss 1.7112 (1.2439)
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 35.938 (35.938), Prec@5 87.500 (87.500)
11/20 03:22 EPOCH: 46 Val: Prec@1 52.310 Prec@5 92.520
11/20 03:22 many acc 48.30, med acc 68.35, few acc 0.00
Best Prec@1: 55.190

Epoch: [47/200][0/194], Time 0.121 (0.121), Loss 1.0810 (1.0810)
11/20 03:22 EPOCH: 47 Train: Time 0.085 (0.088), Loss 1.2056 (1.2768)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 46.875 (46.875), Prec@5 89.062 (89.062)
11/20 03:22 EPOCH: 47 Val: Prec@1 53.500 Prec@5 93.420
11/20 03:22 many acc 50.47, med acc 65.60, few acc 0.00
Best Prec@1: 55.190

Epoch: [48/200][0/194], Time 0.111 (0.111), Loss 1.4755 (1.4755)
11/20 03:23 EPOCH: 48 Train: Time 0.084 (0.088), Loss 1.0632 (1.3003)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 42.188 (42.188), Prec@5 89.062 (89.062)
11/20 03:23 EPOCH: 48 Val: Prec@1 50.020 Prec@5 92.380
11/20 03:23 many acc 48.69, med acc 55.35, few acc 0.00
Best Prec@1: 55.190

Epoch: [49/200][0/194], Time 0.114 (0.114), Loss 1.7050 (1.7050)
11/20 03:23 EPOCH: 49 Train: Time 0.085 (0.088), Loss 1.0048 (1.2409)
===> Calculating KNN centroids.
Test: [0/157], Time 0.081 (0.081), Prec@1 50.000 (50.000), Prec@5 92.188 (92.188)
11/20 03:23 EPOCH: 49 Val: Prec@1 52.940 Prec@5 93.860
11/20 03:23 many acc 47.91, med acc 73.05, few acc 0.00
Best Prec@1: 55.190

Epoch: [50/200][0/194], Time 0.088 (0.088), Loss 1.4477 (1.4477)
11/20 03:24 EPOCH: 50 Train: Time 0.085 (0.088), Loss 2.0460 (1.2757)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_49.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_49.png
11/20 03:24 Loss:40.194, Acc:0.05, NC1:68.870,
Wnorm:[1.471,1.698,1.242,1.013,1.230,1.238,1.390,1.376,1.797,1.742]
Hnorm:[2.397,3.287,2.031,1.506,2.107,2.154,4.455,2.523,3.628,4.368]
Wcos:[-0.078,-0.126,-0.001,-0.009,-0.043,-0.011,-0.069,-0.089,-0.196,-0.246]
WHcos:[0.780,0.769,0.788,0.821,0.796,0.951,0.960,0.937,0.906,0.919]
11/20 03:24 -- Has saved the NC analysis result to ./output/cifar10_resnet50/0.01/name_2023-11-20/analysis49.pkl
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 42.188 (42.188), Prec@5 90.625 (90.625)
11/20 03:24 EPOCH: 50 Val: Prec@1 52.250 Prec@5 93.350
11/20 03:24 many acc 48.00, med acc 69.25, few acc 0.00
Best Prec@1: 55.190

Epoch: [51/200][0/194], Time 0.111 (0.111), Loss 0.6134 (0.6134)
11/20 03:24 EPOCH: 51 Train: Time 0.085 (0.088), Loss 0.9614 (1.2555)
===> Calculating KNN centroids.
Test: [0/157], Time 0.087 (0.087), Prec@1 28.125 (28.125), Prec@5 89.062 (89.062)
11/20 03:24 EPOCH: 51 Val: Prec@1 49.630 Prec@5 92.780
11/20 03:24 many acc 46.36, med acc 62.70, few acc 0.00
Best Prec@1: 55.190

Epoch: [52/200][0/194], Time 0.086 (0.086), Loss 1.1900 (1.1900)
11/20 03:25 EPOCH: 52 Train: Time 0.085 (0.088), Loss 0.7545 (1.1980)
===> Calculating KNN centroids.
Test: [0/157], Time 0.085 (0.085), Prec@1 62.500 (62.500), Prec@5 89.062 (89.062)
11/20 03:25 EPOCH: 52 Val: Prec@1 54.260 Prec@5 93.460
11/20 03:25 many acc 51.26, med acc 66.25, few acc 0.00
Best Prec@1: 55.190

Epoch: [53/200][0/194], Time 0.119 (0.119), Loss 0.8807 (0.8807)
11/20 03:25 EPOCH: 53 Train: Time 0.084 (0.088), Loss 0.7343 (1.1991)
===> Calculating KNN centroids.
Test: [0/157], Time 0.073 (0.073), Prec@1 51.562 (51.562), Prec@5 84.375 (84.375)
11/20 03:25 EPOCH: 53 Val: Prec@1 50.040 Prec@5 91.550
11/20 03:25 many acc 48.05, med acc 58.00, few acc 0.00
Best Prec@1: 55.190

Epoch: [54/200][0/194], Time 0.093 (0.093), Loss 1.3747 (1.3747)
11/20 03:26 EPOCH: 54 Train: Time 0.084 (0.088), Loss 1.3916 (1.2590)
===> Calculating KNN centroids.
Test: [0/157], Time 0.092 (0.092), Prec@1 48.438 (48.438), Prec@5 93.750 (93.750)
11/20 03:26 EPOCH: 54 Val: Prec@1 47.700 Prec@5 91.590
11/20 03:26 many acc 42.30, med acc 69.30, few acc 0.00
Best Prec@1: 55.190

Epoch: [55/200][0/194], Time 0.057 (0.057), Loss 1.2245 (1.2245)
11/20 03:26 EPOCH: 55 Train: Time 0.084 (0.088), Loss 1.5833 (1.2224)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 25.000 (25.000), Prec@5 89.062 (89.062)
11/20 03:26 EPOCH: 55 Val: Prec@1 50.190 Prec@5 93.080
11/20 03:26 many acc 47.77, med acc 59.85, few acc 0.00
Best Prec@1: 55.190

Epoch: [56/200][0/194], Time 0.088 (0.088), Loss 1.5260 (1.5260)
11/20 03:26 EPOCH: 56 Train: Time 0.085 (0.088), Loss 0.9819 (1.1953)
===> Calculating KNN centroids.
Test: [0/157], Time 0.073 (0.073), Prec@1 59.375 (59.375), Prec@5 84.375 (84.375)
11/20 03:27 EPOCH: 56 Val: Prec@1 55.080 Prec@5 93.350
11/20 03:27 many acc 52.25, med acc 66.40, few acc 0.00
Best Prec@1: 55.190

Epoch: [57/200][0/194], Time 0.111 (0.111), Loss 1.3790 (1.3790)
11/20 03:27 EPOCH: 57 Train: Time 0.084 (0.088), Loss 1.1221 (1.1329)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 53.125 (53.125), Prec@5 89.062 (89.062)
11/20 03:27 EPOCH: 57 Val: Prec@1 51.810 Prec@5 92.020
11/20 03:27 many acc 48.19, med acc 66.30, few acc 0.00
Best Prec@1: 55.190

Epoch: [58/200][0/194], Time 0.088 (0.088), Loss 0.9736 (0.9736)
11/20 03:27 EPOCH: 58 Train: Time 0.084 (0.088), Loss 0.9970 (1.2215)
===> Calculating KNN centroids.
Test: [0/157], Time 0.072 (0.072), Prec@1 45.312 (45.312), Prec@5 85.938 (85.938)
11/20 03:27 EPOCH: 58 Val: Prec@1 54.230 Prec@5 93.760
11/20 03:27 many acc 50.81, med acc 67.90, few acc 0.00
Best Prec@1: 55.190

Epoch: [59/200][0/194], Time 0.117 (0.117), Loss 1.5265 (1.5265)
11/20 03:28 EPOCH: 59 Train: Time 0.084 (0.088), Loss 1.5505 (1.1752)
===> Calculating KNN centroids.
Test: [0/157], Time 0.080 (0.080), Prec@1 46.875 (46.875), Prec@5 89.062 (89.062)
11/20 03:28 EPOCH: 59 Val: Prec@1 54.230 Prec@5 93.430
11/20 03:28 many acc 52.74, med acc 60.20, few acc 0.00
Best Prec@1: 55.190

Epoch: [60/200][0/194], Time 0.129 (0.129), Loss 0.9257 (0.9257)
11/20 03:28 EPOCH: 60 Train: Time 0.084 (0.088), Loss 1.7300 (1.1746)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_59.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_59.png
11/20 03:28 Loss:34.442, Acc:0.05, NC1:42.660,
Wnorm:[1.425,1.732,1.266,1.076,1.249,1.300,1.407,1.477,1.780,1.634]
Hnorm:[2.936,3.784,1.587,1.634,2.392,2.722,4.294,6.536,4.034,3.181]
Wcos:[-0.079,-0.116,-0.015,-0.023,-0.048,-0.024,-0.070,-0.114,-0.193,-0.229]
WHcos:[0.769,0.859,0.943,0.863,0.623,0.934,0.959,0.966,0.853,0.935]
===> Calculating KNN centroids.
Test: [0/157], Time 0.076 (0.076), Prec@1 56.250 (56.250), Prec@5 89.062 (89.062)
11/20 03:29 EPOCH: 60 Val: Prec@1 52.330 Prec@5 93.560
11/20 03:29 many acc 52.66, med acc 51.00, few acc 0.00
Best Prec@1: 55.190

Epoch: [61/200][0/194], Time 0.111 (0.111), Loss 1.1003 (1.1003)
11/20 03:29 EPOCH: 61 Train: Time 0.085 (0.088), Loss 0.8311 (1.1550)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 43.750 (43.750), Prec@5 92.188 (92.188)
11/20 03:29 EPOCH: 61 Val: Prec@1 54.250 Prec@5 93.650
11/20 03:29 many acc 50.00, med acc 71.25, few acc 0.00
Best Prec@1: 55.190

Epoch: [62/200][0/194], Time 0.106 (0.106), Loss 1.2274 (1.2274)
11/20 03:29 EPOCH: 62 Train: Time 0.084 (0.088), Loss 1.2744 (1.1354)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 59.375 (59.375), Prec@5 92.188 (92.188)
11/20 03:29 EPOCH: 62 Val: Prec@1 57.470 Prec@5 94.570
11/20 03:29 many acc 53.64, med acc 72.80, few acc 0.00
Best Prec@1: 57.470

Epoch: [63/200][0/194], Time 0.108 (0.108), Loss 0.8142 (0.8142)
11/20 03:30 EPOCH: 63 Train: Time 0.085 (0.088), Loss 1.2655 (1.1869)
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 48.438 (48.438), Prec@5 84.375 (84.375)
11/20 03:30 EPOCH: 63 Val: Prec@1 54.220 Prec@5 93.060
11/20 03:30 many acc 52.05, med acc 62.90, few acc 0.00
Best Prec@1: 57.470

Epoch: [64/200][0/194], Time 0.124 (0.124), Loss 1.0216 (1.0216)
11/20 03:30 EPOCH: 64 Train: Time 0.084 (0.088), Loss 1.0498 (1.1699)
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 50.000 (50.000), Prec@5 87.500 (87.500)
11/20 03:30 EPOCH: 64 Val: Prec@1 54.050 Prec@5 92.700
11/20 03:30 many acc 51.32, med acc 64.95, few acc 0.00
Best Prec@1: 57.470

Epoch: [65/200][0/194], Time 0.079 (0.079), Loss 1.1064 (1.1064)
11/20 03:31 EPOCH: 65 Train: Time 0.084 (0.088), Loss 1.4222 (1.2037)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 62.500 (62.500), Prec@5 90.625 (90.625)
11/20 03:31 EPOCH: 65 Val: Prec@1 54.260 Prec@5 93.010
11/20 03:31 many acc 50.56, med acc 69.05, few acc 0.00
Best Prec@1: 57.470

Epoch: [66/200][0/194], Time 0.090 (0.090), Loss 1.0655 (1.0655)
11/20 03:31 EPOCH: 66 Train: Time 0.084 (0.088), Loss 1.3484 (1.1723)
===> Calculating KNN centroids.
Test: [0/157], Time 0.093 (0.093), Prec@1 43.750 (43.750), Prec@5 89.062 (89.062)
11/20 03:31 EPOCH: 66 Val: Prec@1 53.740 Prec@5 93.340
11/20 03:31 many acc 50.19, med acc 67.95, few acc 0.00
Best Prec@1: 57.470

Epoch: [67/200][0/194], Time 0.117 (0.117), Loss 0.8779 (0.8779)
11/20 03:31 EPOCH: 67 Train: Time 0.084 (0.088), Loss 0.5889 (1.1231)
===> Calculating KNN centroids.
Test: [0/157], Time 0.083 (0.083), Prec@1 48.438 (48.438), Prec@5 87.500 (87.500)
11/20 03:32 EPOCH: 67 Val: Prec@1 56.580 Prec@5 94.650
11/20 03:32 many acc 52.68, med acc 72.20, few acc 0.00
Best Prec@1: 57.470

Epoch: [68/200][0/194], Time 0.116 (0.116), Loss 0.8973 (0.8973)
11/20 03:32 EPOCH: 68 Train: Time 0.084 (0.088), Loss 0.8234 (1.1451)
===> Calculating KNN centroids.
Test: [0/157], Time 0.080 (0.080), Prec@1 45.312 (45.312), Prec@5 89.062 (89.062)
11/20 03:32 EPOCH: 68 Val: Prec@1 51.410 Prec@5 92.290
11/20 03:32 many acc 49.51, med acc 59.00, few acc 0.00
Best Prec@1: 57.470

Epoch: [69/200][0/194], Time 0.080 (0.080), Loss 1.1451 (1.1451)
11/20 03:32 EPOCH: 69 Train: Time 0.084 (0.088), Loss 1.0518 (1.1732)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 65.625 (65.625), Prec@5 90.625 (90.625)
11/20 03:32 EPOCH: 69 Val: Prec@1 60.340 Prec@5 95.080
11/20 03:32 many acc 58.54, med acc 67.55, few acc 0.00
Best Prec@1: 60.340

Epoch: [70/200][0/194], Time 0.108 (0.108), Loss 1.0079 (1.0079)
11/20 03:33 EPOCH: 70 Train: Time 0.085 (0.088), Loss 1.2613 (1.2239)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_69.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_69.png
11/20 03:33 Loss:32.881, Acc:0.07, NC1:45.980,
Wnorm:[1.440,1.703,1.288,1.038,1.220,1.241,1.410,1.443,1.686,1.684]
Hnorm:[2.947,3.309,1.683,1.683,2.180,2.603,3.640,3.551,3.792,3.335]
Wcos:[-0.078,-0.114,-0.011,-0.019,-0.043,-0.030,-0.070,-0.105,-0.191,-0.240]
WHcos:[0.752,0.913,0.944,0.766,0.830,0.915,0.965,0.955,0.870,0.976]
===> Calculating KNN centroids.
Test: [0/157], Time 0.087 (0.087), Prec@1 43.750 (43.750), Prec@5 93.750 (93.750)
11/20 03:33 EPOCH: 70 Val: Prec@1 53.900 Prec@5 93.790
11/20 03:33 many acc 51.89, med acc 61.95, few acc 0.00
Best Prec@1: 60.340

Epoch: [71/200][0/194], Time 0.112 (0.112), Loss 1.0405 (1.0405)
11/20 03:33 EPOCH: 71 Train: Time 0.084 (0.088), Loss 0.8789 (1.0890)
===> Calculating KNN centroids.
Test: [0/157], Time 0.098 (0.098), Prec@1 34.375 (34.375), Prec@5 89.062 (89.062)
11/20 03:34 EPOCH: 71 Val: Prec@1 50.940 Prec@5 92.040
11/20 03:34 many acc 48.88, med acc 59.20, few acc 0.00
Best Prec@1: 60.340

Epoch: [72/200][0/194], Time 0.083 (0.083), Loss 1.0463 (1.0463)
11/20 03:34 EPOCH: 72 Train: Time 0.085 (0.088), Loss 1.2620 (1.1893)
===> Calculating KNN centroids.
Test: [0/157], Time 0.079 (0.079), Prec@1 57.812 (57.812), Prec@5 87.500 (87.500)
11/20 03:34 EPOCH: 72 Val: Prec@1 51.920 Prec@5 92.060
11/20 03:34 many acc 52.60, med acc 49.20, few acc 0.00
Best Prec@1: 60.340

Epoch: [73/200][0/194], Time 0.087 (0.087), Loss 1.2606 (1.2606)
11/20 03:34 EPOCH: 73 Train: Time 0.085 (0.088), Loss 0.8271 (1.0660)
===> Calculating KNN centroids.
Test: [0/157], Time 0.087 (0.087), Prec@1 35.938 (35.938), Prec@5 90.625 (90.625)
11/20 03:34 EPOCH: 73 Val: Prec@1 57.970 Prec@5 94.650
11/20 03:34 many acc 53.35, med acc 76.45, few acc 0.00
Best Prec@1: 60.340

Epoch: [74/200][0/194], Time 0.119 (0.119), Loss 1.1518 (1.1518)
11/20 03:35 EPOCH: 74 Train: Time 0.085 (0.088), Loss 0.9352 (1.0357)
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 40.625 (40.625), Prec@5 89.062 (89.062)
11/20 03:35 EPOCH: 74 Val: Prec@1 58.150 Prec@5 94.460
11/20 03:35 many acc 54.21, med acc 73.90, few acc 0.00
Best Prec@1: 60.340

Epoch: [75/200][0/194], Time 0.111 (0.111), Loss 0.8793 (0.8793)
11/20 03:35 EPOCH: 75 Train: Time 0.085 (0.088), Loss 0.7987 (1.1498)
===> Calculating KNN centroids.
Test: [0/157], Time 0.099 (0.099), Prec@1 32.812 (32.812), Prec@5 90.625 (90.625)
11/20 03:35 EPOCH: 75 Val: Prec@1 55.760 Prec@5 94.500
11/20 03:35 many acc 51.52, med acc 72.70, few acc 0.00
Best Prec@1: 60.340

Epoch: [76/200][0/194], Time 0.057 (0.057), Loss 1.2612 (1.2612)
11/20 03:36 EPOCH: 76 Train: Time 0.084 (0.088), Loss 0.8712 (1.0860)
===> Calculating KNN centroids.
Test: [0/157], Time 0.097 (0.097), Prec@1 50.000 (50.000), Prec@5 90.625 (90.625)
11/20 03:36 EPOCH: 76 Val: Prec@1 57.980 Prec@5 95.350
11/20 03:36 many acc 53.33, med acc 76.60, few acc 0.00
Best Prec@1: 60.340

Epoch: [77/200][0/194], Time 0.109 (0.109), Loss 1.2989 (1.2989)
11/20 03:36 EPOCH: 77 Train: Time 0.085 (0.088), Loss 0.9499 (1.1354)
===> Calculating KNN centroids.
Test: [0/157], Time 0.073 (0.073), Prec@1 60.938 (60.938), Prec@5 92.188 (92.188)
11/20 03:36 EPOCH: 77 Val: Prec@1 57.690 Prec@5 94.260
11/20 03:36 many acc 54.75, med acc 69.45, few acc 0.00
Best Prec@1: 60.340

Epoch: [78/200][0/194], Time 0.117 (0.117), Loss 1.2073 (1.2073)
11/20 03:36 EPOCH: 78 Train: Time 0.084 (0.088), Loss 1.3338 (1.1183)
===> Calculating KNN centroids.
Test: [0/157], Time 0.082 (0.082), Prec@1 64.062 (64.062), Prec@5 90.625 (90.625)
11/20 03:37 EPOCH: 78 Val: Prec@1 57.240 Prec@5 94.710
11/20 03:37 many acc 56.67, med acc 59.50, few acc 0.00
Best Prec@1: 60.340

Epoch: [79/200][0/194], Time 0.057 (0.057), Loss 0.9374 (0.9374)
11/20 03:37 EPOCH: 79 Train: Time 0.084 (0.088), Loss 1.1105 (1.0925)
===> Calculating KNN centroids.
Test: [0/157], Time 0.082 (0.082), Prec@1 57.812 (57.812), Prec@5 92.188 (92.188)
11/20 03:37 EPOCH: 79 Val: Prec@1 57.970 Prec@5 94.880
11/20 03:37 many acc 53.35, med acc 76.45, few acc 0.00
Best Prec@1: 60.340

Epoch: [80/200][0/194], Time 0.091 (0.091), Loss 1.1883 (1.1883)
11/20 03:37 EPOCH: 80 Train: Time 0.085 (0.088), Loss 1.4988 (1.1004)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_79.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_79.png
11/20 03:38 Loss:37.415, Acc:0.06, NC1:38.703,
Wnorm:[1.418,1.718,1.307,1.094,1.241,1.237,1.383,1.483,1.726,1.713]
Hnorm:[2.515,3.242,1.931,1.779,2.360,2.494,4.016,4.038,5.040,4.451]
Wcos:[-0.084,-0.123,-0.020,-0.030,-0.057,-0.030,-0.072,-0.097,-0.181,-0.229]
WHcos:[0.844,0.873,0.819,0.880,0.808,0.899,0.973,0.985,0.957,0.962]
===> Calculating KNN centroids.
Test: [0/157], Time 0.039 (0.039), Prec@1 46.875 (46.875), Prec@5 92.188 (92.188)
11/20 03:38 EPOCH: 80 Val: Prec@1 56.650 Prec@5 95.140
11/20 03:38 many acc 52.50, med acc 73.25, few acc 0.00
Best Prec@1: 60.340

Epoch: [81/200][0/194], Time 0.105 (0.105), Loss 0.9086 (0.9086)
11/20 03:38 EPOCH: 81 Train: Time 0.085 (0.088), Loss 1.1751 (1.0802)
===> Calculating KNN centroids.
Test: [0/157], Time 0.086 (0.086), Prec@1 50.000 (50.000), Prec@5 89.062 (89.062)
11/20 03:38 EPOCH: 81 Val: Prec@1 57.170 Prec@5 94.270
11/20 03:38 many acc 53.00, med acc 73.85, few acc 0.00
Best Prec@1: 60.340

Epoch: [82/200][0/194], Time 0.113 (0.113), Loss 1.1138 (1.1138)
11/20 03:38 EPOCH: 82 Train: Time 0.084 (0.088), Loss 0.9168 (1.0562)
===> Calculating KNN centroids.
Test: [0/157], Time 0.084 (0.084), Prec@1 46.875 (46.875), Prec@5 92.188 (92.188)
11/20 03:39 EPOCH: 82 Val: Prec@1 59.060 Prec@5 95.150
11/20 03:39 many acc 54.55, med acc 77.10, few acc 0.00
Best Prec@1: 60.340

Epoch: [83/200][0/194], Time 0.098 (0.098), Loss 1.2386 (1.2386)
11/20 03:39 EPOCH: 83 Train: Time 0.084 (0.088), Loss 1.8305 (1.0411)
===> Calculating KNN centroids.
Test: [0/157], Time 0.084 (0.084), Prec@1 42.188 (42.188), Prec@5 90.625 (90.625)
11/20 03:39 EPOCH: 83 Val: Prec@1 53.310 Prec@5 93.560
11/20 03:39 many acc 52.80, med acc 55.35, few acc 0.00
Best Prec@1: 60.340

Epoch: [84/200][0/194], Time 0.090 (0.090), Loss 1.0362 (1.0362)
11/20 03:39 EPOCH: 84 Train: Time 0.085 (0.088), Loss 1.3074 (1.1388)
===> Calculating KNN centroids.
Test: [0/157], Time 0.072 (0.072), Prec@1 40.625 (40.625), Prec@5 89.062 (89.062)
11/20 03:39 EPOCH: 84 Val: Prec@1 58.260 Prec@5 94.460
11/20 03:39 many acc 55.88, med acc 67.80, few acc 0.00
Best Prec@1: 60.340

Epoch: [85/200][0/194], Time 0.057 (0.057), Loss 1.1991 (1.1991)
11/20 03:40 EPOCH: 85 Train: Time 0.084 (0.088), Loss 1.7431 (1.0399)
===> Calculating KNN centroids.
Test: [0/157], Time 0.081 (0.081), Prec@1 67.188 (67.188), Prec@5 87.500 (87.500)
11/20 03:40 EPOCH: 85 Val: Prec@1 59.710 Prec@5 95.270
11/20 03:40 many acc 55.04, med acc 78.40, few acc 0.00
Best Prec@1: 60.340

Epoch: [86/200][0/194], Time 0.112 (0.112), Loss 1.4284 (1.4284)
11/20 03:40 EPOCH: 86 Train: Time 0.084 (0.088), Loss 1.3861 (1.0379)
===> Calculating KNN centroids.
Test: [0/157], Time 0.065 (0.065), Prec@1 57.812 (57.812), Prec@5 90.625 (90.625)
11/20 03:40 EPOCH: 86 Val: Prec@1 59.250 Prec@5 94.570
11/20 03:40 many acc 55.33, med acc 74.95, few acc 0.00
Best Prec@1: 60.340

Epoch: [87/200][0/194], Time 0.090 (0.090), Loss 0.7488 (0.7488)
11/20 03:41 EPOCH: 87 Train: Time 0.084 (0.088), Loss 1.1806 (1.0203)
===> Calculating KNN centroids.
Test: [0/157], Time 0.082 (0.082), Prec@1 70.312 (70.312), Prec@5 89.062 (89.062)
11/20 03:41 EPOCH: 87 Val: Prec@1 56.720 Prec@5 93.830
11/20 03:41 many acc 54.44, med acc 65.85, few acc 0.00
Best Prec@1: 60.340

Epoch: [88/200][0/194], Time 0.111 (0.111), Loss 1.2176 (1.2176)
11/20 03:41 EPOCH: 88 Train: Time 0.084 (0.088), Loss 1.1652 (1.0372)
===> Calculating KNN centroids.
Test: [0/157], Time 0.073 (0.073), Prec@1 51.562 (51.562), Prec@5 90.625 (90.625)
11/20 03:41 EPOCH: 88 Val: Prec@1 61.760 Prec@5 95.890
11/20 03:41 many acc 56.71, med acc 81.95, few acc 0.00
Best Prec@1: 61.760

Epoch: [89/200][0/194], Time 0.098 (0.098), Loss 0.6945 (0.6945)
11/20 03:41 EPOCH: 89 Train: Time 0.084 (0.088), Loss 1.3915 (1.0005)
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 51.562 (51.562), Prec@5 87.500 (87.500)
11/20 03:42 EPOCH: 89 Val: Prec@1 59.630 Prec@5 95.100
11/20 03:42 many acc 54.65, med acc 79.55, few acc 0.00
Best Prec@1: 61.760

Epoch: [90/200][0/194], Time 0.083 (0.083), Loss 0.5809 (0.5809)
11/20 03:42 EPOCH: 90 Train: Time 0.084 (0.088), Loss 0.7116 (0.9950)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_89.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_89.png
11/20 03:42 Loss:28.276, Acc:0.10, NC1:29.880,
Wnorm:[1.459,1.725,1.322,1.064,1.246,1.234,1.410,1.455,1.698,1.637]
Hnorm:[2.748,3.888,2.120,1.819,2.574,2.857,5.399,4.082,4.905,4.835]
Wcos:[-0.089,-0.124,-0.031,-0.034,-0.066,-0.036,-0.075,-0.097,-0.180,-0.216]
WHcos:[0.909,0.918,0.948,0.793,0.923,0.896,0.965,0.975,0.949,0.950]
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 70.312 (70.312), Prec@5 85.938 (85.938)
11/20 03:42 EPOCH: 90 Val: Prec@1 60.460 Prec@5 94.770
11/20 03:42 many acc 58.80, med acc 67.10, few acc 0.00
Best Prec@1: 61.760

Epoch: [91/200][0/194], Time 0.113 (0.113), Loss 0.6161 (0.6161)
11/20 03:43 EPOCH: 91 Train: Time 0.084 (0.088), Loss 1.3922 (1.0134)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 65.625 (65.625), Prec@5 92.188 (92.188)
11/20 03:43 EPOCH: 91 Val: Prec@1 59.680 Prec@5 95.070
11/20 03:43 many acc 55.54, med acc 76.25, few acc 0.00
Best Prec@1: 61.760

Epoch: [92/200][0/194], Time 0.112 (0.112), Loss 0.8148 (0.8148)
11/20 03:43 EPOCH: 92 Train: Time 0.084 (0.088), Loss 0.8249 (1.0394)
===> Calculating KNN centroids.
Test: [0/157], Time 0.073 (0.073), Prec@1 56.250 (56.250), Prec@5 90.625 (90.625)
11/20 03:43 EPOCH: 92 Val: Prec@1 57.370 Prec@5 93.750
11/20 03:43 many acc 54.14, med acc 70.30, few acc 0.00
Best Prec@1: 61.760

Epoch: [93/200][0/194], Time 0.118 (0.118), Loss 0.9726 (0.9726)
11/20 03:43 EPOCH: 93 Train: Time 0.084 (0.088), Loss 0.8988 (0.9959)
===> Calculating KNN centroids.
Test: [0/157], Time 0.087 (0.087), Prec@1 76.562 (76.562), Prec@5 92.188 (92.188)
11/20 03:44 EPOCH: 93 Val: Prec@1 60.520 Prec@5 95.650
11/20 03:44 many acc 56.45, med acc 76.80, few acc 0.00
Best Prec@1: 61.760

Epoch: [94/200][0/194], Time 0.127 (0.127), Loss 0.7578 (0.7578)
11/20 03:44 EPOCH: 94 Train: Time 0.084 (0.088), Loss 0.7255 (0.9380)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 64.062 (64.062), Prec@5 89.062 (89.062)
11/20 03:44 EPOCH: 94 Val: Prec@1 58.550 Prec@5 94.040
11/20 03:44 many acc 57.11, med acc 64.30, few acc 0.00
Best Prec@1: 61.760

Epoch: [95/200][0/194], Time 0.110 (0.110), Loss 0.5977 (0.5977)
11/20 03:44 EPOCH: 95 Train: Time 0.085 (0.088), Loss 0.6358 (1.0648)
===> Calculating KNN centroids.
Test: [0/157], Time 0.083 (0.083), Prec@1 54.688 (54.688), Prec@5 89.062 (89.062)
11/20 03:44 EPOCH: 95 Val: Prec@1 58.870 Prec@5 94.760
11/20 03:44 many acc 54.12, med acc 77.85, few acc 0.00
Best Prec@1: 61.760

Epoch: [96/200][0/194], Time 0.105 (0.105), Loss 0.8008 (0.8008)
11/20 03:45 EPOCH: 96 Train: Time 0.084 (0.088), Loss 1.3449 (0.9759)
===> Calculating KNN centroids.
Test: [0/157], Time 0.072 (0.072), Prec@1 53.125 (53.125), Prec@5 92.188 (92.188)
11/20 03:45 EPOCH: 96 Val: Prec@1 61.440 Prec@5 95.660
11/20 03:45 many acc 57.27, med acc 78.10, few acc 0.00
Best Prec@1: 61.760

Epoch: [97/200][0/194], Time 0.115 (0.115), Loss 1.0824 (1.0824)
11/20 03:45 EPOCH: 97 Train: Time 0.084 (0.088), Loss 1.0199 (0.9933)
===> Calculating KNN centroids.
Test: [0/157], Time 0.073 (0.073), Prec@1 56.250 (56.250), Prec@5 92.188 (92.188)
11/20 03:45 EPOCH: 97 Val: Prec@1 59.760 Prec@5 95.680
11/20 03:45 many acc 54.85, med acc 79.40, few acc 0.00
Best Prec@1: 61.760

Epoch: [98/200][0/194], Time 0.122 (0.122), Loss 0.7643 (0.7643)
11/20 03:46 EPOCH: 98 Train: Time 0.084 (0.088), Loss 1.4611 (0.9428)
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 46.875 (46.875), Prec@5 93.750 (93.750)
11/20 03:46 EPOCH: 98 Val: Prec@1 57.040 Prec@5 93.280
11/20 03:46 many acc 52.96, med acc 73.35, few acc 0.00
Best Prec@1: 61.760

Epoch: [99/200][0/194], Time 0.094 (0.094), Loss 0.4472 (0.4472)
11/20 03:46 EPOCH: 99 Train: Time 0.084 (0.088), Loss 0.9210 (0.9541)
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 62.500 (62.500), Prec@5 89.062 (89.062)
11/20 03:46 EPOCH: 99 Val: Prec@1 59.330 Prec@5 95.090
11/20 03:46 many acc 54.57, med acc 78.35, few acc 0.00
Best Prec@1: 61.760

Epoch: [100/200][0/194], Time 0.115 (0.115), Loss 0.6056 (0.6056)
11/20 03:46 EPOCH: 100 Train: Time 0.085 (0.088), Loss 2.1516 (0.9364)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_99.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_99.png
11/20 03:47 Loss:29.895, Acc:0.14, NC1:20.733,
Wnorm:[1.429,1.763,1.346,1.066,1.280,1.296,1.462,1.460,1.686,1.671]
Hnorm:[3.063,3.974,2.246,2.931,2.688,4.249,4.543,5.287,6.203,5.498]
Wcos:[-0.084,-0.124,-0.035,-0.037,-0.065,-0.039,-0.085,-0.095,-0.175,-0.216]
WHcos:[0.800,0.938,0.959,0.867,0.879,0.963,0.989,0.980,0.976,0.977]
11/20 03:47 -- Has saved the NC analysis result to ./output/cifar10_resnet50/0.01/name_2023-11-20/analysis99.pkl
===> Calculating KNN centroids.
Test: [0/157], Time 0.076 (0.076), Prec@1 43.750 (43.750), Prec@5 90.625 (90.625)
11/20 03:47 EPOCH: 100 Val: Prec@1 60.270 Prec@5 95.020
11/20 03:47 many acc 57.56, med acc 71.10, few acc 0.00
Best Prec@1: 61.760

Epoch: [101/200][0/194], Time 0.107 (0.107), Loss 1.0574 (1.0574)
11/20 03:47 EPOCH: 101 Train: Time 0.084 (0.088), Loss 0.7560 (0.9034)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 59.375 (59.375), Prec@5 89.062 (89.062)
11/20 03:47 EPOCH: 101 Val: Prec@1 59.020 Prec@5 94.970
11/20 03:47 many acc 54.77, med acc 76.00, few acc 0.00
Best Prec@1: 61.760

Epoch: [102/200][0/194], Time 0.100 (0.100), Loss 0.7736 (0.7736)
11/20 03:48 EPOCH: 102 Train: Time 0.084 (0.088), Loss 1.1008 (0.9404)
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 75.000 (75.000), Prec@5 92.188 (92.188)
11/20 03:48 EPOCH: 102 Val: Prec@1 58.030 Prec@5 94.700
11/20 03:48 many acc 55.19, med acc 69.40, few acc 0.00
Best Prec@1: 61.760

Epoch: [103/200][0/194], Time 0.080 (0.080), Loss 1.1382 (1.1382)
11/20 03:48 EPOCH: 103 Train: Time 0.084 (0.088), Loss 1.1436 (0.9627)
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 56.250 (56.250), Prec@5 90.625 (90.625)
11/20 03:48 EPOCH: 103 Val: Prec@1 62.030 Prec@5 95.260
11/20 03:48 many acc 59.42, med acc 72.45, few acc 0.00
Best Prec@1: 62.030

Epoch: [104/200][0/194], Time 0.111 (0.111), Loss 0.7952 (0.7952)
11/20 03:48 EPOCH: 104 Train: Time 0.084 (0.088), Loss 0.8403 (1.0178)
===> Calculating KNN centroids.
Test: [0/157], Time 0.071 (0.071), Prec@1 50.000 (50.000), Prec@5 92.188 (92.188)
11/20 03:49 EPOCH: 104 Val: Prec@1 52.450 Prec@5 93.920
11/20 03:49 many acc 48.00, med acc 70.25, few acc 0.00
Best Prec@1: 62.030

Epoch: [105/200][0/194], Time 0.105 (0.105), Loss 1.3973 (1.3973)
11/20 03:49 EPOCH: 105 Train: Time 0.084 (0.088), Loss 1.8197 (1.0044)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 57.812 (57.812), Prec@5 90.625 (90.625)
11/20 03:49 EPOCH: 105 Val: Prec@1 59.210 Prec@5 94.910
11/20 03:49 many acc 57.31, med acc 66.80, few acc 0.00
Best Prec@1: 62.030

Epoch: [106/200][0/194], Time 0.110 (0.110), Loss 0.8318 (0.8318)
11/20 03:49 EPOCH: 106 Train: Time 0.085 (0.088), Loss 0.7797 (0.9170)
===> Calculating KNN centroids.
Test: [0/157], Time 0.084 (0.084), Prec@1 56.250 (56.250), Prec@5 90.625 (90.625)
11/20 03:49 EPOCH: 106 Val: Prec@1 62.240 Prec@5 96.220
11/20 03:49 many acc 57.35, med acc 81.80, few acc 0.00
Best Prec@1: 62.240

Epoch: [107/200][0/194], Time 0.113 (0.113), Loss 0.8768 (0.8768)
11/20 03:50 EPOCH: 107 Train: Time 0.084 (0.088), Loss 0.4583 (0.8812)
===> Calculating KNN centroids.
Test: [0/157], Time 0.084 (0.084), Prec@1 68.750 (68.750), Prec@5 92.188 (92.188)
11/20 03:50 EPOCH: 107 Val: Prec@1 59.450 Prec@5 95.350
11/20 03:50 many acc 58.09, med acc 64.90, few acc 0.00
Best Prec@1: 62.240

Epoch: [108/200][0/194], Time 0.096 (0.096), Loss 1.1933 (1.1933)
11/20 03:50 EPOCH: 108 Train: Time 0.085 (0.088), Loss 0.8158 (0.9299)
===> Calculating KNN centroids.
Test: [0/157], Time 0.087 (0.087), Prec@1 67.188 (67.188), Prec@5 87.500 (87.500)
11/20 03:50 EPOCH: 108 Val: Prec@1 58.460 Prec@5 94.600
11/20 03:50 many acc 56.96, med acc 64.45, few acc 0.00
Best Prec@1: 62.240

Epoch: [109/200][0/194], Time 0.087 (0.087), Loss 0.6562 (0.6562)
11/20 03:51 EPOCH: 109 Train: Time 0.084 (0.088), Loss 0.9183 (0.9193)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 57.812 (57.812), Prec@5 90.625 (90.625)
11/20 03:51 EPOCH: 109 Val: Prec@1 60.770 Prec@5 95.560
11/20 03:51 many acc 56.24, med acc 78.90, few acc 0.00
Best Prec@1: 62.240

Epoch: [110/200][0/194], Time 0.111 (0.111), Loss 0.9352 (0.9352)
11/20 03:51 EPOCH: 110 Train: Time 0.085 (0.088), Loss 0.9044 (0.8725)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_109.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_109.png
11/20 03:51 Loss:32.622, Acc:0.14, NC1:19.934,
Wnorm:[1.438,1.729,1.360,1.076,1.305,1.299,1.437,1.491,1.671,1.664]
Hnorm:[2.696,3.796,2.517,2.560,3.239,3.246,4.628,5.703,8.179,6.450]
Wcos:[-0.085,-0.120,-0.041,-0.038,-0.067,-0.045,-0.083,-0.105,-0.171,-0.210]
WHcos:[0.798,0.952,0.919,0.787,0.906,0.903,0.981,0.986,0.964,0.961]
===> Calculating KNN centroids.
Test: [0/157], Time 0.083 (0.083), Prec@1 50.000 (50.000), Prec@5 92.188 (92.188)
11/20 03:51 EPOCH: 110 Val: Prec@1 61.210 Prec@5 95.580
11/20 03:51 many acc 58.14, med acc 73.50, few acc 0.00
Best Prec@1: 62.240

Epoch: [111/200][0/194], Time 0.101 (0.101), Loss 0.6480 (0.6480)
11/20 03:52 EPOCH: 111 Train: Time 0.085 (0.088), Loss 0.9640 (0.8940)
===> Calculating KNN centroids.
Test: [0/157], Time 0.081 (0.081), Prec@1 35.938 (35.938), Prec@5 95.312 (95.312)
11/20 03:52 EPOCH: 111 Val: Prec@1 60.370 Prec@5 96.290
11/20 03:52 many acc 55.35, med acc 80.45, few acc 0.00
Best Prec@1: 62.240

Epoch: [112/200][0/194], Time 0.118 (0.118), Loss 1.0802 (1.0802)
11/20 03:52 EPOCH: 112 Train: Time 0.085 (0.088), Loss 0.5999 (0.8314)
===> Calculating KNN centroids.
Test: [0/157], Time 0.080 (0.080), Prec@1 71.875 (71.875), Prec@5 93.750 (93.750)
11/20 03:52 EPOCH: 112 Val: Prec@1 64.350 Prec@5 96.290
11/20 03:52 many acc 60.16, med acc 81.10, few acc 0.00
Best Prec@1: 64.350

Epoch: [113/200][0/194], Time 0.089 (0.089), Loss 0.8325 (0.8325)
11/20 03:53 EPOCH: 113 Train: Time 0.085 (0.088), Loss 0.9568 (0.8804)
===> Calculating KNN centroids.
Test: [0/157], Time 0.086 (0.086), Prec@1 42.188 (42.188), Prec@5 85.938 (85.938)
11/20 03:53 EPOCH: 113 Val: Prec@1 49.820 Prec@5 90.280
11/20 03:53 many acc 41.67, med acc 82.40, few acc 0.00
Best Prec@1: 64.350

Epoch: [114/200][0/194], Time 0.114 (0.114), Loss 0.6961 (0.6961)
11/20 03:53 EPOCH: 114 Train: Time 0.084 (0.088), Loss 0.4702 (0.9517)
===> Calculating KNN centroids.
Test: [0/157], Time 0.079 (0.079), Prec@1 71.875 (71.875), Prec@5 90.625 (90.625)
11/20 03:53 EPOCH: 114 Val: Prec@1 62.890 Prec@5 96.300
11/20 03:53 many acc 58.42, med acc 80.75, few acc 0.00
Best Prec@1: 64.350

Epoch: [115/200][0/194], Time 0.094 (0.094), Loss 0.8354 (0.8354)
11/20 03:53 EPOCH: 115 Train: Time 0.084 (0.088), Loss 0.9630 (0.9100)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 57.812 (57.812), Prec@5 92.188 (92.188)
11/20 03:54 EPOCH: 115 Val: Prec@1 62.440 Prec@5 96.040
11/20 03:54 many acc 58.06, med acc 79.95, few acc 0.00
Best Prec@1: 64.350

Epoch: [116/200][0/194], Time 0.112 (0.112), Loss 0.4567 (0.4567)
11/20 03:54 EPOCH: 116 Train: Time 0.084 (0.088), Loss 0.5353 (0.8083)
===> Calculating KNN centroids.
Test: [0/157], Time 0.078 (0.078), Prec@1 62.500 (62.500), Prec@5 90.625 (90.625)
11/20 03:54 EPOCH: 116 Val: Prec@1 52.690 Prec@5 92.280
11/20 03:54 many acc 45.85, med acc 80.05, few acc 0.00
Best Prec@1: 64.350

Epoch: [117/200][0/194], Time 0.115 (0.115), Loss 0.9269 (0.9269)
11/20 03:54 EPOCH: 117 Train: Time 0.084 (0.088), Loss 1.3974 (0.8564)
===> Calculating KNN centroids.
Test: [0/157], Time 0.080 (0.080), Prec@1 71.875 (71.875), Prec@5 90.625 (90.625)
11/20 03:54 EPOCH: 117 Val: Prec@1 61.730 Prec@5 94.900
11/20 03:54 many acc 56.93, med acc 80.95, few acc 0.00
Best Prec@1: 64.350

Epoch: [118/200][0/194], Time 0.096 (0.096), Loss 0.8015 (0.8015)
11/20 03:55 EPOCH: 118 Train: Time 0.084 (0.088), Loss 0.6825 (0.8028)
===> Calculating KNN centroids.
Test: [0/157], Time 0.082 (0.082), Prec@1 64.062 (64.062), Prec@5 89.062 (89.062)
11/20 03:55 EPOCH: 118 Val: Prec@1 63.400 Prec@5 96.270
11/20 03:55 many acc 61.08, med acc 72.70, few acc 0.00
Best Prec@1: 64.350

Epoch: [119/200][0/194], Time 0.103 (0.103), Loss 0.8109 (0.8109)
11/20 03:55 EPOCH: 119 Train: Time 0.084 (0.088), Loss 0.6054 (0.8044)
===> Calculating KNN centroids.
Test: [0/157], Time 0.062 (0.062), Prec@1 53.125 (53.125), Prec@5 90.625 (90.625)
11/20 03:55 EPOCH: 119 Val: Prec@1 61.890 Prec@5 95.860
11/20 03:55 many acc 56.89, med acc 81.90, few acc 0.00
Best Prec@1: 64.350

Epoch: [120/200][0/194], Time 0.107 (0.107), Loss 0.9356 (0.9356)
11/20 03:56 EPOCH: 120 Train: Time 0.084 (0.088), Loss 0.8984 (0.7982)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_119.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_119.png
11/20 03:56 Loss:24.251, Acc:0.24, NC1:12.634,
Wnorm:[1.461,1.735,1.378,1.117,1.332,1.329,1.435,1.500,1.683,1.594]
Hnorm:[3.139,4.269,2.924,2.929,3.680,3.878,4.831,5.450,8.692,7.584]
Wcos:[-0.090,-0.122,-0.049,-0.047,-0.073,-0.054,-0.090,-0.108,-0.166,-0.194]
WHcos:[0.905,0.967,0.924,0.822,0.930,0.940,0.965,0.982,0.968,0.964]
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 67.188 (67.188), Prec@5 89.062 (89.062)
11/20 03:56 EPOCH: 120 Val: Prec@1 67.050 Prec@5 96.480
11/20 03:56 many acc 64.14, med acc 78.70, few acc 0.00
Best Prec@1: 67.050

Epoch: [121/200][0/194], Time 0.115 (0.115), Loss 0.4314 (0.4314)
11/20 03:56 EPOCH: 121 Train: Time 0.084 (0.088), Loss 0.4995 (0.8304)
===> Calculating KNN centroids.
Test: [0/157], Time 0.087 (0.087), Prec@1 65.625 (65.625), Prec@5 93.750 (93.750)
11/20 03:56 EPOCH: 121 Val: Prec@1 65.850 Prec@5 96.230
11/20 03:56 many acc 61.89, med acc 81.70, few acc 0.00
Best Prec@1: 67.050

Epoch: [122/200][0/194], Time 0.097 (0.097), Loss 0.6491 (0.6491)
11/20 03:57 EPOCH: 122 Train: Time 0.085 (0.088), Loss 0.6419 (0.7928)
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 67.188 (67.188), Prec@5 92.188 (92.188)
11/20 03:57 EPOCH: 122 Val: Prec@1 65.120 Prec@5 96.390
11/20 03:57 many acc 60.99, med acc 81.65, few acc 0.00
Best Prec@1: 67.050

Epoch: [123/200][0/194], Time 0.107 (0.107), Loss 0.8964 (0.8964)
11/20 03:57 EPOCH: 123 Train: Time 0.085 (0.088), Loss 1.2687 (0.7629)
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 60.938 (60.938), Prec@5 89.062 (89.062)
11/20 03:57 EPOCH: 123 Val: Prec@1 64.530 Prec@5 95.630
11/20 03:57 many acc 61.99, med acc 74.70, few acc 0.00
Best Prec@1: 67.050

Epoch: [124/200][0/194], Time 0.120 (0.120), Loss 0.7406 (0.7406)
11/20 03:58 EPOCH: 124 Train: Time 0.085 (0.088), Loss 0.8696 (0.7862)
===> Calculating KNN centroids.
Test: [0/157], Time 0.083 (0.083), Prec@1 65.625 (65.625), Prec@5 92.188 (92.188)
11/20 03:58 EPOCH: 124 Val: Prec@1 61.090 Prec@5 94.680
11/20 03:58 many acc 59.74, med acc 66.50, few acc 0.00
Best Prec@1: 67.050

Epoch: [125/200][0/194], Time 0.112 (0.112), Loss 0.7693 (0.7693)
11/20 03:58 EPOCH: 125 Train: Time 0.085 (0.088), Loss 0.5371 (0.7397)
===> Calculating KNN centroids.
Test: [0/157], Time 0.073 (0.073), Prec@1 73.438 (73.438), Prec@5 90.625 (90.625)
11/20 03:58 EPOCH: 125 Val: Prec@1 68.000 Prec@5 97.020
11/20 03:58 many acc 65.56, med acc 77.75, few acc 0.00
Best Prec@1: 68.000

Epoch: [126/200][0/194], Time 0.057 (0.057), Loss 0.8888 (0.8888)
11/20 03:58 EPOCH: 126 Train: Time 0.084 (0.088), Loss 1.2482 (0.7095)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 68.750 (68.750), Prec@5 90.625 (90.625)
11/20 03:59 EPOCH: 126 Val: Prec@1 64.310 Prec@5 96.350
11/20 03:59 many acc 62.11, med acc 73.10, few acc 0.00
Best Prec@1: 68.000

Epoch: [127/200][0/194], Time 0.115 (0.115), Loss 0.8955 (0.8955)
11/20 03:59 EPOCH: 127 Train: Time 0.084 (0.088), Loss 0.8775 (0.6720)
===> Calculating KNN centroids.
Test: [0/157], Time 0.083 (0.083), Prec@1 59.375 (59.375), Prec@5 89.062 (89.062)
11/20 03:59 EPOCH: 127 Val: Prec@1 56.520 Prec@5 92.610
11/20 03:59 many acc 53.42, med acc 68.90, few acc 0.00
Best Prec@1: 68.000

Epoch: [128/200][0/194], Time 0.117 (0.117), Loss 1.2983 (1.2983)
11/20 03:59 EPOCH: 128 Train: Time 0.084 (0.088), Loss 1.0731 (0.7504)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 64.062 (64.062), Prec@5 89.062 (89.062)
11/20 03:59 EPOCH: 128 Val: Prec@1 65.470 Prec@5 96.050
11/20 03:59 many acc 61.49, med acc 81.40, few acc 0.00
Best Prec@1: 68.000

Epoch: [129/200][0/194], Time 0.099 (0.099), Loss 0.2579 (0.2579)
11/20 04:00 EPOCH: 129 Train: Time 0.084 (0.088), Loss 0.3683 (0.6841)
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 75.000 (75.000), Prec@5 90.625 (90.625)
11/20 04:00 EPOCH: 129 Val: Prec@1 65.090 Prec@5 96.050
11/20 04:00 many acc 62.50, med acc 75.45, few acc 0.00
Best Prec@1: 68.000

Epoch: [130/200][0/194], Time 0.109 (0.109), Loss 0.7725 (0.7725)
11/20 04:00 EPOCH: 130 Train: Time 0.084 (0.088), Loss 0.7225 (0.6834)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_129.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_129.png
11/20 04:00 Loss:21.782, Acc:0.29, NC1:10.909,
Wnorm:[1.512,1.738,1.383,1.129,1.369,1.355,1.478,1.524,1.654,1.605]
Hnorm:[2.693,3.922,2.811,2.665,3.284,3.960,5.033,4.564,8.455,6.648]
Wcos:[-0.088,-0.118,-0.052,-0.050,-0.076,-0.058,-0.094,-0.113,-0.162,-0.190]
WHcos:[0.895,0.960,0.947,0.807,0.965,0.946,0.988,0.965,0.979,0.983]
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 68.750 (68.750), Prec@5 93.750 (93.750)
11/20 04:01 EPOCH: 130 Val: Prec@1 63.770 Prec@5 95.860
11/20 04:01 many acc 62.66, med acc 68.20, few acc 0.00
Best Prec@1: 68.000

Epoch: [131/200][0/194], Time 0.110 (0.110), Loss 0.9616 (0.9616)
11/20 04:01 EPOCH: 131 Train: Time 0.085 (0.088), Loss 0.6965 (0.8839)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 62.500 (62.500), Prec@5 96.875 (96.875)
11/20 04:01 EPOCH: 131 Val: Prec@1 65.880 Prec@5 96.530
11/20 04:01 many acc 61.49, med acc 83.45, few acc 0.00
Best Prec@1: 68.000

Epoch: [132/200][0/194], Time 0.121 (0.121), Loss 0.4835 (0.4835)
11/20 04:01 EPOCH: 132 Train: Time 0.085 (0.088), Loss 0.7073 (0.6871)
===> Calculating KNN centroids.
Test: [0/157], Time 0.076 (0.076), Prec@1 73.438 (73.438), Prec@5 96.875 (96.875)
11/20 04:01 EPOCH: 132 Val: Prec@1 68.640 Prec@5 97.200
11/20 04:01 many acc 65.31, med acc 81.95, few acc 0.00
Best Prec@1: 68.640

Epoch: [133/200][0/194], Time 0.098 (0.098), Loss 0.8344 (0.8344)
11/20 04:02 EPOCH: 133 Train: Time 0.084 (0.088), Loss 0.7851 (0.6536)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 78.125 (78.125), Prec@5 95.312 (95.312)
11/20 04:02 EPOCH: 133 Val: Prec@1 65.230 Prec@5 96.140
11/20 04:02 many acc 61.59, med acc 79.80, few acc 0.00
Best Prec@1: 68.640

Epoch: [134/200][0/194], Time 0.121 (0.121), Loss 0.4875 (0.4875)
11/20 04:02 EPOCH: 134 Train: Time 0.084 (0.088), Loss 0.6806 (0.6093)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 68.750 (68.750), Prec@5 92.188 (92.188)
11/20 04:02 EPOCH: 134 Val: Prec@1 66.950 Prec@5 96.790
11/20 04:02 many acc 63.08, med acc 82.45, few acc 0.00
Best Prec@1: 68.640

Epoch: [135/200][0/194], Time 0.120 (0.120), Loss 0.6442 (0.6442)
11/20 04:03 EPOCH: 135 Train: Time 0.084 (0.088), Loss 0.2845 (0.5978)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 76.562 (76.562), Prec@5 95.312 (95.312)
11/20 04:03 EPOCH: 135 Val: Prec@1 68.950 Prec@5 97.490
11/20 04:03 many acc 67.59, med acc 74.40, few acc 0.00
Best Prec@1: 68.950

Epoch: [136/200][0/194], Time 0.109 (0.109), Loss 0.5044 (0.5044)
11/20 04:03 EPOCH: 136 Train: Time 0.084 (0.088), Loss 0.4797 (0.6301)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 59.375 (59.375), Prec@5 95.312 (95.312)
11/20 04:03 EPOCH: 136 Val: Prec@1 67.040 Prec@5 96.680
11/20 04:03 many acc 65.12, med acc 74.70, few acc 0.00
Best Prec@1: 68.950

Epoch: [137/200][0/194], Time 0.091 (0.091), Loss 0.5625 (0.5625)
11/20 04:03 EPOCH: 137 Train: Time 0.084 (0.088), Loss 0.3272 (0.5970)
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 67.188 (67.188), Prec@5 93.750 (93.750)
11/20 04:04 EPOCH: 137 Val: Prec@1 69.340 Prec@5 97.260
11/20 04:04 many acc 65.33, med acc 85.40, few acc 0.00
Best Prec@1: 69.340

Epoch: [138/200][0/194], Time 0.117 (0.117), Loss 0.8220 (0.8220)
11/20 04:04 EPOCH: 138 Train: Time 0.085 (0.088), Loss 0.5236 (0.5716)
===> Calculating KNN centroids.
Test: [0/157], Time 0.086 (0.086), Prec@1 76.562 (76.562), Prec@5 92.188 (92.188)
11/20 04:04 EPOCH: 138 Val: Prec@1 65.230 Prec@5 96.420
11/20 04:04 many acc 62.81, med acc 74.90, few acc 0.00
Best Prec@1: 69.340

Epoch: [139/200][0/194], Time 0.119 (0.119), Loss 0.7056 (0.7056)
11/20 04:04 EPOCH: 139 Train: Time 0.085 (0.088), Loss 0.5849 (0.6077)
===> Calculating KNN centroids.
Test: [0/157], Time 0.071 (0.071), Prec@1 73.438 (73.438), Prec@5 92.188 (92.188)
11/20 04:04 EPOCH: 139 Val: Prec@1 68.530 Prec@5 97.110
11/20 04:04 many acc 65.49, med acc 80.70, few acc 0.00
Best Prec@1: 69.340

Epoch: [140/200][0/194], Time 0.105 (0.105), Loss 0.2105 (0.2105)
11/20 04:05 EPOCH: 140 Train: Time 0.085 (0.088), Loss 0.3157 (0.5561)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_139.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_139.png
11/20 04:05 Loss:22.245, Acc:0.34, NC1:6.696,
Wnorm:[1.532,1.736,1.419,1.172,1.409,1.418,1.498,1.542,1.629,1.567]
Hnorm:[3.720,4.598,3.072,2.822,3.740,3.840,7.932,7.012,9.507,10.730]
Wcos:[-0.088,-0.114,-0.059,-0.059,-0.081,-0.068,-0.097,-0.119,-0.156,-0.180]
WHcos:[0.854,0.925,0.876,0.877,0.921,0.886,0.953,0.985,0.965,0.972]
===> Calculating KNN centroids.
Test: [0/157], Time 0.086 (0.086), Prec@1 75.000 (75.000), Prec@5 90.625 (90.625)
11/20 04:05 EPOCH: 140 Val: Prec@1 67.230 Prec@5 96.240
11/20 04:05 many acc 63.78, med acc 81.05, few acc 0.00
Best Prec@1: 69.340

Epoch: [141/200][0/194], Time 0.083 (0.083), Loss 0.5172 (0.5172)
11/20 04:05 EPOCH: 141 Train: Time 0.085 (0.088), Loss 0.6514 (0.5244)
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 70.312 (70.312), Prec@5 92.188 (92.188)
11/20 04:06 EPOCH: 141 Val: Prec@1 69.440 Prec@5 96.710
11/20 04:06 many acc 66.84, med acc 79.85, few acc 0.00
Best Prec@1: 69.440

Epoch: [142/200][0/194], Time 0.111 (0.111), Loss 0.6969 (0.6969)
11/20 04:06 EPOCH: 142 Train: Time 0.085 (0.088), Loss 0.8792 (0.5325)
===> Calculating KNN centroids.
Test: [0/157], Time 0.089 (0.089), Prec@1 73.438 (73.438), Prec@5 93.750 (93.750)
11/20 04:06 EPOCH: 142 Val: Prec@1 71.060 Prec@5 97.390
11/20 04:06 many acc 69.03, med acc 79.20, few acc 0.00
Best Prec@1: 71.060

Epoch: [143/200][0/194], Time 0.081 (0.081), Loss 0.4015 (0.4015)
11/20 04:06 EPOCH: 143 Train: Time 0.085 (0.088), Loss 0.8275 (0.4859)
===> Calculating KNN centroids.
Test: [0/157], Time 0.080 (0.080), Prec@1 73.438 (73.438), Prec@5 96.875 (96.875)
11/20 04:06 EPOCH: 143 Val: Prec@1 69.730 Prec@5 97.170
11/20 04:06 many acc 67.10, med acc 80.25, few acc 0.00
Best Prec@1: 71.060

Epoch: [144/200][0/194], Time 0.115 (0.115), Loss 0.5481 (0.5481)
11/20 04:07 EPOCH: 144 Train: Time 0.084 (0.088), Loss 1.1783 (0.5172)
===> Calculating KNN centroids.
Test: [0/157], Time 0.081 (0.081), Prec@1 65.625 (65.625), Prec@5 92.188 (92.188)
11/20 04:07 EPOCH: 144 Val: Prec@1 65.930 Prec@5 96.260
11/20 04:07 many acc 60.94, med acc 85.90, few acc 0.00
Best Prec@1: 71.060

Epoch: [145/200][0/194], Time 0.105 (0.105), Loss 0.5155 (0.5155)
11/20 04:07 EPOCH: 145 Train: Time 0.084 (0.088), Loss 0.5095 (0.4981)
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 73.438 (73.438), Prec@5 93.750 (93.750)
11/20 04:07 EPOCH: 145 Val: Prec@1 71.740 Prec@5 97.040
11/20 04:07 many acc 69.86, med acc 79.25, few acc 0.00
Best Prec@1: 71.740

Epoch: [146/200][0/194], Time 0.058 (0.058), Loss 0.3052 (0.3052)
11/20 04:08 EPOCH: 146 Train: Time 0.084 (0.088), Loss 0.3607 (0.5076)
===> Calculating KNN centroids.
Test: [0/157], Time 0.071 (0.071), Prec@1 78.125 (78.125), Prec@5 93.750 (93.750)
11/20 04:08 EPOCH: 146 Val: Prec@1 70.240 Prec@5 97.000
11/20 04:08 many acc 67.80, med acc 80.00, few acc 0.00
Best Prec@1: 71.740

Epoch: [147/200][0/194], Time 0.107 (0.107), Loss 0.2745 (0.2745)
11/20 04:08 EPOCH: 147 Train: Time 0.084 (0.088), Loss 0.3194 (0.4916)
===> Calculating KNN centroids.
Test: [0/157], Time 0.084 (0.084), Prec@1 75.000 (75.000), Prec@5 98.438 (98.438)
11/20 04:08 EPOCH: 147 Val: Prec@1 71.150 Prec@5 97.280
11/20 04:08 many acc 68.33, med acc 82.45, few acc 0.00
Best Prec@1: 71.740

Epoch: [148/200][0/194], Time 0.106 (0.106), Loss 0.5454 (0.5454)
11/20 04:08 EPOCH: 148 Train: Time 0.085 (0.088), Loss 0.3093 (0.4791)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 70.312 (70.312), Prec@5 95.312 (95.312)
11/20 04:09 EPOCH: 148 Val: Prec@1 69.640 Prec@5 97.100
11/20 04:09 many acc 66.79, med acc 81.05, few acc 0.00
Best Prec@1: 71.740

Epoch: [149/200][0/194], Time 0.112 (0.112), Loss 0.5386 (0.5386)
11/20 04:09 EPOCH: 149 Train: Time 0.084 (0.088), Loss 0.9410 (0.4881)
===> Calculating KNN centroids.
Test: [0/157], Time 0.072 (0.072), Prec@1 60.938 (60.938), Prec@5 92.188 (92.188)
11/20 04:09 EPOCH: 149 Val: Prec@1 65.380 Prec@5 95.780
11/20 04:09 many acc 62.10, med acc 78.50, few acc 0.00
Best Prec@1: 71.740

Epoch: [150/200][0/194], Time 0.105 (0.105), Loss 0.5680 (0.5680)
11/20 04:09 EPOCH: 150 Train: Time 0.084 (0.088), Loss 0.3349 (0.4955)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_149.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_149.png
11/20 04:10 Loss:16.496, Acc:0.46, NC1:4.336,
Wnorm:[1.553,1.726,1.459,1.203,1.458,1.438,1.519,1.529,1.594,1.528]
Hnorm:[3.546,4.168,3.813,3.266,4.774,4.807,6.367,7.879,10.186,13.103]
Wcos:[-0.089,-0.112,-0.066,-0.066,-0.086,-0.076,-0.102,-0.121,-0.150,-0.170]
WHcos:[0.902,0.957,0.886,0.870,0.948,0.934,0.979,0.982,0.978,0.958]
11/20 04:10 -- Has saved the NC analysis result to ./output/cifar10_resnet50/0.01/name_2023-11-20/analysis149.pkl
===> Calculating KNN centroids.
Test: [0/157], Time 0.079 (0.079), Prec@1 78.125 (78.125), Prec@5 95.312 (95.312)
11/20 04:10 EPOCH: 150 Val: Prec@1 71.170 Prec@5 97.740
11/20 04:10 many acc 68.23, med acc 82.95, few acc 0.00
Best Prec@1: 71.740

Epoch: [151/200][0/194], Time 0.090 (0.090), Loss 0.2839 (0.2839)
11/20 04:10 EPOCH: 151 Train: Time 0.084 (0.088), Loss 0.4732 (0.4027)
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 75.000 (75.000), Prec@5 95.312 (95.312)
11/20 04:10 EPOCH: 151 Val: Prec@1 71.750 Prec@5 97.730
11/20 04:10 many acc 70.59, med acc 76.40, few acc 0.00
Best Prec@1: 71.750

Epoch: [152/200][0/194], Time 0.109 (0.109), Loss 0.1825 (0.1825)
11/20 04:10 EPOCH: 152 Train: Time 0.084 (0.088), Loss 0.5350 (0.3911)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 70.312 (70.312), Prec@5 96.875 (96.875)
11/20 04:11 EPOCH: 152 Val: Prec@1 71.510 Prec@5 97.460
11/20 04:11 many acc 68.67, med acc 82.85, few acc 0.00
Best Prec@1: 71.750

Epoch: [153/200][0/194], Time 0.081 (0.081), Loss 0.2340 (0.2340)
11/20 04:11 EPOCH: 153 Train: Time 0.084 (0.088), Loss 0.3429 (0.3727)
===> Calculating KNN centroids.
Test: [0/157], Time 0.090 (0.090), Prec@1 76.562 (76.562), Prec@5 96.875 (96.875)
11/20 04:11 EPOCH: 153 Val: Prec@1 71.560 Prec@5 97.300
11/20 04:11 many acc 70.97, med acc 73.90, few acc 0.00
Best Prec@1: 71.750

Epoch: [154/200][0/194], Time 0.110 (0.110), Loss 0.3812 (0.3812)
11/20 04:11 EPOCH: 154 Train: Time 0.084 (0.088), Loss 0.4258 (0.3707)
===> Calculating KNN centroids.
Test: [0/157], Time 0.076 (0.076), Prec@1 78.125 (78.125), Prec@5 95.312 (95.312)
11/20 04:11 EPOCH: 154 Val: Prec@1 72.920 Prec@5 97.590
11/20 04:11 many acc 70.84, med acc 81.25, few acc 0.00
Best Prec@1: 72.920

Epoch: [155/200][0/194], Time 0.105 (0.105), Loss 0.3051 (0.3051)
11/20 04:12 EPOCH: 155 Train: Time 0.085 (0.088), Loss 0.3480 (0.4233)
===> Calculating KNN centroids.
Test: [0/157], Time 0.079 (0.079), Prec@1 78.125 (78.125), Prec@5 96.875 (96.875)
11/20 04:12 EPOCH: 155 Val: Prec@1 72.390 Prec@5 97.430
11/20 04:12 many acc 71.52, med acc 75.85, few acc 0.00
Best Prec@1: 72.920

Epoch: [156/200][0/194], Time 0.108 (0.108), Loss 0.2037 (0.2037)
11/20 04:12 EPOCH: 156 Train: Time 0.085 (0.088), Loss 0.2950 (0.3412)
===> Calculating KNN centroids.
Test: [0/157], Time 0.039 (0.039), Prec@1 76.562 (76.562), Prec@5 95.312 (95.312)
11/20 04:12 EPOCH: 156 Val: Prec@1 72.310 Prec@5 97.670
11/20 04:12 many acc 71.16, med acc 76.90, few acc 0.00
Best Prec@1: 72.920

Epoch: [157/200][0/194], Time 0.057 (0.057), Loss 0.4436 (0.4436)
11/20 04:13 EPOCH: 157 Train: Time 0.085 (0.088), Loss 0.4772 (0.3706)
===> Calculating KNN centroids.
Test: [0/157], Time 0.063 (0.063), Prec@1 79.688 (79.688), Prec@5 98.438 (98.438)
11/20 04:13 EPOCH: 157 Val: Prec@1 72.380 Prec@5 97.780
11/20 04:13 many acc 71.84, med acc 74.55, few acc 0.00
Best Prec@1: 72.920

Epoch: [158/200][0/194], Time 0.112 (0.112), Loss 0.2620 (0.2620)
11/20 04:13 EPOCH: 158 Train: Time 0.085 (0.088), Loss 0.2180 (0.3454)
===> Calculating KNN centroids.
Test: [0/157], Time 0.078 (0.078), Prec@1 71.875 (71.875), Prec@5 98.438 (98.438)
11/20 04:13 EPOCH: 158 Val: Prec@1 71.810 Prec@5 97.210
11/20 04:13 many acc 69.92, med acc 79.35, few acc 0.00
Best Prec@1: 72.920

Epoch: [159/200][0/194], Time 0.122 (0.122), Loss 0.3651 (0.3651)
11/20 04:13 EPOCH: 159 Train: Time 0.084 (0.088), Loss 0.1379 (0.3336)
===> Calculating KNN centroids.
Test: [0/157], Time 0.083 (0.083), Prec@1 76.562 (76.562), Prec@5 98.438 (98.438)
11/20 04:14 EPOCH: 159 Val: Prec@1 73.790 Prec@5 97.790
11/20 04:14 many acc 71.84, med acc 81.60, few acc 0.00
Best Prec@1: 73.790

Epoch: [160/200][0/194], Time 0.116 (0.116), Loss 0.3034 (0.3034)
11/20 04:14 EPOCH: 160 Train: Time 0.084 (0.088), Loss 0.3110 (0.3187)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_159.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_159.png
11/20 04:14 Loss:12.277, Acc:0.58, NC1:3.466,
Wnorm:[1.577,1.725,1.503,1.266,1.508,1.477,1.538,1.537,1.563,1.499]
Hnorm:[3.615,4.606,4.122,4.024,5.542,6.655,5.910,7.432,10.233,14.090]
Wcos:[-0.088,-0.109,-0.071,-0.072,-0.092,-0.083,-0.107,-0.125,-0.144,-0.162]
WHcos:[0.895,0.960,0.906,0.859,0.962,0.964,0.971,0.990,0.981,0.958]
===> Calculating KNN centroids.
Test: [0/157], Time 0.083 (0.083), Prec@1 73.438 (73.438), Prec@5 98.438 (98.438)
11/20 04:14 EPOCH: 160 Val: Prec@1 71.660 Prec@5 97.300
11/20 04:14 many acc 69.85, med acc 78.90, few acc 0.00
Best Prec@1: 73.790

Epoch: [161/200][0/194], Time 0.122 (0.122), Loss 0.1083 (0.1083)
11/20 04:15 EPOCH: 161 Train: Time 0.084 (0.088), Loss 0.4548 (0.3161)
===> Calculating KNN centroids.
Test: [0/157], Time 0.076 (0.076), Prec@1 76.562 (76.562), Prec@5 96.875 (96.875)
11/20 04:15 EPOCH: 161 Val: Prec@1 73.320 Prec@5 97.580
11/20 04:15 many acc 71.80, med acc 79.40, few acc 0.00
Best Prec@1: 73.790

Epoch: [162/200][0/194], Time 0.109 (0.109), Loss 0.2447 (0.2447)
11/20 04:15 EPOCH: 162 Train: Time 0.085 (0.088), Loss 0.2053 (0.3259)
===> Calculating KNN centroids.
Test: [0/157], Time 0.061 (0.061), Prec@1 78.125 (78.125), Prec@5 96.875 (96.875)
11/20 04:15 EPOCH: 162 Val: Prec@1 72.620 Prec@5 97.770
11/20 04:15 many acc 71.13, med acc 78.60, few acc 0.00
Best Prec@1: 73.790

Epoch: [163/200][0/194], Time 0.089 (0.089), Loss 0.1594 (0.1594)
11/20 04:15 EPOCH: 163 Train: Time 0.085 (0.088), Loss 0.4901 (0.2917)
===> Calculating KNN centroids.
Test: [0/157], Time 0.076 (0.076), Prec@1 78.125 (78.125), Prec@5 96.875 (96.875)
11/20 04:16 EPOCH: 163 Val: Prec@1 72.600 Prec@5 97.590
11/20 04:16 many acc 70.94, med acc 79.25, few acc 0.00
Best Prec@1: 73.790

Epoch: [164/200][0/194], Time 0.113 (0.113), Loss 0.2269 (0.2269)
11/20 04:16 EPOCH: 164 Train: Time 0.085 (0.088), Loss 0.3382 (0.2833)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 78.125 (78.125), Prec@5 95.312 (95.312)
11/20 04:16 EPOCH: 164 Val: Prec@1 70.820 Prec@5 97.170
11/20 04:16 many acc 69.06, med acc 77.85, few acc 0.00
Best Prec@1: 73.790

Epoch: [165/200][0/194], Time 0.133 (0.133), Loss 0.2959 (0.2959)
11/20 04:16 EPOCH: 165 Train: Time 0.084 (0.088), Loss 0.2016 (0.2678)
===> Calculating KNN centroids.
Test: [0/157], Time 0.087 (0.087), Prec@1 76.562 (76.562), Prec@5 98.438 (98.438)
11/20 04:16 EPOCH: 165 Val: Prec@1 73.660 Prec@5 97.460
11/20 04:16 many acc 71.97, med acc 80.40, few acc 0.00
Best Prec@1: 73.790

Epoch: [166/200][0/194], Time 0.101 (0.101), Loss 0.2779 (0.2779)
11/20 04:17 EPOCH: 166 Train: Time 0.085 (0.088), Loss 0.2113 (0.2470)
===> Calculating KNN centroids.
Test: [0/157], Time 0.083 (0.083), Prec@1 79.688 (79.688), Prec@5 100.000 (100.000)
11/20 04:17 EPOCH: 166 Val: Prec@1 73.760 Prec@5 97.750
11/20 04:17 many acc 72.31, med acc 79.55, few acc 0.00
Best Prec@1: 73.790

Epoch: [167/200][0/194], Time 0.104 (0.104), Loss 0.2236 (0.2236)
11/20 04:17 EPOCH: 167 Train: Time 0.084 (0.088), Loss 0.2070 (0.2360)
===> Calculating KNN centroids.
Test: [0/157], Time 0.081 (0.081), Prec@1 78.125 (78.125), Prec@5 98.438 (98.438)
11/20 04:17 EPOCH: 167 Val: Prec@1 74.350 Prec@5 97.790
11/20 04:17 many acc 73.64, med acc 77.20, few acc 0.00
Best Prec@1: 74.350

Epoch: [168/200][0/194], Time 0.106 (0.106), Loss 0.1384 (0.1384)
11/20 04:18 EPOCH: 168 Train: Time 0.084 (0.088), Loss 0.1547 (0.2253)
===> Calculating KNN centroids.
Test: [0/157], Time 0.071 (0.071), Prec@1 76.562 (76.562), Prec@5 100.000 (100.000)
11/20 04:18 EPOCH: 168 Val: Prec@1 73.820 Prec@5 97.630
11/20 04:18 many acc 73.45, med acc 75.30, few acc 0.00
Best Prec@1: 74.350

Epoch: [169/200][0/194], Time 0.099 (0.099), Loss 0.0931 (0.0931)
11/20 04:18 EPOCH: 169 Train: Time 0.084 (0.088), Loss 0.1254 (0.2038)
===> Calculating KNN centroids.
Test: [0/157], Time 0.070 (0.070), Prec@1 82.812 (82.812), Prec@5 96.875 (96.875)
11/20 04:18 EPOCH: 169 Val: Prec@1 73.530 Prec@5 97.730
11/20 04:18 many acc 73.11, med acc 75.20, few acc 0.00
Best Prec@1: 74.350

Epoch: [170/200][0/194], Time 0.112 (0.112), Loss 0.1570 (0.1570)
11/20 04:18 EPOCH: 170 Train: Time 0.084 (0.088), Loss 0.0952 (0.1975)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_169.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_169.png
11/20 04:19 Loss:8.012, Acc:0.72, NC1:2.288,
Wnorm:[1.599,1.716,1.535,1.318,1.540,1.513,1.547,1.535,1.534,1.479]
Hnorm:[4.378,4.847,4.712,4.621,5.986,6.639,8.363,9.428,10.760,15.959]
Wcos:[-0.086,-0.106,-0.075,-0.077,-0.095,-0.089,-0.110,-0.127,-0.139,-0.157]
WHcos:[0.868,0.932,0.878,0.915,0.961,0.964,0.990,0.990,0.982,0.960]
===> Calculating KNN centroids.
Test: [0/157], Time 0.074 (0.074), Prec@1 79.688 (79.688), Prec@5 96.875 (96.875)
11/20 04:19 EPOCH: 170 Val: Prec@1 73.150 Prec@5 97.630
11/20 04:19 many acc 72.38, med acc 76.25, few acc 0.00
Best Prec@1: 74.350

Epoch: [171/200][0/194], Time 0.057 (0.057), Loss 0.3376 (0.3376)
11/20 04:19 EPOCH: 171 Train: Time 0.085 (0.088), Loss 0.2164 (0.1928)
===> Calculating KNN centroids.
Test: [0/157], Time 0.064 (0.064), Prec@1 81.250 (81.250), Prec@5 98.438 (98.438)
11/20 04:19 EPOCH: 171 Val: Prec@1 73.480 Prec@5 97.990
11/20 04:19 many acc 72.86, med acc 75.95, few acc 0.00
Best Prec@1: 74.350

Epoch: [172/200][0/194], Time 0.104 (0.104), Loss 0.1983 (0.1983)
11/20 04:20 EPOCH: 172 Train: Time 0.084 (0.088), Loss 0.1044 (0.1895)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/20 04:20 EPOCH: 172 Val: Prec@1 74.120 Prec@5 98.020
11/20 04:20 many acc 74.15, med acc 74.00, few acc 0.00
Best Prec@1: 74.350

Epoch: [173/200][0/194], Time 0.124 (0.124), Loss 0.1161 (0.1161)
11/20 04:20 EPOCH: 173 Train: Time 0.084 (0.088), Loss 0.2950 (0.1727)
===> Calculating KNN centroids.
Test: [0/157], Time 0.076 (0.076), Prec@1 79.688 (79.688), Prec@5 98.438 (98.438)
11/20 04:20 EPOCH: 173 Val: Prec@1 74.360 Prec@5 97.690
11/20 04:20 many acc 73.47, med acc 77.90, few acc 0.00
Best Prec@1: 74.360

Epoch: [174/200][0/194], Time 0.110 (0.110), Loss 0.1556 (0.1556)
11/20 04:20 EPOCH: 174 Train: Time 0.085 (0.088), Loss 0.2857 (0.1640)
===> Calculating KNN centroids.
Test: [0/157], Time 0.090 (0.090), Prec@1 78.125 (78.125), Prec@5 100.000 (100.000)
11/20 04:21 EPOCH: 174 Val: Prec@1 73.430 Prec@5 97.630
11/20 04:21 many acc 73.40, med acc 73.55, few acc 0.00
Best Prec@1: 74.360

Epoch: [175/200][0/194], Time 0.112 (0.112), Loss 0.1931 (0.1931)
11/20 04:21 EPOCH: 175 Train: Time 0.084 (0.088), Loss 0.0583 (0.1609)
===> Calculating KNN centroids.
Test: [0/157], Time 0.082 (0.082), Prec@1 82.812 (82.812), Prec@5 100.000 (100.000)
11/20 04:21 EPOCH: 175 Val: Prec@1 74.430 Prec@5 97.720
11/20 04:21 many acc 74.16, med acc 75.50, few acc 0.00
Best Prec@1: 74.430

Epoch: [176/200][0/194], Time 0.057 (0.057), Loss 0.1921 (0.1921)
11/20 04:21 EPOCH: 176 Train: Time 0.085 (0.088), Loss 0.1149 (0.1514)
===> Calculating KNN centroids.
Test: [0/157], Time 0.071 (0.071), Prec@1 81.250 (81.250), Prec@5 100.000 (100.000)
11/20 04:21 EPOCH: 176 Val: Prec@1 74.890 Prec@5 97.710
11/20 04:21 many acc 74.00, med acc 78.45, few acc 0.00
Best Prec@1: 74.890

Epoch: [177/200][0/194], Time 0.088 (0.088), Loss 0.0887 (0.0887)
11/20 04:22 EPOCH: 177 Train: Time 0.085 (0.088), Loss 0.1569 (0.1411)
===> Calculating KNN centroids.
Test: [0/157], Time 0.060 (0.060), Prec@1 79.688 (79.688), Prec@5 100.000 (100.000)
11/20 04:22 EPOCH: 177 Val: Prec@1 74.560 Prec@5 97.690
11/20 04:22 many acc 73.95, med acc 77.00, few acc 0.00
Best Prec@1: 74.890

Epoch: [178/200][0/194], Time 0.119 (0.119), Loss 0.0378 (0.0378)
11/20 04:22 EPOCH: 178 Train: Time 0.084 (0.088), Loss 0.0945 (0.1301)
===> Calculating KNN centroids.
Test: [0/157], Time 0.082 (0.082), Prec@1 81.250 (81.250), Prec@5 98.438 (98.438)
11/20 04:22 EPOCH: 178 Val: Prec@1 74.830 Prec@5 97.730
11/20 04:22 many acc 74.38, med acc 76.65, few acc 0.00
Best Prec@1: 74.890

Epoch: [179/200][0/194], Time 0.081 (0.081), Loss 0.0541 (0.0541)
11/20 04:23 EPOCH: 179 Train: Time 0.084 (0.088), Loss 0.0315 (0.1235)
===> Calculating KNN centroids.
Test: [0/157], Time 0.039 (0.039), Prec@1 81.250 (81.250), Prec@5 100.000 (100.000)
11/20 04:23 EPOCH: 179 Val: Prec@1 75.160 Prec@5 97.690
11/20 04:23 many acc 74.92, med acc 76.10, few acc 0.00
Best Prec@1: 75.160

Epoch: [180/200][0/194], Time 0.115 (0.115), Loss 0.1347 (0.1347)
11/20 04:23 EPOCH: 180 Train: Time 0.084 (0.088), Loss 0.1157 (0.1224)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_179.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_179.png
11/20 04:23 Loss:5.249, Acc:0.81, NC1:1.443,
Wnorm:[1.613,1.711,1.561,1.357,1.553,1.536,1.545,1.523,1.521,1.455]
Hnorm:[4.465,4.937,4.992,5.027,6.363,7.532,8.859,9.925,10.613,15.150]
Wcos:[-0.086,-0.104,-0.078,-0.081,-0.097,-0.094,-0.111,-0.126,-0.138,-0.153]
WHcos:[0.857,0.924,0.894,0.935,0.960,0.968,0.988,0.983,0.977,0.954]
===> Calculating KNN centroids.
Test: [0/157], Time 0.076 (0.076), Prec@1 81.250 (81.250), Prec@5 96.875 (96.875)
11/20 04:23 EPOCH: 180 Val: Prec@1 74.970 Prec@5 97.720
11/20 04:23 many acc 75.06, med acc 74.60, few acc 0.00
Best Prec@1: 75.160

Epoch: [181/200][0/194], Time 0.112 (0.112), Loss 0.0677 (0.0677)
11/20 04:24 EPOCH: 181 Train: Time 0.084 (0.088), Loss 0.1270 (0.1099)
===> Calculating KNN centroids.
Test: [0/157], Time 0.087 (0.087), Prec@1 82.812 (82.812), Prec@5 100.000 (100.000)
11/20 04:24 EPOCH: 181 Val: Prec@1 74.680 Prec@5 97.990
11/20 04:24 many acc 75.21, med acc 72.55, few acc 0.00
Best Prec@1: 75.160

Epoch: [182/200][0/194], Time 0.088 (0.088), Loss 0.1165 (0.1165)
11/20 04:24 EPOCH: 182 Train: Time 0.084 (0.088), Loss 0.1394 (0.1069)
===> Calculating KNN centroids.
Test: [0/157], Time 0.071 (0.071), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/20 04:24 EPOCH: 182 Val: Prec@1 74.250 Prec@5 97.800
11/20 04:24 many acc 75.31, med acc 70.00, few acc 0.00
Best Prec@1: 75.160

Epoch: [183/200][0/194], Time 0.109 (0.109), Loss 0.0527 (0.0527)
11/20 04:25 EPOCH: 183 Train: Time 0.085 (0.088), Loss 0.1924 (0.1054)
===> Calculating KNN centroids.
Test: [0/157], Time 0.058 (0.058), Prec@1 82.812 (82.812), Prec@5 100.000 (100.000)
11/20 04:25 EPOCH: 183 Val: Prec@1 74.500 Prec@5 97.750
11/20 04:25 many acc 75.00, med acc 72.50, few acc 0.00
Best Prec@1: 75.160

Epoch: [184/200][0/194], Time 0.116 (0.116), Loss 0.2179 (0.2179)
11/20 04:25 EPOCH: 184 Train: Time 0.084 (0.088), Loss 0.0642 (0.1077)
===> Calculating KNN centroids.
Test: [0/157], Time 0.080 (0.080), Prec@1 81.250 (81.250), Prec@5 100.000 (100.000)
11/20 04:25 EPOCH: 184 Val: Prec@1 74.410 Prec@5 97.630
11/20 04:25 many acc 74.48, med acc 74.15, few acc 0.00
Best Prec@1: 75.160

Epoch: [185/200][0/194], Time 0.103 (0.103), Loss 0.0587 (0.0587)
11/20 04:25 EPOCH: 185 Train: Time 0.084 (0.088), Loss 0.0594 (0.1008)
===> Calculating KNN centroids.
Test: [0/157], Time 0.068 (0.068), Prec@1 82.812 (82.812), Prec@5 100.000 (100.000)
11/20 04:26 EPOCH: 185 Val: Prec@1 74.580 Prec@5 97.580
11/20 04:26 many acc 74.60, med acc 74.50, few acc 0.00
Best Prec@1: 75.160

Epoch: [186/200][0/194], Time 0.107 (0.107), Loss 0.0516 (0.0516)
11/20 04:26 EPOCH: 186 Train: Time 0.085 (0.088), Loss 0.0669 (0.0960)
===> Calculating KNN centroids.
Test: [0/157], Time 0.081 (0.081), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/20 04:26 EPOCH: 186 Val: Prec@1 74.620 Prec@5 97.640
11/20 04:26 many acc 75.29, med acc 71.95, few acc 0.00
Best Prec@1: 75.160

Epoch: [187/200][0/194], Time 0.114 (0.114), Loss 0.1271 (0.1271)
11/20 04:26 EPOCH: 187 Train: Time 0.084 (0.088), Loss 0.0358 (0.0952)
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/20 04:26 EPOCH: 187 Val: Prec@1 74.280 Prec@5 97.570
11/20 04:26 many acc 74.74, med acc 72.45, few acc 0.00
Best Prec@1: 75.160

Epoch: [188/200][0/194], Time 0.126 (0.126), Loss 0.1027 (0.1027)
11/20 04:27 EPOCH: 188 Train: Time 0.084 (0.088), Loss 0.0394 (0.0902)
===> Calculating KNN centroids.
Test: [0/157], Time 0.081 (0.081), Prec@1 81.250 (81.250), Prec@5 98.438 (98.438)
11/20 04:27 EPOCH: 188 Val: Prec@1 74.610 Prec@5 97.640
11/20 04:27 many acc 74.69, med acc 74.30, few acc 0.00
Best Prec@1: 75.160

Epoch: [189/200][0/194], Time 0.118 (0.118), Loss 0.0425 (0.0425)
11/20 04:27 EPOCH: 189 Train: Time 0.085 (0.088), Loss 0.2645 (0.0888)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 82.812 (82.812), Prec@5 100.000 (100.000)
11/20 04:27 EPOCH: 189 Val: Prec@1 74.390 Prec@5 97.520
11/20 04:27 many acc 74.64, med acc 73.40, few acc 0.00
Best Prec@1: 75.160

Epoch: [190/200][0/194], Time 0.111 (0.111), Loss 0.0620 (0.0620)
11/20 04:28 EPOCH: 190 Train: Time 0.084 (0.088), Loss 0.0369 (0.0855)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_189.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_189.png
11/20 04:28 Loss:4.357, Acc:0.85, NC1:1.189,
Wnorm:[1.617,1.707,1.572,1.374,1.558,1.542,1.543,1.516,1.512,1.446]
Hnorm:[4.677,5.086,5.218,5.269,6.576,7.209,8.882,10.557,11.491,16.144]
Wcos:[-0.086,-0.103,-0.079,-0.083,-0.098,-0.096,-0.112,-0.126,-0.137,-0.151]
WHcos:[0.848,0.897,0.883,0.926,0.956,0.958,0.986,0.979,0.970,0.952]
===> Calculating KNN centroids.
Test: [0/157], Time 0.067 (0.067), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/20 04:28 EPOCH: 190 Val: Prec@1 74.230 Prec@5 97.570
11/20 04:28 many acc 74.98, med acc 71.25, few acc 0.00
Best Prec@1: 75.160

Epoch: [191/200][0/194], Time 0.119 (0.119), Loss 0.1658 (0.1658)
11/20 04:28 EPOCH: 191 Train: Time 0.085 (0.088), Loss 0.1283 (0.0914)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 82.812 (82.812), Prec@5 100.000 (100.000)
11/20 04:28 EPOCH: 191 Val: Prec@1 74.430 Prec@5 97.490
11/20 04:28 many acc 74.46, med acc 74.30, few acc 0.00
Best Prec@1: 75.160

Epoch: [192/200][0/194], Time 0.098 (0.098), Loss 0.0471 (0.0471)
11/20 04:29 EPOCH: 192 Train: Time 0.085 (0.088), Loss 0.0909 (0.0824)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 81.250 (81.250), Prec@5 96.875 (96.875)
11/20 04:29 EPOCH: 192 Val: Prec@1 74.830 Prec@5 97.470
11/20 04:29 many acc 74.95, med acc 74.35, few acc 0.00
Best Prec@1: 75.160

Epoch: [193/200][0/194], Time 0.104 (0.104), Loss 0.0806 (0.0806)
11/20 04:29 EPOCH: 193 Train: Time 0.085 (0.088), Loss 0.1114 (0.0877)
===> Calculating KNN centroids.
Test: [0/157], Time 0.077 (0.077), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/20 04:29 EPOCH: 193 Val: Prec@1 74.480 Prec@5 97.680
11/20 04:29 many acc 75.03, med acc 72.30, few acc 0.00
Best Prec@1: 75.160

Epoch: [194/200][0/194], Time 0.114 (0.114), Loss 0.0867 (0.0867)
11/20 04:30 EPOCH: 194 Train: Time 0.084 (0.088), Loss 0.0559 (0.0811)
===> Calculating KNN centroids.
Test: [0/157], Time 0.082 (0.082), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/20 04:30 EPOCH: 194 Val: Prec@1 74.500 Prec@5 97.480
11/20 04:30 many acc 75.12, med acc 72.00, few acc 0.00
Best Prec@1: 75.160

Epoch: [195/200][0/194], Time 0.110 (0.110), Loss 0.0651 (0.0651)
11/20 04:30 EPOCH: 195 Train: Time 0.085 (0.088), Loss 0.2041 (0.0825)
===> Calculating KNN centroids.
Test: [0/157], Time 0.071 (0.071), Prec@1 82.812 (82.812), Prec@5 100.000 (100.000)
11/20 04:30 EPOCH: 195 Val: Prec@1 74.810 Prec@5 97.510
11/20 04:30 many acc 75.07, med acc 73.75, few acc 0.00
Best Prec@1: 75.160

Epoch: [196/200][0/194], Time 0.110 (0.110), Loss 0.0702 (0.0702)
11/20 04:30 EPOCH: 196 Train: Time 0.084 (0.088), Loss 0.0459 (0.0831)
===> Calculating KNN centroids.
Test: [0/157], Time 0.069 (0.069), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/20 04:31 EPOCH: 196 Val: Prec@1 74.570 Prec@5 97.540
11/20 04:31 many acc 74.86, med acc 73.40, few acc 0.00
Best Prec@1: 75.160

Epoch: [197/200][0/194], Time 0.108 (0.108), Loss 0.0686 (0.0686)
11/20 04:31 EPOCH: 197 Train: Time 0.084 (0.088), Loss 0.2249 (0.0847)
===> Calculating KNN centroids.
Test: [0/157], Time 0.066 (0.066), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/20 04:31 EPOCH: 197 Val: Prec@1 74.430 Prec@5 97.620
11/20 04:31 many acc 74.96, med acc 72.30, few acc 0.00
Best Prec@1: 75.160

Epoch: [198/200][0/194], Time 0.114 (0.114), Loss 0.1117 (0.1117)
11/20 04:31 EPOCH: 198 Train: Time 0.085 (0.088), Loss 0.0798 (0.0786)
===> Calculating KNN centroids.
Test: [0/157], Time 0.075 (0.075), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/20 04:31 EPOCH: 198 Val: Prec@1 74.730 Prec@5 97.480
11/20 04:31 many acc 74.98, med acc 73.75, few acc 0.00
Best Prec@1: 75.160

Epoch: [199/200][0/194], Time 0.115 (0.115), Loss 0.1537 (0.1537)
11/20 04:32 EPOCH: 199 Train: Time 0.084 (0.088), Loss 0.1013 (0.0852)
===> Calculating KNN centroids.
Test: [0/157], Time 0.086 (0.086), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/20 04:32 EPOCH: 199 Val: Prec@1 74.480 Prec@5 97.460
11/20 04:32 many acc 74.46, med acc 74.55, few acc 0.00
Best Prec@1: 75.160

Epoch: [200/200][0/194], Time 0.108 (0.108), Loss 0.1036 (0.1036)
11/20 04:32 EPOCH: 200 Train: Time 0.085 (0.088), Loss 0.0689 (0.0843)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cos_VSres50_epoch_199.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cos_VSres50_epoch_199.png
11/20 04:32 Loss:4.954, Acc:0.83, NC1:1.187,
Wnorm:[1.618,1.707,1.574,1.377,1.559,1.543,1.542,1.514,1.511,1.445]
Hnorm:[4.851,5.248,5.414,5.452,6.869,7.718,8.306,10.773,12.841,17.827]
Wcos:[-0.086,-0.103,-0.079,-0.083,-0.098,-0.096,-0.112,-0.126,-0.137,-0.151]
WHcos:[0.824,0.895,0.866,0.917,0.951,0.956,0.983,0.980,0.968,0.948]
11/20 04:32 -- Has saved the NC analysis result to ./output/cifar10_resnet50/0.01/name_2023-11-20/analysis199.pkl
===> Calculating KNN centroids.
Test: [0/157], Time 0.080 (0.080), Prec@1 82.812 (82.812), Prec@5 100.000 (100.000)
11/20 04:32 EPOCH: 200 Val: Prec@1 74.770 Prec@5 97.540
11/20 04:32 many acc 74.86, med acc 74.40, few acc 0.00
Best Prec@1: 75.160

It took 1:31:36.66 to execute the program
