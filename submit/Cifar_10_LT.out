Namespace(dataset='cifar10', root='../dataset/', arch='resnet32', num_classes=10, imbanlance_rate=0.01, lr=0.01, epochs=200, batch_size=64, momentum=0.9, weight_decay=0.005, resample_weighting=0.0, label_weighting=1.2, contrast_weight=4, beta=0.5, loss='ce', eps=0.05, seed=3407, print_freq=1000, gpu=0, workers=4, resume=None, start_epoch=0, root_log='./output/', root_model='./output/', store_name='cifar10_resnet32/0.01/name_2023-11-16', debug=10, knn=True)
Use GPU: 0 for training
=> creating model 'resnet32'
  + Number of params: 7.44M
Files already downloaded and verified
imbanlance_ration is 100.0
per class num: [5000, 2997, 1796, 1077, 645, 387, 232, 139, 83, 50]
Files already downloaded and verified
load cifar10
Training started!
Epoch: [1/200][0/194], Time 8.928 (8.928), Loss 3.1866 (3.1866)
11/16 10:27 EPOCH: 1 Train: Time 0.382 (0.090), Loss 0.9726 (1.4243)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_0.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_0.png
11/16 10:27 Loss:8.766, Acc:0.62, NC1:31697.910,
Wnorm:[1.084,1.223,0.984,1.212,1.165,1.168,1.338,1.283,1.344,1.210]
Hnorm:[6.874,5.480,2.674,2.873,3.625,3.061,3.425,2.365,4.450,3.524]
Wcos:[0.037,0.059,0.048,0.010,0.010,0.017,0.036,-0.014,0.003,-0.009]
===> Calculating KNN centroids.
Test: [0/157], Time 0.240 (0.240), Prec@1 57.812 (57.812), Prec@5 85.938 (85.938)
11/16 10:27 EPOCH: 1 Val: Prec@1 32.110 Prec@5 87.900
11/16 10:27 many acc 34.01, med acc 24.50, few acc 0.00
Best Prec@1: 32.110

Epoch: [2/200][0/194], Time 0.147 (0.147), Loss 1.0146 (1.0146)
11/16 10:27 EPOCH: 2 Train: Time 0.041 (0.043), Loss 0.8555 (1.0776)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 60.938 (60.938), Prec@5 92.188 (92.188)
11/16 10:27 EPOCH: 2 Val: Prec@1 37.180 Prec@5 90.120
11/16 10:27 many acc 39.51, med acc 27.85, few acc 0.00
Best Prec@1: 37.180

Epoch: [3/200][0/194], Time 0.129 (0.129), Loss 0.8487 (0.8487)
11/16 10:27 EPOCH: 3 Train: Time 0.041 (0.043), Loss 0.9448 (0.9350)
===> Calculating KNN centroids.
Test: [0/157], Time 0.097 (0.097), Prec@1 76.562 (76.562), Prec@5 92.188 (92.188)
11/16 10:27 EPOCH: 3 Val: Prec@1 40.450 Prec@5 91.470
11/16 10:27 many acc 45.05, med acc 22.05, few acc 0.00
Best Prec@1: 40.450

Epoch: [4/200][0/194], Time 0.139 (0.139), Loss 0.7335 (0.7335)
11/16 10:28 EPOCH: 4 Train: Time 0.040 (0.043), Loss 0.7630 (0.8623)
===> Calculating KNN centroids.
Test: [0/157], Time 0.109 (0.109), Prec@1 57.812 (57.812), Prec@5 93.750 (93.750)
11/16 10:28 EPOCH: 4 Val: Prec@1 42.150 Prec@5 91.930
11/16 10:28 many acc 45.15, med acc 30.15, few acc 0.00
Best Prec@1: 42.150

Epoch: [5/200][0/194], Time 0.151 (0.151), Loss 0.7157 (0.7157)
11/16 10:28 EPOCH: 5 Train: Time 0.041 (0.043), Loss 1.0273 (0.8207)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 56.250 (56.250), Prec@5 89.062 (89.062)
11/16 10:28 EPOCH: 5 Val: Prec@1 47.920 Prec@5 92.900
11/16 10:28 many acc 50.90, med acc 36.00, few acc 0.00
Best Prec@1: 47.920

Epoch: [6/200][0/194], Time 0.146 (0.146), Loss 0.6217 (0.6217)
11/16 10:28 EPOCH: 6 Train: Time 0.041 (0.043), Loss 0.5034 (0.7272)
===> Calculating KNN centroids.
Test: [0/157], Time 0.112 (0.112), Prec@1 75.000 (75.000), Prec@5 93.750 (93.750)
11/16 10:28 EPOCH: 6 Val: Prec@1 50.510 Prec@5 94.330
11/16 10:28 many acc 54.94, med acc 32.80, few acc 0.00
Best Prec@1: 50.510

Epoch: [7/200][0/194], Time 0.143 (0.143), Loss 0.6189 (0.6189)
11/16 10:28 EPOCH: 7 Train: Time 0.040 (0.043), Loss 0.8335 (0.6789)
===> Calculating KNN centroids.
Test: [0/157], Time 0.101 (0.101), Prec@1 65.625 (65.625), Prec@5 90.625 (90.625)
11/16 10:29 EPOCH: 7 Val: Prec@1 51.580 Prec@5 94.760
11/16 10:29 many acc 55.96, med acc 34.05, few acc 0.00
Best Prec@1: 51.580

Epoch: [8/200][0/194], Time 0.134 (0.134), Loss 0.6012 (0.6012)
11/16 10:29 EPOCH: 8 Train: Time 0.040 (0.043), Loss 0.7990 (0.6289)
===> Calculating KNN centroids.
Test: [0/157], Time 0.098 (0.098), Prec@1 82.812 (82.812), Prec@5 93.750 (93.750)
11/16 10:29 EPOCH: 8 Val: Prec@1 57.000 Prec@5 95.560
11/16 10:29 many acc 62.06, med acc 36.75, few acc 0.00
Best Prec@1: 57.000

Epoch: [9/200][0/194], Time 0.154 (0.154), Loss 0.5627 (0.5627)
11/16 10:29 EPOCH: 9 Train: Time 0.040 (0.043), Loss 0.5314 (0.5896)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 62.500 (62.500), Prec@5 90.625 (90.625)
11/16 10:29 EPOCH: 9 Val: Prec@1 55.620 Prec@5 94.410
11/16 10:29 many acc 55.21, med acc 57.25, few acc 0.00
Best Prec@1: 57.000

Epoch: [10/200][0/194], Time 0.139 (0.139), Loss 0.6145 (0.6145)
11/16 10:29 EPOCH: 10 Train: Time 0.041 (0.043), Loss 0.5199 (0.5454)
===> Calculating KNN centroids.
Test: [0/157], Time 0.116 (0.116), Prec@1 73.438 (73.438), Prec@5 93.750 (93.750)
11/16 10:29 EPOCH: 10 Val: Prec@1 61.070 Prec@5 95.810
11/16 10:29 many acc 60.76, med acc 62.30, few acc 0.00
Best Prec@1: 61.070

Epoch: [11/200][0/194], Time 0.139 (0.139), Loss 0.8273 (0.8273)
11/16 10:30 EPOCH: 11 Train: Time 0.040 (0.043), Loss 0.4687 (0.5357)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_10.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_10.png
11/16 10:30 Loss:3.875, Acc:0.83, NC1:20.817,
Wnorm:[1.049,1.174,0.930,0.861,0.889,0.845,0.883,0.815,0.930,0.821]
Hnorm:[5.895,8.984,3.568,3.966,4.200,5.227,5.692,4.480,6.168,3.977]
Wcos:[-0.113,-0.100,-0.082,-0.060,-0.085,-0.062,-0.046,-0.064,-0.086,-0.083]
===> Calculating KNN centroids.
Test: [0/157], Time 0.109 (0.109), Prec@1 82.812 (82.812), Prec@5 95.312 (95.312)
11/16 10:30 EPOCH: 11 Val: Prec@1 62.010 Prec@5 96.720
11/16 10:30 many acc 65.41, med acc 48.40, few acc 0.00
Best Prec@1: 62.010

Epoch: [12/200][0/194], Time 0.144 (0.144), Loss 0.4738 (0.4738)
11/16 10:30 EPOCH: 12 Train: Time 0.040 (0.043), Loss 0.6101 (0.5105)
===> Calculating KNN centroids.
Test: [0/157], Time 0.108 (0.108), Prec@1 73.438 (73.438), Prec@5 92.188 (92.188)
11/16 10:30 EPOCH: 12 Val: Prec@1 65.700 Prec@5 96.990
11/16 10:30 many acc 67.39, med acc 58.95, few acc 0.00
Best Prec@1: 65.700

Epoch: [13/200][0/194], Time 0.145 (0.145), Loss 0.4402 (0.4402)
11/16 10:30 EPOCH: 13 Train: Time 0.041 (0.043), Loss 0.4680 (0.4778)
===> Calculating KNN centroids.
Test: [0/157], Time 0.100 (0.100), Prec@1 79.688 (79.688), Prec@5 89.062 (89.062)
11/16 10:30 EPOCH: 13 Val: Prec@1 61.450 Prec@5 95.510
11/16 10:30 many acc 62.54, med acc 57.10, few acc 0.00
Best Prec@1: 65.700

Epoch: [14/200][0/194], Time 0.139 (0.139), Loss 0.4078 (0.4078)
11/16 10:31 EPOCH: 14 Train: Time 0.040 (0.043), Loss 0.5413 (0.4741)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 73.438 (73.438), Prec@5 95.312 (95.312)
11/16 10:31 EPOCH: 14 Val: Prec@1 66.230 Prec@5 97.010
11/16 10:31 many acc 65.88, med acc 67.65, few acc 0.00
Best Prec@1: 66.230

Epoch: [15/200][0/194], Time 0.146 (0.146), Loss 0.3879 (0.3879)
11/16 10:31 EPOCH: 15 Train: Time 0.040 (0.043), Loss 0.4938 (0.4631)
===> Calculating KNN centroids.
Test: [0/157], Time 0.116 (0.116), Prec@1 67.188 (67.188), Prec@5 90.625 (90.625)
11/16 10:31 EPOCH: 15 Val: Prec@1 66.780 Prec@5 96.570
11/16 10:31 many acc 66.03, med acc 69.80, few acc 0.00
Best Prec@1: 66.780

Epoch: [16/200][0/194], Time 0.132 (0.132), Loss 0.3785 (0.3785)
11/16 10:31 EPOCH: 16 Train: Time 0.040 (0.043), Loss 0.5511 (0.4424)
===> Calculating KNN centroids.
Test: [0/157], Time 0.120 (0.120), Prec@1 81.250 (81.250), Prec@5 92.188 (92.188)
11/16 10:31 EPOCH: 16 Val: Prec@1 65.510 Prec@5 95.340
11/16 10:31 many acc 63.90, med acc 71.95, few acc 0.00
Best Prec@1: 66.780

Epoch: [17/200][0/194], Time 0.135 (0.135), Loss 0.3689 (0.3689)
11/16 10:31 EPOCH: 17 Train: Time 0.040 (0.043), Loss 0.5605 (0.4340)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 71.875 (71.875), Prec@5 93.750 (93.750)
11/16 10:32 EPOCH: 17 Val: Prec@1 67.250 Prec@5 96.740
11/16 10:32 many acc 66.75, med acc 69.25, few acc 0.00
Best Prec@1: 67.250

Epoch: [18/200][0/194], Time 0.144 (0.144), Loss 0.3060 (0.3060)
11/16 10:32 EPOCH: 18 Train: Time 0.040 (0.043), Loss 0.2654 (0.4292)
===> Calculating KNN centroids.
Test: [0/157], Time 0.091 (0.091), Prec@1 81.250 (81.250), Prec@5 96.875 (96.875)
11/16 10:32 EPOCH: 18 Val: Prec@1 67.850 Prec@5 97.000
11/16 10:32 many acc 66.90, med acc 71.65, few acc 0.00
Best Prec@1: 67.850

Epoch: [19/200][0/194], Time 0.129 (0.129), Loss 0.2501 (0.2501)
11/16 10:32 EPOCH: 19 Train: Time 0.040 (0.043), Loss 0.8043 (0.4205)
===> Calculating KNN centroids.
Test: [0/157], Time 0.100 (0.100), Prec@1 67.188 (67.188), Prec@5 95.312 (95.312)
11/16 10:32 EPOCH: 19 Val: Prec@1 67.300 Prec@5 97.280
11/16 10:32 many acc 69.87, med acc 57.00, few acc 0.00
Best Prec@1: 67.850

Epoch: [20/200][0/194], Time 0.139 (0.139), Loss 0.4178 (0.4178)
11/16 10:32 EPOCH: 20 Train: Time 0.040 (0.043), Loss 0.4437 (0.4136)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 81.250 (81.250), Prec@5 93.750 (93.750)
11/16 10:32 EPOCH: 20 Val: Prec@1 69.540 Prec@5 96.960
11/16 10:32 many acc 69.91, med acc 68.05, few acc 0.00
Best Prec@1: 69.540

Epoch: [21/200][0/194], Time 0.144 (0.144), Loss 0.3520 (0.3520)
11/16 10:33 EPOCH: 21 Train: Time 0.040 (0.043), Loss 0.3305 (0.3931)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_20.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_20.png
11/16 10:33 Loss:3.932, Acc:0.83, NC1:7.223,
Wnorm:[1.470,1.514,1.224,1.028,1.074,0.978,0.983,0.874,0.966,0.861]
Hnorm:[3.674,5.625,3.080,3.771,3.412,5.013,4.084,3.464,4.978,3.174]
Wcos:[-0.157,-0.138,-0.129,-0.090,-0.097,-0.072,-0.084,-0.069,-0.104,-0.088]
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 75.000 (75.000), Prec@5 95.312 (95.312)
11/16 10:33 EPOCH: 21 Val: Prec@1 68.600 Prec@5 97.110
11/16 10:33 many acc 70.02, med acc 62.90, few acc 0.00
Best Prec@1: 69.540

Epoch: [22/200][0/194], Time 0.131 (0.131), Loss 0.3789 (0.3789)
11/16 10:33 EPOCH: 22 Train: Time 0.040 (0.043), Loss 0.3348 (0.3899)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 81.250 (81.250), Prec@5 93.750 (93.750)
11/16 10:33 EPOCH: 22 Val: Prec@1 69.440 Prec@5 97.410
11/16 10:33 many acc 71.83, med acc 59.90, few acc 0.00
Best Prec@1: 69.540

Epoch: [23/200][0/194], Time 0.134 (0.134), Loss 0.2863 (0.2863)
11/16 10:33 EPOCH: 23 Train: Time 0.041 (0.043), Loss 0.4626 (0.3902)
===> Calculating KNN centroids.
Test: [0/157], Time 0.116 (0.116), Prec@1 87.500 (87.500), Prec@5 100.000 (100.000)
11/16 10:33 EPOCH: 23 Val: Prec@1 70.570 Prec@5 97.650
11/16 10:33 many acc 69.88, med acc 73.35, few acc 0.00
Best Prec@1: 70.570

Epoch: [24/200][0/194], Time 0.143 (0.143), Loss 0.2954 (0.2954)
11/16 10:34 EPOCH: 24 Train: Time 0.040 (0.043), Loss 0.3873 (0.3854)
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 85.938 (85.938), Prec@5 95.312 (95.312)
11/16 10:34 EPOCH: 24 Val: Prec@1 71.400 Prec@5 97.670
11/16 10:34 many acc 70.22, med acc 76.10, few acc 0.00
Best Prec@1: 71.400

Epoch: [25/200][0/194], Time 0.150 (0.150), Loss 0.4452 (0.4452)
11/16 10:34 EPOCH: 25 Train: Time 0.040 (0.043), Loss 0.4172 (0.3790)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/16 10:34 EPOCH: 25 Val: Prec@1 69.120 Prec@5 97.260
11/16 10:34 many acc 70.00, med acc 65.60, few acc 0.00
Best Prec@1: 71.400

Epoch: [26/200][0/194], Time 0.138 (0.138), Loss 0.3890 (0.3890)
11/16 10:34 EPOCH: 26 Train: Time 0.040 (0.043), Loss 0.4312 (0.3751)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 85.938 (85.938), Prec@5 95.312 (95.312)
11/16 10:34 EPOCH: 26 Val: Prec@1 67.200 Prec@5 96.960
11/16 10:34 many acc 68.11, med acc 63.55, few acc 0.00
Best Prec@1: 71.400

Epoch: [27/200][0/194], Time 0.144 (0.144), Loss 0.5893 (0.5893)
11/16 10:34 EPOCH: 27 Train: Time 0.040 (0.043), Loss 0.3606 (0.3812)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 79.688 (79.688), Prec@5 90.625 (90.625)
11/16 10:35 EPOCH: 27 Val: Prec@1 65.730 Prec@5 96.160
11/16 10:35 many acc 70.62, med acc 46.15, few acc 0.00
Best Prec@1: 71.400

Epoch: [28/200][0/194], Time 0.129 (0.129), Loss 0.5161 (0.5161)
11/16 10:35 EPOCH: 28 Train: Time 0.040 (0.043), Loss 0.4288 (0.3702)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 76.562 (76.562), Prec@5 96.875 (96.875)
11/16 10:35 EPOCH: 28 Val: Prec@1 68.310 Prec@5 97.230
11/16 10:35 many acc 65.80, med acc 78.35, few acc 0.00
Best Prec@1: 71.400

Epoch: [29/200][0/194], Time 0.141 (0.141), Loss 0.2876 (0.2876)
11/16 10:35 EPOCH: 29 Train: Time 0.040 (0.043), Loss 0.3341 (0.3621)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 85.938 (85.938), Prec@5 95.312 (95.312)
11/16 10:35 EPOCH: 29 Val: Prec@1 69.950 Prec@5 97.110
11/16 10:35 many acc 69.42, med acc 72.05, few acc 0.00
Best Prec@1: 71.400

Epoch: [30/200][0/194], Time 0.136 (0.136), Loss 0.4373 (0.4373)
11/16 10:35 EPOCH: 30 Train: Time 0.040 (0.043), Loss 0.4138 (0.3709)
===> Calculating KNN centroids.
Test: [0/157], Time 0.097 (0.097), Prec@1 84.375 (84.375), Prec@5 95.312 (95.312)
11/16 10:35 EPOCH: 30 Val: Prec@1 72.090 Prec@5 97.950
11/16 10:35 many acc 71.76, med acc 73.40, few acc 0.00
Best Prec@1: 72.090

Epoch: [31/200][0/194], Time 0.151 (0.151), Loss 0.3810 (0.3810)
11/16 10:36 EPOCH: 31 Train: Time 0.041 (0.043), Loss 0.3869 (0.3630)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_30.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_30.png
11/16 10:36 Loss:3.084, Acc:0.87, NC1:5.006,
Wnorm:[1.628,1.645,1.376,1.099,1.161,1.013,1.026,0.939,0.969,0.855]
Hnorm:[3.675,4.360,2.739,2.809,3.624,2.745,5.620,3.273,5.020,2.832]
Wcos:[-0.164,-0.144,-0.141,-0.092,-0.100,-0.071,-0.086,-0.064,-0.096,-0.080]
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 84.375 (84.375), Prec@5 95.312 (95.312)
11/16 10:36 EPOCH: 31 Val: Prec@1 68.270 Prec@5 96.970
11/16 10:36 many acc 69.84, med acc 62.00, few acc 0.00
Best Prec@1: 72.090

Epoch: [32/200][0/194], Time 0.138 (0.138), Loss 0.3014 (0.3014)
11/16 10:36 EPOCH: 32 Train: Time 0.041 (0.043), Loss 0.6619 (0.3481)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 70.312 (70.312), Prec@5 96.875 (96.875)
11/16 10:36 EPOCH: 32 Val: Prec@1 69.820 Prec@5 97.630
11/16 10:36 many acc 69.92, med acc 69.40, few acc 0.00
Best Prec@1: 72.090

Epoch: [33/200][0/194], Time 0.138 (0.138), Loss 0.2506 (0.2506)
11/16 10:36 EPOCH: 33 Train: Time 0.040 (0.043), Loss 0.4272 (0.3507)
===> Calculating KNN centroids.
Test: [0/157], Time 0.107 (0.107), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/16 10:36 EPOCH: 33 Val: Prec@1 71.850 Prec@5 97.440
11/16 10:36 many acc 71.89, med acc 71.70, few acc 0.00
Best Prec@1: 72.090

Epoch: [34/200][0/194], Time 0.139 (0.139), Loss 0.2990 (0.2990)
11/16 10:37 EPOCH: 34 Train: Time 0.040 (0.043), Loss 0.4923 (0.3540)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 67.188 (67.188), Prec@5 85.938 (85.938)
11/16 10:37 EPOCH: 34 Val: Prec@1 69.010 Prec@5 95.900
11/16 10:37 many acc 69.59, med acc 66.70, few acc 0.00
Best Prec@1: 72.090

Epoch: [35/200][0/194], Time 0.144 (0.144), Loss 0.3149 (0.3149)
11/16 10:37 EPOCH: 35 Train: Time 0.040 (0.043), Loss 0.2981 (0.3397)
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 81.250 (81.250), Prec@5 95.312 (95.312)
11/16 10:37 EPOCH: 35 Val: Prec@1 72.820 Prec@5 97.280
11/16 10:37 many acc 70.39, med acc 82.55, few acc 0.00
Best Prec@1: 72.820

Epoch: [36/200][0/194], Time 0.139 (0.139), Loss 0.2418 (0.2418)
11/16 10:37 EPOCH: 36 Train: Time 0.040 (0.043), Loss 0.4048 (0.3454)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/16 10:37 EPOCH: 36 Val: Prec@1 67.120 Prec@5 96.190
11/16 10:37 many acc 64.41, med acc 77.95, few acc 0.00
Best Prec@1: 72.820

Epoch: [37/200][0/194], Time 0.143 (0.143), Loss 0.1504 (0.1504)
11/16 10:37 EPOCH: 37 Train: Time 0.040 (0.043), Loss 0.4767 (0.3355)
===> Calculating KNN centroids.
Test: [0/157], Time 0.120 (0.120), Prec@1 81.250 (81.250), Prec@5 93.750 (93.750)
11/16 10:38 EPOCH: 37 Val: Prec@1 70.090 Prec@5 96.600
11/16 10:38 many acc 71.70, med acc 63.65, few acc 0.00
Best Prec@1: 72.820

Epoch: [38/200][0/194], Time 0.132 (0.132), Loss 0.3059 (0.3059)
11/16 10:38 EPOCH: 38 Train: Time 0.040 (0.043), Loss 0.3300 (0.3305)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 78.125 (78.125), Prec@5 93.750 (93.750)
11/16 10:38 EPOCH: 38 Val: Prec@1 66.250 Prec@5 97.100
11/16 10:38 many acc 66.84, med acc 63.90, few acc 0.00
Best Prec@1: 72.820

Epoch: [39/200][0/194], Time 0.132 (0.132), Loss 0.4122 (0.4122)
11/16 10:38 EPOCH: 39 Train: Time 0.040 (0.043), Loss 0.2154 (0.3347)
===> Calculating KNN centroids.
Test: [0/157], Time 0.109 (0.109), Prec@1 62.500 (62.500), Prec@5 95.312 (95.312)
11/16 10:38 EPOCH: 39 Val: Prec@1 70.760 Prec@5 97.330
11/16 10:38 many acc 68.85, med acc 78.40, few acc 0.00
Best Prec@1: 72.820

Epoch: [40/200][0/194], Time 0.139 (0.139), Loss 0.3282 (0.3282)
11/16 10:38 EPOCH: 40 Train: Time 0.040 (0.043), Loss 0.4861 (0.3292)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 87.500 (87.500), Prec@5 95.312 (95.312)
11/16 10:38 EPOCH: 40 Val: Prec@1 73.300 Prec@5 97.820
11/16 10:38 many acc 74.66, med acc 67.85, few acc 0.00
Best Prec@1: 73.300

Epoch: [41/200][0/194], Time 0.148 (0.148), Loss 0.4395 (0.4395)
11/16 10:39 EPOCH: 41 Train: Time 0.040 (0.043), Loss 0.2627 (0.3314)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_40.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_40.png
11/16 10:39 Loss:2.653, Acc:0.89, NC1:4.141,
Wnorm:[1.679,1.641,1.387,1.140,1.183,1.049,1.003,0.935,0.955,0.872]
Hnorm:[3.543,5.193,3.294,3.503,3.274,3.719,3.238,5.686,6.644,4.304]
Wcos:[-0.167,-0.144,-0.139,-0.097,-0.097,-0.076,-0.083,-0.066,-0.092,-0.078]
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 84.375 (84.375), Prec@5 93.750 (93.750)
11/16 10:39 EPOCH: 41 Val: Prec@1 73.070 Prec@5 97.850
11/16 10:39 many acc 72.01, med acc 77.30, few acc 0.00
Best Prec@1: 73.300

Epoch: [42/200][0/194], Time 0.161 (0.161), Loss 0.2720 (0.2720)
11/16 10:39 EPOCH: 42 Train: Time 0.040 (0.043), Loss 0.3508 (0.3180)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/16 10:39 EPOCH: 42 Val: Prec@1 73.440 Prec@5 97.510
11/16 10:39 many acc 74.50, med acc 69.20, few acc 0.00
Best Prec@1: 73.440

Epoch: [43/200][0/194], Time 0.144 (0.144), Loss 0.3964 (0.3964)
11/16 10:39 EPOCH: 43 Train: Time 0.040 (0.043), Loss 0.2708 (0.3131)
===> Calculating KNN centroids.
Test: [0/157], Time 0.116 (0.116), Prec@1 82.812 (82.812), Prec@5 93.750 (93.750)
11/16 10:39 EPOCH: 43 Val: Prec@1 71.390 Prec@5 96.860
11/16 10:39 many acc 68.90, med acc 81.35, few acc 0.00
Best Prec@1: 73.440

Epoch: [44/200][0/194], Time 0.141 (0.141), Loss 0.1936 (0.1936)
11/16 10:40 EPOCH: 44 Train: Time 0.040 (0.043), Loss 0.4015 (0.3088)
===> Calculating KNN centroids.
Test: [0/157], Time 0.112 (0.112), Prec@1 84.375 (84.375), Prec@5 96.875 (96.875)
11/16 10:40 EPOCH: 44 Val: Prec@1 70.560 Prec@5 97.760
11/16 10:40 many acc 72.36, med acc 63.35, few acc 0.00
Best Prec@1: 73.440

Epoch: [45/200][0/194], Time 0.139 (0.139), Loss 0.2428 (0.2428)
11/16 10:40 EPOCH: 45 Train: Time 0.040 (0.043), Loss 0.4406 (0.3106)
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 81.250 (81.250), Prec@5 93.750 (93.750)
11/16 10:40 EPOCH: 45 Val: Prec@1 71.990 Prec@5 97.500
11/16 10:40 many acc 75.65, med acc 57.35, few acc 0.00
Best Prec@1: 73.440

Epoch: [46/200][0/194], Time 0.132 (0.132), Loss 0.2430 (0.2430)
11/16 10:40 EPOCH: 46 Train: Time 0.041 (0.043), Loss 0.2222 (0.3048)
===> Calculating KNN centroids.
Test: [0/157], Time 0.109 (0.109), Prec@1 76.562 (76.562), Prec@5 93.750 (93.750)
11/16 10:40 EPOCH: 46 Val: Prec@1 73.060 Prec@5 97.300
11/16 10:40 many acc 73.11, med acc 72.85, few acc 0.00
Best Prec@1: 73.440

Epoch: [47/200][0/194], Time 0.128 (0.128), Loss 0.2892 (0.2892)
11/16 10:40 EPOCH: 47 Train: Time 0.040 (0.043), Loss 0.2033 (0.3051)
===> Calculating KNN centroids.
Test: [0/157], Time 0.112 (0.112), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/16 10:41 EPOCH: 47 Val: Prec@1 71.290 Prec@5 97.720
11/16 10:41 many acc 72.19, med acc 67.70, few acc 0.00
Best Prec@1: 73.440

Epoch: [48/200][0/194], Time 0.134 (0.134), Loss 0.2353 (0.2353)
11/16 10:41 EPOCH: 48 Train: Time 0.040 (0.043), Loss 0.3651 (0.3028)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 82.812 (82.812), Prec@5 93.750 (93.750)
11/16 10:41 EPOCH: 48 Val: Prec@1 72.350 Prec@5 97.560
11/16 10:41 many acc 73.83, med acc 66.45, few acc 0.00
Best Prec@1: 73.440

Epoch: [49/200][0/194], Time 0.145 (0.145), Loss 0.3163 (0.3163)
11/16 10:41 EPOCH: 49 Train: Time 0.040 (0.043), Loss 0.3330 (0.2939)
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 81.250 (81.250), Prec@5 96.875 (96.875)
11/16 10:41 EPOCH: 49 Val: Prec@1 74.520 Prec@5 97.830
11/16 10:41 many acc 74.89, med acc 73.05, few acc 0.00
Best Prec@1: 74.520

Epoch: [50/200][0/194], Time 0.127 (0.127), Loss 0.1850 (0.1850)
11/16 10:41 EPOCH: 50 Train: Time 0.040 (0.043), Loss 0.2043 (0.2936)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/16 10:41 EPOCH: 50 Val: Prec@1 69.660 Prec@5 97.300
11/16 10:41 many acc 70.47, med acc 66.40, few acc 0.00
Best Prec@1: 74.520

Epoch: [51/200][0/194], Time 0.143 (0.143), Loss 0.2986 (0.2986)
11/16 10:42 EPOCH: 51 Train: Time 0.040 (0.043), Loss 0.4033 (0.2799)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_50.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_50.png
11/16 10:42 Loss:2.509, Acc:0.90, NC1:3.726,
Wnorm:[1.683,1.641,1.393,1.150,1.190,1.062,1.040,0.949,0.939,0.868]
Hnorm:[3.449,4.656,3.571,3.166,3.695,3.434,5.741,4.619,3.308,5.504]
Wcos:[-0.165,-0.145,-0.140,-0.096,-0.099,-0.077,-0.087,-0.066,-0.090,-0.076]
===> Calculating KNN centroids.
Test: [0/157], Time 0.117 (0.117), Prec@1 79.688 (79.688), Prec@5 92.188 (92.188)
11/16 10:42 EPOCH: 51 Val: Prec@1 70.890 Prec@5 97.160
11/16 10:42 many acc 75.86, med acc 51.00, few acc 0.00
Best Prec@1: 74.520

Epoch: [52/200][0/194], Time 0.139 (0.139), Loss 0.2873 (0.2873)
11/16 10:42 EPOCH: 52 Train: Time 0.041 (0.043), Loss 0.2385 (0.2866)
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 62.500 (62.500), Prec@5 95.312 (95.312)
11/16 10:42 EPOCH: 52 Val: Prec@1 71.020 Prec@5 96.510
11/16 10:42 many acc 71.86, med acc 67.65, few acc 0.00
Best Prec@1: 74.520

Epoch: [53/200][0/194], Time 0.145 (0.145), Loss 0.2887 (0.2887)
11/16 10:42 EPOCH: 53 Train: Time 0.040 (0.043), Loss 0.2857 (0.2937)
===> Calculating KNN centroids.
Test: [0/157], Time 0.116 (0.116), Prec@1 76.562 (76.562), Prec@5 98.438 (98.438)
11/16 10:42 EPOCH: 53 Val: Prec@1 73.450 Prec@5 97.890
11/16 10:42 many acc 72.40, med acc 77.65, few acc 0.00
Best Prec@1: 74.520

Epoch: [54/200][0/194], Time 0.146 (0.146), Loss 0.2638 (0.2638)
11/16 10:43 EPOCH: 54 Train: Time 0.040 (0.043), Loss 0.2513 (0.2716)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 78.125 (78.125), Prec@5 96.875 (96.875)
11/16 10:43 EPOCH: 54 Val: Prec@1 72.530 Prec@5 97.920
11/16 10:43 many acc 71.68, med acc 75.95, few acc 0.00
Best Prec@1: 74.520

Epoch: [55/200][0/194], Time 0.132 (0.132), Loss 0.1988 (0.1988)
11/16 10:43 EPOCH: 55 Train: Time 0.040 (0.043), Loss 0.0962 (0.2824)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 78.125 (78.125), Prec@5 93.750 (93.750)
11/16 10:43 EPOCH: 55 Val: Prec@1 70.950 Prec@5 96.890
11/16 10:43 many acc 71.79, med acc 67.60, few acc 0.00
Best Prec@1: 74.520

Epoch: [56/200][0/194], Time 0.128 (0.128), Loss 0.1399 (0.1399)
11/16 10:43 EPOCH: 56 Train: Time 0.040 (0.043), Loss 0.4649 (0.2770)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 71.875 (71.875), Prec@5 95.312 (95.312)
11/16 10:43 EPOCH: 56 Val: Prec@1 70.820 Prec@5 97.660
11/16 10:43 many acc 70.25, med acc 73.10, few acc 0.00
Best Prec@1: 74.520

Epoch: [57/200][0/194], Time 0.128 (0.128), Loss 0.2008 (0.2008)
11/16 10:43 EPOCH: 57 Train: Time 0.040 (0.043), Loss 0.3200 (0.2751)
===> Calculating KNN centroids.
Test: [0/157], Time 0.101 (0.101), Prec@1 87.500 (87.500), Prec@5 93.750 (93.750)
11/16 10:44 EPOCH: 57 Val: Prec@1 70.820 Prec@5 96.870
11/16 10:44 many acc 71.60, med acc 67.70, few acc 0.00
Best Prec@1: 74.520

Epoch: [58/200][0/194], Time 0.154 (0.154), Loss 0.2737 (0.2737)
11/16 10:44 EPOCH: 58 Train: Time 0.040 (0.043), Loss 0.3020 (0.2805)
===> Calculating KNN centroids.
Test: [0/157], Time 0.098 (0.098), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/16 10:44 EPOCH: 58 Val: Prec@1 72.050 Prec@5 97.430
11/16 10:44 many acc 72.80, med acc 69.05, few acc 0.00
Best Prec@1: 74.520

Epoch: [59/200][0/194], Time 0.140 (0.140), Loss 0.1663 (0.1663)
11/16 10:44 EPOCH: 59 Train: Time 0.040 (0.043), Loss 0.4631 (0.2747)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 92.188 (92.188), Prec@5 95.312 (95.312)
11/16 10:44 EPOCH: 59 Val: Prec@1 75.280 Prec@5 97.930
11/16 10:44 many acc 75.65, med acc 73.80, few acc 0.00
Best Prec@1: 75.280

Epoch: [60/200][0/194], Time 0.136 (0.136), Loss 0.3488 (0.3488)
11/16 10:44 EPOCH: 60 Train: Time 0.040 (0.043), Loss 0.4454 (0.2600)
===> Calculating KNN centroids.
Test: [0/157], Time 0.114 (0.114), Prec@1 73.438 (73.438), Prec@5 95.312 (95.312)
11/16 10:44 EPOCH: 60 Val: Prec@1 73.100 Prec@5 97.590
11/16 10:44 many acc 71.64, med acc 78.95, few acc 0.00
Best Prec@1: 75.280

Epoch: [61/200][0/194], Time 0.136 (0.136), Loss 0.3090 (0.3090)
11/16 10:45 EPOCH: 61 Train: Time 0.040 (0.043), Loss 0.5189 (0.2646)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_60.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_60.png
11/16 10:45 Loss:2.747, Acc:0.88, NC1:3.133,
Wnorm:[1.692,1.632,1.398,1.167,1.179,1.046,1.016,0.944,0.935,0.839]
Hnorm:[3.547,4.639,3.384,2.403,3.291,3.553,4.760,5.342,6.486,3.425]
Wcos:[-0.167,-0.145,-0.141,-0.100,-0.097,-0.075,-0.086,-0.067,-0.086,-0.071]
===> Calculating KNN centroids.
Test: [0/157], Time 0.114 (0.114), Prec@1 85.938 (85.938), Prec@5 90.625 (90.625)
11/16 10:45 EPOCH: 61 Val: Prec@1 72.950 Prec@5 97.520
11/16 10:45 many acc 76.25, med acc 59.75, few acc 0.00
Best Prec@1: 75.280

Epoch: [62/200][0/194], Time 0.151 (0.151), Loss 0.3174 (0.3174)
11/16 10:45 EPOCH: 62 Train: Time 0.040 (0.043), Loss 0.4254 (0.2591)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 78.125 (78.125), Prec@5 95.312 (95.312)
11/16 10:45 EPOCH: 62 Val: Prec@1 72.780 Prec@5 97.560
11/16 10:45 many acc 73.19, med acc 71.15, few acc 0.00
Best Prec@1: 75.280

Epoch: [63/200][0/194], Time 0.137 (0.137), Loss 0.5273 (0.5273)
11/16 10:45 EPOCH: 63 Train: Time 0.040 (0.043), Loss 0.2407 (0.2551)
===> Calculating KNN centroids.
Test: [0/157], Time 0.101 (0.101), Prec@1 89.062 (89.062), Prec@5 98.438 (98.438)
11/16 10:45 EPOCH: 63 Val: Prec@1 70.980 Prec@5 97.560
11/16 10:45 many acc 72.29, med acc 65.75, few acc 0.00
Best Prec@1: 75.280

Epoch: [64/200][0/194], Time 0.144 (0.144), Loss 0.3075 (0.3075)
11/16 10:46 EPOCH: 64 Train: Time 0.040 (0.043), Loss 0.1615 (0.2541)
===> Calculating KNN centroids.
Test: [0/157], Time 0.101 (0.101), Prec@1 90.625 (90.625), Prec@5 95.312 (95.312)
11/16 10:46 EPOCH: 64 Val: Prec@1 73.340 Prec@5 98.010
11/16 10:46 many acc 75.36, med acc 65.25, few acc 0.00
Best Prec@1: 75.280

Epoch: [65/200][0/194], Time 0.143 (0.143), Loss 0.1003 (0.1003)
11/16 10:46 EPOCH: 65 Train: Time 0.040 (0.043), Loss 0.3300 (0.2464)
===> Calculating KNN centroids.
Test: [0/157], Time 0.117 (0.117), Prec@1 85.938 (85.938), Prec@5 95.312 (95.312)
11/16 10:46 EPOCH: 65 Val: Prec@1 73.970 Prec@5 98.350
11/16 10:46 many acc 75.29, med acc 68.70, few acc 0.00
Best Prec@1: 75.280

Epoch: [66/200][0/194], Time 0.136 (0.136), Loss 0.1786 (0.1786)
11/16 10:46 EPOCH: 66 Train: Time 0.040 (0.043), Loss 0.3049 (0.2484)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 75.000 (75.000), Prec@5 98.438 (98.438)
11/16 10:46 EPOCH: 66 Val: Prec@1 72.120 Prec@5 97.810
11/16 10:46 many acc 69.85, med acc 81.20, few acc 0.00
Best Prec@1: 75.280

Epoch: [67/200][0/194], Time 0.151 (0.151), Loss 0.1867 (0.1867)
11/16 10:46 EPOCH: 67 Train: Time 0.040 (0.043), Loss 0.1520 (0.2482)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 87.500 (87.500), Prec@5 95.312 (95.312)
11/16 10:47 EPOCH: 67 Val: Prec@1 72.110 Prec@5 97.090
11/16 10:47 many acc 73.09, med acc 68.20, few acc 0.00
Best Prec@1: 75.280

Epoch: [68/200][0/194], Time 0.145 (0.145), Loss 0.1736 (0.1736)
11/16 10:47 EPOCH: 68 Train: Time 0.040 (0.043), Loss 0.2301 (0.2513)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 79.688 (79.688), Prec@5 96.875 (96.875)
11/16 10:47 EPOCH: 68 Val: Prec@1 71.180 Prec@5 96.950
11/16 10:47 many acc 69.61, med acc 77.45, few acc 0.00
Best Prec@1: 75.280

Epoch: [69/200][0/194], Time 0.143 (0.143), Loss 0.1867 (0.1867)
11/16 10:47 EPOCH: 69 Train: Time 0.040 (0.043), Loss 0.3129 (0.2343)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 90.625 (90.625), Prec@5 95.312 (95.312)
11/16 10:47 EPOCH: 69 Val: Prec@1 74.170 Prec@5 97.560
11/16 10:47 many acc 73.53, med acc 76.75, few acc 0.00
Best Prec@1: 75.280

Epoch: [70/200][0/194], Time 0.139 (0.139), Loss 0.2064 (0.2064)
11/16 10:47 EPOCH: 70 Train: Time 0.041 (0.043), Loss 0.2226 (0.2380)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 76.562 (76.562), Prec@5 98.438 (98.438)
11/16 10:47 EPOCH: 70 Val: Prec@1 72.300 Prec@5 96.760
11/16 10:47 many acc 73.89, med acc 65.95, few acc 0.00
Best Prec@1: 75.280

Epoch: [71/200][0/194], Time 0.135 (0.135), Loss 0.2789 (0.2789)
11/16 10:48 EPOCH: 71 Train: Time 0.040 (0.043), Loss 0.2785 (0.2314)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_70.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_70.png
11/16 10:48 Loss:2.134, Acc:0.91, NC1:2.683,
Wnorm:[1.707,1.612,1.379,1.179,1.187,1.042,1.028,0.956,0.928,0.826]
Hnorm:[4.150,4.918,4.213,3.995,4.848,3.252,6.733,5.632,8.661,8.118]
Wcos:[-0.168,-0.142,-0.139,-0.101,-0.099,-0.077,-0.085,-0.068,-0.086,-0.070]
===> Calculating KNN centroids.
Test: [0/157], Time 0.090 (0.090), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/16 10:48 EPOCH: 71 Val: Prec@1 73.550 Prec@5 97.530
11/16 10:48 many acc 74.38, med acc 70.25, few acc 0.00
Best Prec@1: 75.280

Epoch: [72/200][0/194], Time 0.136 (0.136), Loss 0.1969 (0.1969)
11/16 10:48 EPOCH: 72 Train: Time 0.040 (0.043), Loss 0.3418 (0.2300)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 81.250 (81.250), Prec@5 96.875 (96.875)
11/16 10:48 EPOCH: 72 Val: Prec@1 73.510 Prec@5 97.070
11/16 10:48 many acc 71.86, med acc 80.10, few acc 0.00
Best Prec@1: 75.280

Epoch: [73/200][0/194], Time 0.138 (0.138), Loss 0.2606 (0.2606)
11/16 10:48 EPOCH: 73 Train: Time 0.040 (0.043), Loss 0.3967 (0.2381)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 84.375 (84.375), Prec@5 96.875 (96.875)
11/16 10:48 EPOCH: 73 Val: Prec@1 73.350 Prec@5 97.640
11/16 10:48 many acc 72.64, med acc 76.20, few acc 0.00
Best Prec@1: 75.280

Epoch: [74/200][0/194], Time 0.144 (0.144), Loss 0.2907 (0.2907)
11/16 10:49 EPOCH: 74 Train: Time 0.040 (0.043), Loss 0.1155 (0.2290)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/16 10:49 EPOCH: 74 Val: Prec@1 76.490 Prec@5 98.210
11/16 10:49 many acc 74.74, med acc 83.50, few acc 0.00
Best Prec@1: 76.490

Epoch: [75/200][0/194], Time 0.153 (0.153), Loss 0.1868 (0.1868)
11/16 10:49 EPOCH: 75 Train: Time 0.040 (0.043), Loss 0.4098 (0.2221)
===> Calculating KNN centroids.
Test: [0/157], Time 0.107 (0.107), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/16 10:49 EPOCH: 75 Val: Prec@1 73.380 Prec@5 97.900
11/16 10:49 many acc 74.08, med acc 70.60, few acc 0.00
Best Prec@1: 76.490

Epoch: [76/200][0/194], Time 0.145 (0.145), Loss 0.1384 (0.1384)
11/16 10:49 EPOCH: 76 Train: Time 0.040 (0.043), Loss 0.1278 (0.2267)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 82.812 (82.812), Prec@5 98.438 (98.438)
11/16 10:49 EPOCH: 76 Val: Prec@1 75.860 Prec@5 98.000
11/16 10:49 many acc 75.67, med acc 76.60, few acc 0.00
Best Prec@1: 76.490

Epoch: [77/200][0/194], Time 0.143 (0.143), Loss 0.1146 (0.1146)
11/16 10:49 EPOCH: 77 Train: Time 0.040 (0.043), Loss 0.1085 (0.2230)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 84.375 (84.375), Prec@5 96.875 (96.875)
11/16 10:50 EPOCH: 77 Val: Prec@1 67.880 Prec@5 96.410
11/16 10:50 many acc 71.88, med acc 51.90, few acc 0.00
Best Prec@1: 76.490

Epoch: [78/200][0/194], Time 0.143 (0.143), Loss 0.2508 (0.2508)
11/16 10:50 EPOCH: 78 Train: Time 0.040 (0.043), Loss 0.3465 (0.2275)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 85.938 (85.938), Prec@5 93.750 (93.750)
11/16 10:50 EPOCH: 78 Val: Prec@1 73.320 Prec@5 98.010
11/16 10:50 many acc 78.53, med acc 52.50, few acc 0.00
Best Prec@1: 76.490

Epoch: [79/200][0/194], Time 0.158 (0.158), Loss 0.3553 (0.3553)
11/16 10:50 EPOCH: 79 Train: Time 0.040 (0.043), Loss 0.3427 (0.2072)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 90.625 (90.625), Prec@5 100.000 (100.000)
11/16 10:50 EPOCH: 79 Val: Prec@1 76.360 Prec@5 98.250
11/16 10:50 many acc 74.85, med acc 82.40, few acc 0.00
Best Prec@1: 76.490

Epoch: [80/200][0/194], Time 0.139 (0.139), Loss 0.0950 (0.0950)
11/16 10:50 EPOCH: 80 Train: Time 0.040 (0.043), Loss 0.3854 (0.2138)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/16 10:50 EPOCH: 80 Val: Prec@1 72.930 Prec@5 97.790
11/16 10:50 many acc 78.76, med acc 49.60, few acc 0.00
Best Prec@1: 76.490

Epoch: [81/200][0/194], Time 0.140 (0.140), Loss 0.1555 (0.1555)
11/16 10:51 EPOCH: 81 Train: Time 0.040 (0.043), Loss 0.4687 (0.2021)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_80.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_80.png
11/16 10:51 Loss:1.802, Acc:0.93, NC1:2.246,
Wnorm:[1.703,1.620,1.409,1.205,1.199,1.053,1.025,0.941,0.913,0.812]
Hnorm:[4.247,5.027,4.176,3.303,5.113,3.808,6.603,9.080,9.023,4.349]
Wcos:[-0.168,-0.143,-0.143,-0.104,-0.100,-0.078,-0.085,-0.067,-0.081,-0.064]
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 82.812 (82.812), Prec@5 93.750 (93.750)
11/16 10:51 EPOCH: 81 Val: Prec@1 73.680 Prec@5 97.850
11/16 10:51 many acc 76.56, med acc 62.15, few acc 0.00
Best Prec@1: 76.490

Epoch: [82/200][0/194], Time 0.135 (0.135), Loss 0.0948 (0.0948)
11/16 10:51 EPOCH: 82 Train: Time 0.040 (0.043), Loss 0.2136 (0.2070)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 79.688 (79.688), Prec@5 95.312 (95.312)
11/16 10:51 EPOCH: 82 Val: Prec@1 74.010 Prec@5 97.010
11/16 10:51 many acc 76.69, med acc 63.30, few acc 0.00
Best Prec@1: 76.490

Epoch: [83/200][0/194], Time 0.141 (0.141), Loss 0.1796 (0.1796)
11/16 10:51 EPOCH: 83 Train: Time 0.040 (0.043), Loss 0.1991 (0.1963)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/16 10:51 EPOCH: 83 Val: Prec@1 73.220 Prec@5 97.900
11/16 10:51 many acc 74.40, med acc 68.50, few acc 0.00
Best Prec@1: 76.490

Epoch: [84/200][0/194], Time 0.145 (0.145), Loss 0.2702 (0.2702)
11/16 10:52 EPOCH: 84 Train: Time 0.041 (0.043), Loss 0.2945 (0.2020)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/16 10:52 EPOCH: 84 Val: Prec@1 71.700 Prec@5 98.060
11/16 10:52 many acc 76.48, med acc 52.60, few acc 0.00
Best Prec@1: 76.490

Epoch: [85/200][0/194], Time 0.143 (0.143), Loss 0.0705 (0.0705)
11/16 10:52 EPOCH: 85 Train: Time 0.040 (0.043), Loss 0.2736 (0.2015)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 78.125 (78.125), Prec@5 93.750 (93.750)
11/16 10:52 EPOCH: 85 Val: Prec@1 72.050 Prec@5 97.050
11/16 10:52 many acc 71.05, med acc 76.05, few acc 0.00
Best Prec@1: 76.490

Epoch: [86/200][0/194], Time 0.147 (0.147), Loss 0.1553 (0.1553)
11/16 10:52 EPOCH: 86 Train: Time 0.041 (0.043), Loss 0.2506 (0.1976)
===> Calculating KNN centroids.
Test: [0/157], Time 0.116 (0.116), Prec@1 87.500 (87.500), Prec@5 95.312 (95.312)
11/16 10:52 EPOCH: 86 Val: Prec@1 77.250 Prec@5 98.280
11/16 10:52 many acc 75.76, med acc 83.20, few acc 0.00
Best Prec@1: 77.250

Epoch: [87/200][0/194], Time 0.147 (0.147), Loss 0.0734 (0.0734)
11/16 10:52 EPOCH: 87 Train: Time 0.040 (0.043), Loss 0.2138 (0.1969)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 89.062 (89.062), Prec@5 90.625 (90.625)
11/16 10:53 EPOCH: 87 Val: Prec@1 62.020 Prec@5 95.770
11/16 10:53 many acc 69.90, med acc 30.50, few acc 0.00
Best Prec@1: 77.250

Epoch: [88/200][0/194], Time 0.143 (0.143), Loss 0.2197 (0.2197)
11/16 10:53 EPOCH: 88 Train: Time 0.040 (0.043), Loss 0.0360 (0.1950)
===> Calculating KNN centroids.
Test: [0/157], Time 0.100 (0.100), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/16 10:53 EPOCH: 88 Val: Prec@1 76.660 Prec@5 98.210
11/16 10:53 many acc 76.34, med acc 77.95, few acc 0.00
Best Prec@1: 77.250

Epoch: [89/200][0/194], Time 0.139 (0.139), Loss 0.1349 (0.1349)
11/16 10:53 EPOCH: 89 Train: Time 0.040 (0.043), Loss 0.1573 (0.1753)
===> Calculating KNN centroids.
Test: [0/157], Time 0.116 (0.116), Prec@1 82.812 (82.812), Prec@5 93.750 (93.750)
11/16 10:53 EPOCH: 89 Val: Prec@1 74.890 Prec@5 97.840
11/16 10:53 many acc 77.14, med acc 65.90, few acc 0.00
Best Prec@1: 77.250

Epoch: [90/200][0/194], Time 0.135 (0.135), Loss 0.1646 (0.1646)
11/16 10:53 EPOCH: 90 Train: Time 0.040 (0.043), Loss 0.3421 (0.1889)
===> Calculating KNN centroids.
Test: [0/157], Time 0.107 (0.107), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 10:53 EPOCH: 90 Val: Prec@1 74.430 Prec@5 98.330
11/16 10:53 many acc 78.61, med acc 57.70, few acc 0.00
Best Prec@1: 77.250

Epoch: [91/200][0/194], Time 0.139 (0.139), Loss 0.0614 (0.0614)
11/16 10:54 EPOCH: 91 Train: Time 0.040 (0.043), Loss 0.3488 (0.1870)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_90.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_90.png
11/16 10:54 Loss:1.854, Acc:0.91, NC1:2.389,
Wnorm:[1.707,1.599,1.422,1.215,1.180,1.051,1.023,0.922,0.896,0.813]
Hnorm:[3.732,4.525,4.135,4.448,3.794,4.692,6.240,6.597,8.396,6.745]
Wcos:[-0.168,-0.142,-0.145,-0.108,-0.099,-0.078,-0.083,-0.064,-0.076,-0.063]
===> Calculating KNN centroids.
Test: [0/157], Time 0.107 (0.107), Prec@1 85.938 (85.938), Prec@5 98.438 (98.438)
11/16 10:54 EPOCH: 91 Val: Prec@1 76.130 Prec@5 98.060
11/16 10:54 many acc 77.29, med acc 71.50, few acc 0.00
Best Prec@1: 77.250

Epoch: [92/200][0/194], Time 0.125 (0.125), Loss 0.1733 (0.1733)
11/16 10:54 EPOCH: 92 Train: Time 0.040 (0.043), Loss 0.2926 (0.1803)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 93.750 (93.750), Prec@5 100.000 (100.000)
11/16 10:54 EPOCH: 92 Val: Prec@1 74.630 Prec@5 98.120
11/16 10:54 many acc 76.60, med acc 66.75, few acc 0.00
Best Prec@1: 77.250

Epoch: [93/200][0/194], Time 0.143 (0.143), Loss 0.1974 (0.1974)
11/16 10:54 EPOCH: 93 Train: Time 0.040 (0.043), Loss 0.1602 (0.1808)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/16 10:54 EPOCH: 93 Val: Prec@1 74.470 Prec@5 97.610
11/16 10:54 many acc 76.46, med acc 66.50, few acc 0.00
Best Prec@1: 77.250

Epoch: [94/200][0/194], Time 0.128 (0.128), Loss 0.0962 (0.0962)
11/16 10:55 EPOCH: 94 Train: Time 0.041 (0.043), Loss 0.2663 (0.1729)
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 85.938 (85.938), Prec@5 95.312 (95.312)
11/16 10:55 EPOCH: 94 Val: Prec@1 74.550 Prec@5 98.060
11/16 10:55 many acc 75.89, med acc 69.20, few acc 0.00
Best Prec@1: 77.250

Epoch: [95/200][0/194], Time 0.141 (0.141), Loss 0.2565 (0.2565)
11/16 10:55 EPOCH: 95 Train: Time 0.040 (0.043), Loss 0.0863 (0.1726)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/16 10:55 EPOCH: 95 Val: Prec@1 75.780 Prec@5 98.080
11/16 10:55 many acc 77.74, med acc 67.95, few acc 0.00
Best Prec@1: 77.250

Epoch: [96/200][0/194], Time 0.142 (0.142), Loss 0.0930 (0.0930)
11/16 10:55 EPOCH: 96 Train: Time 0.040 (0.043), Loss 0.1392 (0.1594)
===> Calculating KNN centroids.
Test: [0/157], Time 0.114 (0.114), Prec@1 85.938 (85.938), Prec@5 98.438 (98.438)
11/16 10:55 EPOCH: 96 Val: Prec@1 74.590 Prec@5 98.140
11/16 10:55 many acc 74.02, med acc 76.85, few acc 0.00
Best Prec@1: 77.250

Epoch: [97/200][0/194], Time 0.143 (0.143), Loss 0.0573 (0.0573)
11/16 10:55 EPOCH: 97 Train: Time 0.041 (0.043), Loss 0.1136 (0.1754)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 85.938 (85.938), Prec@5 95.312 (95.312)
11/16 10:56 EPOCH: 97 Val: Prec@1 75.070 Prec@5 98.100
11/16 10:56 many acc 77.92, med acc 63.65, few acc 0.00
Best Prec@1: 77.250

Epoch: [98/200][0/194], Time 0.126 (0.126), Loss 0.0572 (0.0572)
11/16 10:56 EPOCH: 98 Train: Time 0.040 (0.043), Loss 0.1142 (0.1564)
===> Calculating KNN centroids.
Test: [0/157], Time 0.118 (0.118), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/16 10:56 EPOCH: 98 Val: Prec@1 76.820 Prec@5 98.150
11/16 10:56 many acc 76.01, med acc 80.05, few acc 0.00
Best Prec@1: 77.250

Epoch: [99/200][0/194], Time 0.140 (0.140), Loss 0.1241 (0.1241)
11/16 10:56 EPOCH: 99 Train: Time 0.041 (0.043), Loss 0.1884 (0.1643)
===> Calculating KNN centroids.
Test: [0/157], Time 0.094 (0.094), Prec@1 92.188 (92.188), Prec@5 96.875 (96.875)
11/16 10:56 EPOCH: 99 Val: Prec@1 72.350 Prec@5 97.390
11/16 10:56 many acc 73.44, med acc 68.00, few acc 0.00
Best Prec@1: 77.250

Epoch: [100/200][0/194], Time 0.139 (0.139), Loss 0.2497 (0.2497)
11/16 10:56 EPOCH: 100 Train: Time 0.040 (0.043), Loss 0.1304 (0.1499)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 92.188 (92.188), Prec@5 100.000 (100.000)
11/16 10:56 EPOCH: 100 Val: Prec@1 76.160 Prec@5 98.240
11/16 10:56 many acc 79.30, med acc 63.60, few acc 0.00
Best Prec@1: 77.250

Epoch: [101/200][0/194], Time 0.145 (0.145), Loss 0.0978 (0.0978)
11/16 10:57 EPOCH: 101 Train: Time 0.040 (0.043), Loss 0.1512 (0.1490)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_100.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_100.png
11/16 10:57 Loss:1.952, Acc:0.92, NC1:2.244,
Wnorm:[1.721,1.602,1.422,1.226,1.192,1.060,1.024,0.925,0.876,0.805]
Hnorm:[3.818,4.408,4.215,3.744,5.006,4.259,5.803,5.129,3.887,5.488]
Wcos:[-0.169,-0.142,-0.143,-0.109,-0.100,-0.081,-0.084,-0.065,-0.072,-0.060]
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 82.812 (82.812), Prec@5 90.625 (90.625)
11/16 10:57 EPOCH: 101 Val: Prec@1 68.530 Prec@5 96.530
11/16 10:57 many acc 76.28, med acc 37.55, few acc 0.00
Best Prec@1: 77.250

Epoch: [102/200][0/194], Time 0.136 (0.136), Loss 0.0656 (0.0656)
11/16 10:57 EPOCH: 102 Train: Time 0.041 (0.043), Loss 0.2950 (0.1603)
===> Calculating KNN centroids.
Test: [0/157], Time 0.107 (0.107), Prec@1 85.938 (85.938), Prec@5 98.438 (98.438)
11/16 10:57 EPOCH: 102 Val: Prec@1 76.160 Prec@5 98.430
11/16 10:57 many acc 79.54, med acc 62.65, few acc 0.00
Best Prec@1: 77.250

Epoch: [103/200][0/194], Time 0.146 (0.146), Loss 0.1138 (0.1138)
11/16 10:57 EPOCH: 103 Train: Time 0.041 (0.043), Loss 0.2689 (0.1491)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/16 10:57 EPOCH: 103 Val: Prec@1 74.250 Prec@5 98.110
11/16 10:57 many acc 76.03, med acc 67.15, few acc 0.00
Best Prec@1: 77.250

Epoch: [104/200][0/194], Time 0.146 (0.146), Loss 0.0735 (0.0735)
11/16 10:58 EPOCH: 104 Train: Time 0.040 (0.043), Loss 0.1678 (0.1466)
===> Calculating KNN centroids.
Test: [0/157], Time 0.098 (0.098), Prec@1 89.062 (89.062), Prec@5 98.438 (98.438)
11/16 10:58 EPOCH: 104 Val: Prec@1 70.040 Prec@5 97.580
11/16 10:58 many acc 70.71, med acc 67.35, few acc 0.00
Best Prec@1: 77.250

Epoch: [105/200][0/194], Time 0.132 (0.132), Loss 0.2546 (0.2546)
11/16 10:58 EPOCH: 105 Train: Time 0.040 (0.043), Loss 0.0796 (0.1488)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 87.500 (87.500), Prec@5 98.438 (98.438)
11/16 10:58 EPOCH: 105 Val: Prec@1 76.400 Prec@5 98.230
11/16 10:58 many acc 78.07, med acc 69.70, few acc 0.00
Best Prec@1: 77.250

Epoch: [106/200][0/194], Time 0.144 (0.144), Loss 0.0953 (0.0953)
11/16 10:58 EPOCH: 106 Train: Time 0.040 (0.043), Loss 0.1766 (0.1295)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 84.375 (84.375), Prec@5 93.750 (93.750)
11/16 10:58 EPOCH: 106 Val: Prec@1 74.320 Prec@5 97.830
11/16 10:58 many acc 75.04, med acc 71.45, few acc 0.00
Best Prec@1: 77.250

Epoch: [107/200][0/194], Time 0.153 (0.153), Loss 0.0511 (0.0511)
11/16 10:58 EPOCH: 107 Train: Time 0.040 (0.043), Loss 0.0945 (0.1474)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/16 10:59 EPOCH: 107 Val: Prec@1 77.190 Prec@5 98.270
11/16 10:59 many acc 78.21, med acc 73.10, few acc 0.00
Best Prec@1: 77.250

Epoch: [108/200][0/194], Time 0.135 (0.135), Loss 0.1511 (0.1511)
11/16 10:59 EPOCH: 108 Train: Time 0.040 (0.043), Loss 0.0558 (0.1473)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 92.188 (92.188), Prec@5 96.875 (96.875)
11/16 10:59 EPOCH: 108 Val: Prec@1 74.360 Prec@5 97.990
11/16 10:59 many acc 79.24, med acc 54.85, few acc 0.00
Best Prec@1: 77.250

Epoch: [109/200][0/194], Time 0.138 (0.138), Loss 0.0816 (0.0816)
11/16 10:59 EPOCH: 109 Train: Time 0.040 (0.043), Loss 0.1866 (0.1331)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 85.938 (85.938), Prec@5 93.750 (93.750)
11/16 10:59 EPOCH: 109 Val: Prec@1 75.260 Prec@5 98.050
11/16 10:59 many acc 76.93, med acc 68.60, few acc 0.00
Best Prec@1: 77.250

Epoch: [110/200][0/194], Time 0.140 (0.140), Loss 0.1663 (0.1663)
11/16 10:59 EPOCH: 110 Train: Time 0.041 (0.043), Loss 0.0855 (0.1294)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 78.125 (78.125), Prec@5 96.875 (96.875)
11/16 10:59 EPOCH: 110 Val: Prec@1 75.650 Prec@5 98.280
11/16 10:59 many acc 78.51, med acc 64.20, few acc 0.00
Best Prec@1: 77.250

Epoch: [111/200][0/194], Time 0.138 (0.138), Loss 0.1168 (0.1168)
11/16 11:00 EPOCH: 111 Train: Time 0.041 (0.043), Loss 0.3854 (0.1249)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_110.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_110.png
11/16 11:00 Loss:1.277, Acc:0.94, NC1:1.474,
Wnorm:[1.725,1.589,1.409,1.240,1.191,1.056,1.011,0.925,0.869,0.793]
Hnorm:[4.702,4.128,4.261,5.034,5.003,5.625,6.909,5.123,6.796,14.650]
Wcos:[-0.169,-0.143,-0.141,-0.111,-0.100,-0.082,-0.081,-0.066,-0.071,-0.058]
===> Calculating KNN centroids.
Test: [0/157], Time 0.117 (0.117), Prec@1 92.188 (92.188), Prec@5 93.750 (93.750)
11/16 11:00 EPOCH: 111 Val: Prec@1 75.690 Prec@5 98.330
11/16 11:00 many acc 76.25, med acc 73.45, few acc 0.00
Best Prec@1: 77.250

Epoch: [112/200][0/194], Time 0.136 (0.136), Loss 0.1097 (0.1097)
11/16 11:00 EPOCH: 112 Train: Time 0.040 (0.043), Loss 0.0970 (0.1209)
===> Calculating KNN centroids.
Test: [0/157], Time 0.116 (0.116), Prec@1 87.500 (87.500), Prec@5 98.438 (98.438)
11/16 11:00 EPOCH: 112 Val: Prec@1 78.660 Prec@5 98.590
11/16 11:00 many acc 81.23, med acc 68.40, few acc 0.00
Best Prec@1: 78.660

Epoch: [113/200][0/194], Time 0.142 (0.142), Loss 0.0752 (0.0752)
11/16 11:00 EPOCH: 113 Train: Time 0.040 (0.043), Loss 0.0872 (0.1162)
===> Calculating KNN centroids.
Test: [0/157], Time 0.115 (0.115), Prec@1 87.500 (87.500), Prec@5 93.750 (93.750)
11/16 11:00 EPOCH: 113 Val: Prec@1 73.350 Prec@5 98.180
11/16 11:00 many acc 77.59, med acc 56.40, few acc 0.00
Best Prec@1: 78.660

Epoch: [114/200][0/194], Time 0.140 (0.140), Loss 0.0358 (0.0358)
11/16 11:01 EPOCH: 114 Train: Time 0.040 (0.043), Loss 0.1259 (0.1192)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/16 11:01 EPOCH: 114 Val: Prec@1 73.820 Prec@5 97.580
11/16 11:01 many acc 79.84, med acc 49.75, few acc 0.00
Best Prec@1: 78.660

Epoch: [115/200][0/194], Time 0.138 (0.138), Loss 0.0909 (0.0909)
11/16 11:01 EPOCH: 115 Train: Time 0.040 (0.043), Loss 0.0455 (0.1135)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 85.938 (85.938), Prec@5 93.750 (93.750)
11/16 11:01 EPOCH: 115 Val: Prec@1 79.030 Prec@5 98.380
11/16 11:01 many acc 79.46, med acc 77.30, few acc 0.00
Best Prec@1: 79.030

Epoch: [116/200][0/194], Time 0.133 (0.133), Loss 0.0902 (0.0902)
11/16 11:01 EPOCH: 116 Train: Time 0.040 (0.043), Loss 0.1544 (0.1181)
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/16 11:01 EPOCH: 116 Val: Prec@1 76.540 Prec@5 98.420
11/16 11:01 many acc 78.79, med acc 67.55, few acc 0.00
Best Prec@1: 79.030

Epoch: [117/200][0/194], Time 0.145 (0.145), Loss 0.0706 (0.0706)
11/16 11:01 EPOCH: 117 Train: Time 0.040 (0.043), Loss 0.0783 (0.1060)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 85.938 (85.938), Prec@5 96.875 (96.875)
11/16 11:02 EPOCH: 117 Val: Prec@1 74.230 Prec@5 97.950
11/16 11:02 many acc 75.51, med acc 69.10, few acc 0.00
Best Prec@1: 79.030

Epoch: [118/200][0/194], Time 0.140 (0.140), Loss 0.0865 (0.0865)
11/16 11:02 EPOCH: 118 Train: Time 0.040 (0.043), Loss 0.1512 (0.1085)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 82.812 (82.812), Prec@5 93.750 (93.750)
11/16 11:02 EPOCH: 118 Val: Prec@1 78.180 Prec@5 98.420
11/16 11:02 many acc 77.46, med acc 81.05, few acc 0.00
Best Prec@1: 79.030

Epoch: [119/200][0/194], Time 0.138 (0.138), Loss 0.0759 (0.0759)
11/16 11:02 EPOCH: 119 Train: Time 0.040 (0.043), Loss 0.1755 (0.1051)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/16 11:02 EPOCH: 119 Val: Prec@1 76.300 Prec@5 98.140
11/16 11:02 many acc 79.12, med acc 65.00, few acc 0.00
Best Prec@1: 79.030

Epoch: [120/200][0/194], Time 0.135 (0.135), Loss 0.1801 (0.1801)
11/16 11:02 EPOCH: 120 Train: Time 0.040 (0.043), Loss 0.1329 (0.0976)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/16 11:02 EPOCH: 120 Val: Prec@1 72.330 Prec@5 97.790
11/16 11:02 many acc 79.01, med acc 45.60, few acc 0.00
Best Prec@1: 79.030

Epoch: [121/200][0/194], Time 0.139 (0.139), Loss 0.0805 (0.0805)
11/16 11:03 EPOCH: 121 Train: Time 0.040 (0.043), Loss 0.0701 (0.0989)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_120.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_120.png
11/16 11:03 Loss:0.769, Acc:0.97, NC1:1.060,
Wnorm:[1.713,1.575,1.422,1.247,1.190,1.063,1.006,0.911,0.855,0.781]
Hnorm:[3.939,4.489,4.922,4.412,4.972,5.051,5.625,4.128,8.757,12.678]
Wcos:[-0.169,-0.143,-0.142,-0.112,-0.101,-0.084,-0.081,-0.065,-0.069,-0.055]
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 89.062 (89.062), Prec@5 100.000 (100.000)
11/16 11:03 EPOCH: 121 Val: Prec@1 75.970 Prec@5 98.240
11/16 11:03 many acc 76.38, med acc 74.35, few acc 0.00
Best Prec@1: 79.030

Epoch: [122/200][0/194], Time 0.139 (0.139), Loss 0.2275 (0.2275)
11/16 11:03 EPOCH: 122 Train: Time 0.040 (0.043), Loss 0.0893 (0.0987)
===> Calculating KNN centroids.
Test: [0/157], Time 0.097 (0.097), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/16 11:03 EPOCH: 122 Val: Prec@1 74.350 Prec@5 98.160
11/16 11:03 many acc 73.89, med acc 76.20, few acc 0.00
Best Prec@1: 79.030

Epoch: [123/200][0/194], Time 0.145 (0.145), Loss 0.0618 (0.0618)
11/16 11:03 EPOCH: 123 Train: Time 0.040 (0.043), Loss 0.1313 (0.1019)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 79.688 (79.688), Prec@5 95.312 (95.312)
11/16 11:03 EPOCH: 123 Val: Prec@1 77.010 Prec@5 98.290
11/16 11:03 many acc 76.00, med acc 81.05, few acc 0.00
Best Prec@1: 79.030

Epoch: [124/200][0/194], Time 0.137 (0.137), Loss 0.0376 (0.0376)
11/16 11:04 EPOCH: 124 Train: Time 0.040 (0.043), Loss 0.0423 (0.0885)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 92.188 (92.188), Prec@5 98.438 (98.438)
11/16 11:04 EPOCH: 124 Val: Prec@1 76.740 Prec@5 98.510
11/16 11:04 many acc 79.95, med acc 63.90, few acc 0.00
Best Prec@1: 79.030

Epoch: [125/200][0/194], Time 0.144 (0.144), Loss 0.0877 (0.0877)
11/16 11:04 EPOCH: 125 Train: Time 0.040 (0.043), Loss 0.0687 (0.0883)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 92.188 (92.188), Prec@5 95.312 (95.312)
11/16 11:04 EPOCH: 125 Val: Prec@1 74.660 Prec@5 98.300
11/16 11:04 many acc 76.74, med acc 66.35, few acc 0.00
Best Prec@1: 79.030

Epoch: [126/200][0/194], Time 0.135 (0.135), Loss 0.0970 (0.0970)
11/16 11:04 EPOCH: 126 Train: Time 0.040 (0.043), Loss 0.1081 (0.0971)
===> Calculating KNN centroids.
Test: [0/157], Time 0.117 (0.117), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/16 11:04 EPOCH: 126 Val: Prec@1 78.610 Prec@5 98.520
11/16 11:04 many acc 80.95, med acc 69.25, few acc 0.00
Best Prec@1: 79.030

Epoch: [127/200][0/194], Time 0.148 (0.148), Loss 0.0662 (0.0662)
11/16 11:04 EPOCH: 127 Train: Time 0.041 (0.043), Loss 0.1014 (0.0717)
===> Calculating KNN centroids.
Test: [0/157], Time 0.100 (0.100), Prec@1 92.188 (92.188), Prec@5 96.875 (96.875)
11/16 11:05 EPOCH: 127 Val: Prec@1 79.290 Prec@5 98.580
11/16 11:05 many acc 80.08, med acc 76.15, few acc 0.00
Best Prec@1: 79.290

Epoch: [128/200][0/194], Time 0.150 (0.150), Loss 0.0567 (0.0567)
11/16 11:05 EPOCH: 128 Train: Time 0.040 (0.043), Loss 0.1047 (0.0749)
===> Calculating KNN centroids.
Test: [0/157], Time 0.101 (0.101), Prec@1 92.188 (92.188), Prec@5 96.875 (96.875)
11/16 11:05 EPOCH: 128 Val: Prec@1 76.290 Prec@5 98.340
11/16 11:05 many acc 78.75, med acc 66.45, few acc 0.00
Best Prec@1: 79.290

Epoch: [129/200][0/194], Time 0.169 (0.169), Loss 0.1578 (0.1578)
11/16 11:05 EPOCH: 129 Train: Time 0.040 (0.043), Loss 0.0282 (0.0825)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 92.188 (92.188), Prec@5 96.875 (96.875)
11/16 11:05 EPOCH: 129 Val: Prec@1 75.150 Prec@5 97.960
11/16 11:05 many acc 77.34, med acc 66.40, few acc 0.00
Best Prec@1: 79.290

Epoch: [130/200][0/194], Time 0.134 (0.134), Loss 0.0940 (0.0940)
11/16 11:05 EPOCH: 130 Train: Time 0.040 (0.043), Loss 0.2025 (0.0784)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 89.062 (89.062), Prec@5 95.312 (95.312)
11/16 11:05 EPOCH: 130 Val: Prec@1 78.800 Prec@5 98.810
11/16 11:05 many acc 80.00, med acc 74.00, few acc 0.00
Best Prec@1: 79.290

Epoch: [131/200][0/194], Time 0.143 (0.143), Loss 0.1048 (0.1048)
11/16 11:06 EPOCH: 131 Train: Time 0.040 (0.043), Loss 0.0897 (0.0742)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_130.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_130.png
11/16 11:06 Loss:0.371, Acc:0.99, NC1:0.711,
Wnorm:[1.721,1.563,1.411,1.243,1.180,1.057,0.989,0.902,0.843,0.768]
Hnorm:[4.379,4.895,5.208,4.842,5.650,5.855,5.752,6.493,9.042,13.500]
Wcos:[-0.171,-0.143,-0.141,-0.112,-0.102,-0.084,-0.079,-0.064,-0.067,-0.053]
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 89.062 (89.062), Prec@5 98.438 (98.438)
11/16 11:06 EPOCH: 131 Val: Prec@1 76.980 Prec@5 98.620
11/16 11:06 many acc 78.44, med acc 71.15, few acc 0.00
Best Prec@1: 79.290

Epoch: [132/200][0/194], Time 0.138 (0.138), Loss 0.0297 (0.0297)
11/16 11:06 EPOCH: 132 Train: Time 0.040 (0.043), Loss 0.3124 (0.0637)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 98.438 (98.438), Prec@5 98.438 (98.438)
11/16 11:06 EPOCH: 132 Val: Prec@1 69.420 Prec@5 96.880
11/16 11:06 many acc 70.95, med acc 63.30, few acc 0.00
Best Prec@1: 79.290

Epoch: [133/200][0/194], Time 0.143 (0.143), Loss 0.0377 (0.0377)
11/16 11:06 EPOCH: 133 Train: Time 0.040 (0.043), Loss 0.0510 (0.0819)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 90.625 (90.625), Prec@5 98.438 (98.438)
11/16 11:06 EPOCH: 133 Val: Prec@1 81.520 Prec@5 98.900
11/16 11:06 many acc 83.00, med acc 75.60, few acc 0.00
Best Prec@1: 81.520

Epoch: [134/200][0/194], Time 0.139 (0.139), Loss 0.0556 (0.0556)
11/16 11:07 EPOCH: 134 Train: Time 0.040 (0.043), Loss 0.0476 (0.0633)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/16 11:07 EPOCH: 134 Val: Prec@1 78.640 Prec@5 98.650
11/16 11:07 many acc 79.69, med acc 74.45, few acc 0.00
Best Prec@1: 81.520

Epoch: [135/200][0/194], Time 0.139 (0.139), Loss 0.1249 (0.1249)
11/16 11:07 EPOCH: 135 Train: Time 0.040 (0.043), Loss 0.2134 (0.0736)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 92.188 (92.188), Prec@5 98.438 (98.438)
11/16 11:07 EPOCH: 135 Val: Prec@1 73.940 Prec@5 98.280
11/16 11:07 many acc 76.41, med acc 64.05, few acc 0.00
Best Prec@1: 81.520

Epoch: [136/200][0/194], Time 0.138 (0.138), Loss 0.0775 (0.0775)
11/16 11:07 EPOCH: 136 Train: Time 0.040 (0.043), Loss 0.1655 (0.0657)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/16 11:07 EPOCH: 136 Val: Prec@1 77.510 Prec@5 98.530
11/16 11:07 many acc 79.21, med acc 70.70, few acc 0.00
Best Prec@1: 81.520

Epoch: [137/200][0/194], Time 0.144 (0.144), Loss 0.0255 (0.0255)
11/16 11:07 EPOCH: 137 Train: Time 0.040 (0.043), Loss 0.0129 (0.0710)
===> Calculating KNN centroids.
Test: [0/157], Time 0.100 (0.100), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/16 11:08 EPOCH: 137 Val: Prec@1 78.620 Prec@5 98.670
11/16 11:08 many acc 81.42, med acc 67.40, few acc 0.00
Best Prec@1: 81.520

Epoch: [138/200][0/194], Time 0.140 (0.140), Loss 0.0640 (0.0640)
11/16 11:08 EPOCH: 138 Train: Time 0.040 (0.043), Loss 0.0168 (0.0624)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:08 EPOCH: 138 Val: Prec@1 78.730 Prec@5 98.810
11/16 11:08 many acc 80.85, med acc 70.25, few acc 0.00
Best Prec@1: 81.520

Epoch: [139/200][0/194], Time 0.138 (0.138), Loss 0.0196 (0.0196)
11/16 11:08 EPOCH: 139 Train: Time 0.040 (0.043), Loss 0.0120 (0.0485)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 96.875 (96.875), Prec@5 98.438 (98.438)
11/16 11:08 EPOCH: 139 Val: Prec@1 78.610 Prec@5 98.750
11/16 11:08 many acc 81.36, med acc 67.60, few acc 0.00
Best Prec@1: 81.520

Epoch: [140/200][0/194], Time 0.138 (0.138), Loss 0.0621 (0.0621)
11/16 11:08 EPOCH: 140 Train: Time 0.040 (0.043), Loss 0.0683 (0.0505)
===> Calculating KNN centroids.
Test: [0/157], Time 0.107 (0.107), Prec@1 90.625 (90.625), Prec@5 93.750 (93.750)
11/16 11:08 EPOCH: 140 Val: Prec@1 76.560 Prec@5 98.100
11/16 11:08 many acc 77.86, med acc 71.35, few acc 0.00
Best Prec@1: 81.520

Epoch: [141/200][0/194], Time 0.134 (0.134), Loss 0.0168 (0.0168)
11/16 11:09 EPOCH: 141 Train: Time 0.040 (0.043), Loss 0.0756 (0.0573)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_140.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_140.png
11/16 11:09 Loss:0.418, Acc:0.98, NC1:0.632,
Wnorm:[1.715,1.547,1.401,1.242,1.164,1.051,0.974,0.891,0.826,0.754]
Hnorm:[4.417,4.892,4.805,4.872,5.088,5.685,7.162,7.828,11.801,10.141]
Wcos:[-0.172,-0.144,-0.141,-0.113,-0.101,-0.085,-0.078,-0.064,-0.065,-0.051]
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 89.062 (89.062), Prec@5 98.438 (98.438)
11/16 11:09 EPOCH: 141 Val: Prec@1 78.230 Prec@5 98.400
11/16 11:09 many acc 78.89, med acc 75.60, few acc 0.00
Best Prec@1: 81.520

Epoch: [142/200][0/194], Time 0.141 (0.141), Loss 0.1283 (0.1283)
11/16 11:09 EPOCH: 142 Train: Time 0.041 (0.043), Loss 0.0257 (0.0538)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 92.188 (92.188), Prec@5 98.438 (98.438)
11/16 11:09 EPOCH: 142 Val: Prec@1 80.800 Prec@5 98.790
11/16 11:09 many acc 83.45, med acc 70.20, few acc 0.00
Best Prec@1: 81.520

Epoch: [143/200][0/194], Time 0.143 (0.143), Loss 0.0137 (0.0137)
11/16 11:09 EPOCH: 143 Train: Time 0.040 (0.043), Loss 0.0193 (0.0366)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 89.062 (89.062), Prec@5 96.875 (96.875)
11/16 11:09 EPOCH: 143 Val: Prec@1 77.430 Prec@5 98.710
11/16 11:09 many acc 80.90, med acc 63.55, few acc 0.00
Best Prec@1: 81.520

Epoch: [144/200][0/194], Time 0.140 (0.140), Loss 0.0209 (0.0209)
11/16 11:10 EPOCH: 144 Train: Time 0.040 (0.043), Loss 0.0199 (0.0417)
===> Calculating KNN centroids.
Test: [0/157], Time 0.100 (0.100), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/16 11:10 EPOCH: 144 Val: Prec@1 77.320 Prec@5 98.600
11/16 11:10 many acc 78.01, med acc 74.55, few acc 0.00
Best Prec@1: 81.520

Epoch: [145/200][0/194], Time 0.138 (0.138), Loss 0.0172 (0.0172)
11/16 11:10 EPOCH: 145 Train: Time 0.041 (0.044), Loss 0.0273 (0.0484)
===> Calculating KNN centroids.
Test: [0/157], Time 0.098 (0.098), Prec@1 87.500 (87.500), Prec@5 96.875 (96.875)
11/16 11:10 EPOCH: 145 Val: Prec@1 76.530 Prec@5 98.460
11/16 11:10 many acc 79.95, med acc 62.85, few acc 0.00
Best Prec@1: 81.520

Epoch: [146/200][0/194], Time 0.140 (0.140), Loss 0.0158 (0.0158)
11/16 11:10 EPOCH: 146 Train: Time 0.040 (0.044), Loss 0.0172 (0.0547)
===> Calculating KNN centroids.
Test: [0/157], Time 0.098 (0.098), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/16 11:10 EPOCH: 146 Val: Prec@1 79.630 Prec@5 98.800
11/16 11:10 many acc 82.00, med acc 70.15, few acc 0.00
Best Prec@1: 81.520

Epoch: [147/200][0/194], Time 0.130 (0.130), Loss 0.0932 (0.0932)
11/16 11:10 EPOCH: 147 Train: Time 0.040 (0.043), Loss 0.0449 (0.0455)
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 90.625 (90.625), Prec@5 98.438 (98.438)
11/16 11:11 EPOCH: 147 Val: Prec@1 79.260 Prec@5 98.800
11/16 11:11 many acc 81.60, med acc 69.90, few acc 0.00
Best Prec@1: 81.520

Epoch: [148/200][0/194], Time 0.157 (0.157), Loss 0.0366 (0.0366)
11/16 11:11 EPOCH: 148 Train: Time 0.040 (0.044), Loss 0.0215 (0.0335)
===> Calculating KNN centroids.
Test: [0/157], Time 0.118 (0.118), Prec@1 92.188 (92.188), Prec@5 96.875 (96.875)
11/16 11:11 EPOCH: 148 Val: Prec@1 79.720 Prec@5 98.640
11/16 11:11 many acc 81.70, med acc 71.80, few acc 0.00
Best Prec@1: 81.520

Epoch: [149/200][0/194], Time 0.145 (0.145), Loss 0.0185 (0.0185)
11/16 11:11 EPOCH: 149 Train: Time 0.041 (0.044), Loss 0.0170 (0.0238)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/16 11:11 EPOCH: 149 Val: Prec@1 77.560 Prec@5 98.610
11/16 11:11 many acc 81.61, med acc 61.35, few acc 0.00
Best Prec@1: 81.520

Epoch: [150/200][0/194], Time 0.141 (0.141), Loss 0.0076 (0.0076)
11/16 11:11 EPOCH: 150 Train: Time 0.040 (0.043), Loss 0.0238 (0.0253)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 90.625 (90.625), Prec@5 98.438 (98.438)
11/16 11:11 EPOCH: 150 Val: Prec@1 77.680 Prec@5 98.450
11/16 11:11 many acc 80.44, med acc 66.65, few acc 0.00
Best Prec@1: 81.520

Epoch: [151/200][0/194], Time 0.126 (0.126), Loss 0.0415 (0.0415)
11/16 11:12 EPOCH: 151 Train: Time 0.040 (0.043), Loss 0.0329 (0.0279)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_150.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_150.png
11/16 11:12 Loss:0.133, Acc:1.00, NC1:0.286,
Wnorm:[1.701,1.529,1.390,1.236,1.146,1.035,0.956,0.875,0.808,0.741]
Hnorm:[4.558,4.930,4.910,5.295,5.728,6.478,7.051,7.045,10.568,11.263]
Wcos:[-0.173,-0.145,-0.140,-0.113,-0.101,-0.084,-0.076,-0.063,-0.062,-0.049]
===> Calculating KNN centroids.
Test: [0/157], Time 0.108 (0.108), Prec@1 92.188 (92.188), Prec@5 98.438 (98.438)
11/16 11:12 EPOCH: 151 Val: Prec@1 79.320 Prec@5 98.830
11/16 11:12 many acc 81.25, med acc 71.60, few acc 0.00
Best Prec@1: 81.520

Epoch: [152/200][0/194], Time 0.140 (0.140), Loss 0.0200 (0.0200)
11/16 11:12 EPOCH: 152 Train: Time 0.040 (0.043), Loss 0.0278 (0.0264)
===> Calculating KNN centroids.
Test: [0/157], Time 0.119 (0.119), Prec@1 90.625 (90.625), Prec@5 96.875 (96.875)
11/16 11:12 EPOCH: 152 Val: Prec@1 80.960 Prec@5 98.810
11/16 11:12 many acc 83.29, med acc 71.65, few acc 0.00
Best Prec@1: 81.520

Epoch: [153/200][0/194], Time 0.144 (0.144), Loss 0.0585 (0.0585)
11/16 11:12 EPOCH: 153 Train: Time 0.041 (0.043), Loss 0.0121 (0.0245)
===> Calculating KNN centroids.
Test: [0/157], Time 0.097 (0.097), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/16 11:12 EPOCH: 153 Val: Prec@1 81.160 Prec@5 98.790
11/16 11:12 many acc 82.19, med acc 77.05, few acc 0.00
Best Prec@1: 81.520

Epoch: [154/200][0/194], Time 0.142 (0.142), Loss 0.0090 (0.0090)
11/16 11:13 EPOCH: 154 Train: Time 0.041 (0.043), Loss 0.0105 (0.0207)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:13 EPOCH: 154 Val: Prec@1 80.580 Prec@5 98.720
11/16 11:13 many acc 82.12, med acc 74.40, few acc 0.00
Best Prec@1: 81.520

Epoch: [155/200][0/194], Time 0.145 (0.145), Loss 0.0075 (0.0075)
11/16 11:13 EPOCH: 155 Train: Time 0.040 (0.043), Loss 0.0195 (0.0187)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/16 11:13 EPOCH: 155 Val: Prec@1 80.670 Prec@5 98.890
11/16 11:13 many acc 83.47, med acc 69.45, few acc 0.00
Best Prec@1: 81.520

Epoch: [156/200][0/194], Time 0.139 (0.139), Loss 0.0069 (0.0069)
11/16 11:13 EPOCH: 156 Train: Time 0.040 (0.043), Loss 0.0142 (0.0180)
===> Calculating KNN centroids.
Test: [0/157], Time 0.114 (0.114), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:13 EPOCH: 156 Val: Prec@1 79.970 Prec@5 98.890
11/16 11:13 many acc 82.30, med acc 70.65, few acc 0.00
Best Prec@1: 81.520

Epoch: [157/200][0/194], Time 0.139 (0.139), Loss 0.0068 (0.0068)
11/16 11:13 EPOCH: 157 Train: Time 0.041 (0.043), Loss 0.0993 (0.0206)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 87.500 (87.500), Prec@5 93.750 (93.750)
11/16 11:14 EPOCH: 157 Val: Prec@1 79.420 Prec@5 98.640
11/16 11:14 many acc 81.15, med acc 72.50, few acc 0.00
Best Prec@1: 81.520

Epoch: [158/200][0/194], Time 0.129 (0.129), Loss 0.0124 (0.0124)
11/16 11:14 EPOCH: 158 Train: Time 0.040 (0.043), Loss 0.0172 (0.0228)
===> Calculating KNN centroids.
Test: [0/157], Time 0.116 (0.116), Prec@1 96.875 (96.875), Prec@5 98.438 (98.438)
11/16 11:14 EPOCH: 158 Val: Prec@1 81.600 Prec@5 98.860
11/16 11:14 many acc 84.54, med acc 69.85, few acc 0.00
Best Prec@1: 81.600

Epoch: [159/200][0/194], Time 0.139 (0.139), Loss 0.0285 (0.0285)
11/16 11:14 EPOCH: 159 Train: Time 0.040 (0.043), Loss 0.0120 (0.0195)
===> Calculating KNN centroids.
Test: [0/157], Time 0.111 (0.111), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:14 EPOCH: 159 Val: Prec@1 80.220 Prec@5 98.830
11/16 11:14 many acc 83.00, med acc 69.10, few acc 0.00
Best Prec@1: 81.600

Epoch: [160/200][0/194], Time 0.141 (0.141), Loss 0.0136 (0.0136)
11/16 11:14 EPOCH: 160 Train: Time 0.040 (0.043), Loss 0.0060 (0.0161)
===> Calculating KNN centroids.
Test: [0/157], Time 0.117 (0.117), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/16 11:14 EPOCH: 160 Val: Prec@1 80.890 Prec@5 98.880
11/16 11:14 many acc 82.80, med acc 73.25, few acc 0.00
Best Prec@1: 81.600

Epoch: [161/200][0/194], Time 0.138 (0.138), Loss 0.0073 (0.0073)
11/16 11:15 EPOCH: 161 Train: Time 0.040 (0.043), Loss 0.0108 (0.0155)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_160.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_160.png
11/16 11:15 Loss:0.061, Acc:1.00, NC1:0.134,
Wnorm:[1.687,1.506,1.372,1.219,1.124,1.017,0.937,0.858,0.795,0.728]
Hnorm:[4.734,4.955,5.258,5.373,6.066,6.372,7.030,8.050,10.570,11.864]
Wcos:[-0.175,-0.146,-0.140,-0.113,-0.100,-0.084,-0.075,-0.062,-0.061,-0.048]
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 92.188 (92.188), Prec@5 98.438 (98.438)
11/16 11:15 EPOCH: 161 Val: Prec@1 80.420 Prec@5 98.890
11/16 11:15 many acc 83.32, med acc 68.80, few acc 0.00
Best Prec@1: 81.600

Epoch: [162/200][0/194], Time 0.145 (0.145), Loss 0.0083 (0.0083)
11/16 11:15 EPOCH: 162 Train: Time 0.041 (0.043), Loss 0.0085 (0.0132)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/16 11:15 EPOCH: 162 Val: Prec@1 82.250 Prec@5 98.930
11/16 11:15 many acc 83.35, med acc 77.85, few acc 0.00
Best Prec@1: 82.250

Epoch: [163/200][0/194], Time 0.128 (0.128), Loss 0.0177 (0.0177)
11/16 11:15 EPOCH: 163 Train: Time 0.041 (0.043), Loss 0.0151 (0.0122)
===> Calculating KNN centroids.
Test: [0/157], Time 0.095 (0.095), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:15 EPOCH: 163 Val: Prec@1 81.240 Prec@5 99.000
11/16 11:15 many acc 84.76, med acc 67.15, few acc 0.00
Best Prec@1: 82.250

Epoch: [164/200][0/194], Time 0.138 (0.138), Loss 0.0075 (0.0075)
11/16 11:16 EPOCH: 164 Train: Time 0.041 (0.043), Loss 0.0171 (0.0118)
===> Calculating KNN centroids.
Test: [0/157], Time 0.119 (0.119), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/16 11:16 EPOCH: 164 Val: Prec@1 80.730 Prec@5 98.950
11/16 11:16 many acc 82.75, med acc 72.65, few acc 0.00
Best Prec@1: 82.250

Epoch: [165/200][0/194], Time 0.146 (0.146), Loss 0.0081 (0.0081)
11/16 11:16 EPOCH: 165 Train: Time 0.041 (0.043), Loss 0.0141 (0.0111)
===> Calculating KNN centroids.
Test: [0/157], Time 0.114 (0.114), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/16 11:16 EPOCH: 165 Val: Prec@1 81.670 Prec@5 99.030
11/16 11:16 many acc 84.29, med acc 71.20, few acc 0.00
Best Prec@1: 82.250

Epoch: [166/200][0/194], Time 0.135 (0.135), Loss 0.0054 (0.0054)
11/16 11:16 EPOCH: 166 Train: Time 0.040 (0.043), Loss 0.0115 (0.0109)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:16 EPOCH: 166 Val: Prec@1 82.230 Prec@5 99.050
11/16 11:16 many acc 85.33, med acc 69.85, few acc 0.00
Best Prec@1: 82.250

Epoch: [167/200][0/194], Time 0.165 (0.165), Loss 0.0069 (0.0069)
11/16 11:16 EPOCH: 167 Train: Time 0.040 (0.043), Loss 0.0172 (0.0106)
===> Calculating KNN centroids.
Test: [0/157], Time 0.108 (0.108), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:17 EPOCH: 167 Val: Prec@1 80.980 Prec@5 99.050
11/16 11:17 many acc 84.95, med acc 65.10, few acc 0.00
Best Prec@1: 82.250

Epoch: [168/200][0/194], Time 0.143 (0.143), Loss 0.0068 (0.0068)
11/16 11:17 EPOCH: 168 Train: Time 0.040 (0.043), Loss 0.0094 (0.0095)
===> Calculating KNN centroids.
Test: [0/157], Time 0.114 (0.114), Prec@1 96.875 (96.875), Prec@5 98.438 (98.438)
11/16 11:17 EPOCH: 168 Val: Prec@1 81.930 Prec@5 99.000
11/16 11:17 many acc 84.91, med acc 70.00, few acc 0.00
Best Prec@1: 82.250

Epoch: [169/200][0/194], Time 0.145 (0.145), Loss 0.0068 (0.0068)
11/16 11:17 EPOCH: 169 Train: Time 0.040 (0.043), Loss 0.0081 (0.0107)
===> Calculating KNN centroids.
Test: [0/157], Time 0.110 (0.110), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:17 EPOCH: 169 Val: Prec@1 82.150 Prec@5 98.910
11/16 11:17 many acc 85.05, med acc 70.55, few acc 0.00
Best Prec@1: 82.250

Epoch: [170/200][0/194], Time 0.139 (0.139), Loss 0.0056 (0.0056)
11/16 11:17 EPOCH: 170 Train: Time 0.041 (0.043), Loss 0.0186 (0.0100)
===> Calculating KNN centroids.
Test: [0/157], Time 0.106 (0.106), Prec@1 93.750 (93.750), Prec@5 96.875 (96.875)
11/16 11:17 EPOCH: 170 Val: Prec@1 81.420 Prec@5 99.040
11/16 11:17 many acc 84.82, med acc 67.80, few acc 0.00
Best Prec@1: 82.250

Epoch: [171/200][0/194], Time 0.137 (0.137), Loss 0.0067 (0.0067)
11/16 11:18 EPOCH: 171 Train: Time 0.040 (0.043), Loss 0.0062 (0.0095)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_170.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_170.png
11/16 11:18 Loss:0.038, Acc:1.00, NC1:0.055,
Wnorm:[1.672,1.488,1.357,1.204,1.106,1.001,0.920,0.844,0.782,0.718]
Hnorm:[4.798,5.081,5.157,5.528,6.076,6.820,7.277,8.334,8.978,11.886]
Wcos:[-0.176,-0.146,-0.140,-0.113,-0.099,-0.083,-0.075,-0.062,-0.060,-0.047]
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/16 11:18 EPOCH: 171 Val: Prec@1 80.580 Prec@5 99.090
11/16 11:18 many acc 84.32, med acc 65.60, few acc 0.00
Best Prec@1: 82.250

Epoch: [172/200][0/194], Time 0.142 (0.142), Loss 0.0121 (0.0121)
11/16 11:18 EPOCH: 172 Train: Time 0.040 (0.043), Loss 0.0079 (0.0104)
===> Calculating KNN centroids.
Test: [0/157], Time 0.098 (0.098), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:18 EPOCH: 172 Val: Prec@1 81.300 Prec@5 98.980
11/16 11:18 many acc 84.29, med acc 69.35, few acc 0.00
Best Prec@1: 82.250

Epoch: [173/200][0/194], Time 0.138 (0.138), Loss 0.0120 (0.0120)
11/16 11:18 EPOCH: 173 Train: Time 0.040 (0.043), Loss 0.0130 (0.0100)
===> Calculating KNN centroids.
Test: [0/157], Time 0.118 (0.118), Prec@1 96.875 (96.875), Prec@5 98.438 (98.438)
11/16 11:18 EPOCH: 173 Val: Prec@1 82.020 Prec@5 98.980
11/16 11:18 many acc 84.97, med acc 70.20, few acc 0.00
Best Prec@1: 82.250

Epoch: [174/200][0/194], Time 0.137 (0.137), Loss 0.0063 (0.0063)
11/16 11:19 EPOCH: 174 Train: Time 0.040 (0.043), Loss 0.0059 (0.0105)
===> Calculating KNN centroids.
Test: [0/157], Time 0.107 (0.107), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:19 EPOCH: 174 Val: Prec@1 82.060 Prec@5 99.100
11/16 11:19 many acc 84.96, med acc 70.45, few acc 0.00
Best Prec@1: 82.250

Epoch: [175/200][0/194], Time 0.138 (0.138), Loss 0.0217 (0.0217)
11/16 11:19 EPOCH: 175 Train: Time 0.040 (0.043), Loss 0.0094 (0.0095)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:19 EPOCH: 175 Val: Prec@1 82.820 Prec@5 99.080
11/16 11:19 many acc 85.69, med acc 71.35, few acc 0.00
Best Prec@1: 82.820

Epoch: [176/200][0/194], Time 0.128 (0.128), Loss 0.0127 (0.0127)
11/16 11:19 EPOCH: 176 Train: Time 0.040 (0.043), Loss 0.0103 (0.0102)
===> Calculating KNN centroids.
Test: [0/157], Time 0.100 (0.100), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:19 EPOCH: 176 Val: Prec@1 82.610 Prec@5 99.020
11/16 11:19 many acc 85.51, med acc 71.00, few acc 0.00
Best Prec@1: 82.820

Epoch: [177/200][0/194], Time 0.152 (0.152), Loss 0.0076 (0.0076)
11/16 11:19 EPOCH: 177 Train: Time 0.041 (0.043), Loss 0.0070 (0.0096)
===> Calculating KNN centroids.
Test: [0/157], Time 0.109 (0.109), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/16 11:20 EPOCH: 177 Val: Prec@1 82.380 Prec@5 99.090
11/16 11:20 many acc 85.15, med acc 71.30, few acc 0.00
Best Prec@1: 82.820

Epoch: [178/200][0/194], Time 0.140 (0.140), Loss 0.0081 (0.0081)
11/16 11:20 EPOCH: 178 Train: Time 0.040 (0.043), Loss 0.0066 (0.0091)
===> Calculating KNN centroids.
Test: [0/157], Time 0.100 (0.100), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:20 EPOCH: 178 Val: Prec@1 82.350 Prec@5 99.120
11/16 11:20 many acc 84.91, med acc 72.10, few acc 0.00
Best Prec@1: 82.820

Epoch: [179/200][0/194], Time 0.137 (0.137), Loss 0.0138 (0.0138)
11/16 11:20 EPOCH: 179 Train: Time 0.041 (0.043), Loss 0.0090 (0.0097)
===> Calculating KNN centroids.
Test: [0/157], Time 0.100 (0.100), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:20 EPOCH: 179 Val: Prec@1 81.430 Prec@5 99.120
11/16 11:20 many acc 84.19, med acc 70.40, few acc 0.00
Best Prec@1: 82.820

Epoch: [180/200][0/194], Time 0.143 (0.143), Loss 0.0124 (0.0124)
11/16 11:20 EPOCH: 180 Train: Time 0.040 (0.043), Loss 0.0092 (0.0095)
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:20 EPOCH: 180 Val: Prec@1 81.620 Prec@5 99.080
11/16 11:20 many acc 84.76, med acc 69.05, few acc 0.00
Best Prec@1: 82.820

Epoch: [181/200][0/194], Time 0.139 (0.139), Loss 0.0073 (0.0073)
11/16 11:21 EPOCH: 181 Train: Time 0.040 (0.043), Loss 0.0087 (0.0091)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_180.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_180.png
11/16 11:21 Loss:0.037, Acc:1.00, NC1:0.043,
Wnorm:[1.664,1.479,1.349,1.196,1.097,0.993,0.912,0.838,0.777,0.713]
Hnorm:[4.889,5.090,5.402,5.649,6.190,6.584,7.683,8.044,10.233,13.251]
Wcos:[-0.176,-0.147,-0.140,-0.113,-0.099,-0.083,-0.074,-0.061,-0.060,-0.047]
===> Calculating KNN centroids.
Test: [0/157], Time 0.103 (0.103), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:21 EPOCH: 181 Val: Prec@1 82.030 Prec@5 99.110
11/16 11:21 many acc 85.10, med acc 69.75, few acc 0.00
Best Prec@1: 82.820

Epoch: [182/200][0/194], Time 0.127 (0.127), Loss 0.0191 (0.0191)
11/16 11:21 EPOCH: 182 Train: Time 0.040 (0.043), Loss 0.0073 (0.0094)
===> Calculating KNN centroids.
Test: [0/157], Time 0.100 (0.100), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:21 EPOCH: 182 Val: Prec@1 81.770 Prec@5 99.090
11/16 11:21 many acc 85.33, med acc 67.55, few acc 0.00
Best Prec@1: 82.820

Epoch: [183/200][0/194], Time 0.136 (0.136), Loss 0.0061 (0.0061)
11/16 11:21 EPOCH: 183 Train: Time 0.040 (0.043), Loss 0.0095 (0.0096)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:21 EPOCH: 183 Val: Prec@1 82.090 Prec@5 99.080
11/16 11:21 many acc 85.53, med acc 68.35, few acc 0.00
Best Prec@1: 82.820

Epoch: [184/200][0/194], Time 0.139 (0.139), Loss 0.0155 (0.0155)
11/16 11:22 EPOCH: 184 Train: Time 0.040 (0.043), Loss 0.0072 (0.0093)
===> Calculating KNN centroids.
Test: [0/157], Time 0.116 (0.116), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:22 EPOCH: 184 Val: Prec@1 82.900 Prec@5 99.060
11/16 11:22 many acc 85.37, med acc 73.00, few acc 0.00
Best Prec@1: 82.900

Epoch: [185/200][0/194], Time 0.141 (0.141), Loss 0.0078 (0.0078)
11/16 11:22 EPOCH: 185 Train: Time 0.041 (0.043), Loss 0.0154 (0.0088)
===> Calculating KNN centroids.
Test: [0/157], Time 0.119 (0.119), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:22 EPOCH: 185 Val: Prec@1 82.190 Prec@5 99.120
11/16 11:22 many acc 85.31, med acc 69.70, few acc 0.00
Best Prec@1: 82.900

Epoch: [186/200][0/194], Time 0.151 (0.151), Loss 0.0057 (0.0057)
11/16 11:22 EPOCH: 186 Train: Time 0.040 (0.043), Loss 0.0057 (0.0091)
===> Calculating KNN centroids.
Test: [0/157], Time 0.099 (0.099), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:22 EPOCH: 186 Val: Prec@1 82.660 Prec@5 99.100
11/16 11:22 many acc 85.46, med acc 71.45, few acc 0.00
Best Prec@1: 82.900

Epoch: [187/200][0/194], Time 0.141 (0.141), Loss 0.0086 (0.0086)
11/16 11:22 EPOCH: 187 Train: Time 0.041 (0.043), Loss 0.0071 (0.0083)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:23 EPOCH: 187 Val: Prec@1 81.970 Prec@5 99.070
11/16 11:23 many acc 85.29, med acc 68.70, few acc 0.00
Best Prec@1: 82.900

Epoch: [188/200][0/194], Time 0.138 (0.138), Loss 0.0071 (0.0071)
11/16 11:23 EPOCH: 188 Train: Time 0.040 (0.043), Loss 0.0122 (0.0089)
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:23 EPOCH: 188 Val: Prec@1 82.930 Prec@5 99.120
11/16 11:23 many acc 85.66, med acc 72.00, few acc 0.00
Best Prec@1: 82.930

Epoch: [189/200][0/194], Time 0.137 (0.137), Loss 0.0127 (0.0127)
11/16 11:23 EPOCH: 189 Train: Time 0.040 (0.043), Loss 0.0075 (0.0087)
===> Calculating KNN centroids.
Test: [0/157], Time 0.116 (0.116), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:23 EPOCH: 189 Val: Prec@1 82.740 Prec@5 99.070
11/16 11:23 many acc 85.46, med acc 71.85, few acc 0.00
Best Prec@1: 82.930

Epoch: [190/200][0/194], Time 0.128 (0.128), Loss 0.0054 (0.0054)
11/16 11:23 EPOCH: 190 Train: Time 0.041 (0.043), Loss 0.0061 (0.0093)
===> Calculating KNN centroids.
Test: [0/157], Time 0.113 (0.113), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:23 EPOCH: 190 Val: Prec@1 82.030 Prec@5 99.040
11/16 11:23 many acc 85.37, med acc 68.65, few acc 0.00
Best Prec@1: 82.930

Epoch: [191/200][0/194], Time 0.150 (0.150), Loss 0.0079 (0.0079)
11/16 11:24 EPOCH: 191 Train: Time 0.040 (0.043), Loss 0.0085 (0.0094)
Saved cosine similarity heatmap to: /scratch/hy2611/GLMC/VS_plot/cosine_similarity_heatmap_epoch_190.png
Saved Wi and Hi cosine similarity plot to: /scratch/hy2611/GLMC/VS_plot/Wi_Hi_cosine_similarity_epoch_190.png
11/16 11:24 Loss:0.037, Acc:1.00, NC1:0.038,
Wnorm:[1.661,1.476,1.346,1.193,1.094,0.990,0.910,0.835,0.775,0.711]
Hnorm:[4.981,5.220,5.426,5.855,6.348,6.903,7.610,9.172,10.095,14.589]
Wcos:[-0.177,-0.147,-0.140,-0.112,-0.099,-0.083,-0.074,-0.061,-0.060,-0.047]
===> Calculating KNN centroids.
Test: [0/157], Time 0.094 (0.094), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:24 EPOCH: 191 Val: Prec@1 82.610 Prec@5 99.050
11/16 11:24 many acc 85.62, med acc 70.55, few acc 0.00
Best Prec@1: 82.930

Epoch: [192/200][0/194], Time 0.136 (0.136), Loss 0.0098 (0.0098)
11/16 11:24 EPOCH: 192 Train: Time 0.040 (0.043), Loss 0.0089 (0.0091)
===> Calculating KNN centroids.
Test: [0/157], Time 0.101 (0.101), Prec@1 93.750 (93.750), Prec@5 98.438 (98.438)
11/16 11:24 EPOCH: 192 Val: Prec@1 83.010 Prec@5 99.060
11/16 11:24 many acc 85.81, med acc 71.80, few acc 0.00
Best Prec@1: 83.010

Epoch: [193/200][0/194], Time 0.146 (0.146), Loss 0.0064 (0.0064)
11/16 11:24 EPOCH: 193 Train: Time 0.040 (0.043), Loss 0.0102 (0.0089)
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:24 EPOCH: 193 Val: Prec@1 82.290 Prec@5 99.040
11/16 11:24 many acc 85.43, med acc 69.75, few acc 0.00
Best Prec@1: 83.010

Epoch: [194/200][0/194], Time 0.135 (0.135), Loss 0.0203 (0.0203)
11/16 11:25 EPOCH: 194 Train: Time 0.041 (0.043), Loss 0.0050 (0.0096)
===> Calculating KNN centroids.
Test: [0/157], Time 0.120 (0.120), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:25 EPOCH: 194 Val: Prec@1 81.760 Prec@5 99.060
11/16 11:25 many acc 85.56, med acc 66.55, few acc 0.00
Best Prec@1: 83.010

Epoch: [195/200][0/194], Time 0.129 (0.129), Loss 0.0056 (0.0056)
11/16 11:25 EPOCH: 195 Train: Time 0.040 (0.043), Loss 0.0130 (0.0096)
===> Calculating KNN centroids.
Test: [0/157], Time 0.107 (0.107), Prec@1 95.312 (95.312), Prec@5 96.875 (96.875)
11/16 11:25 EPOCH: 195 Val: Prec@1 82.090 Prec@5 99.110
11/16 11:25 many acc 85.62, med acc 67.95, few acc 0.00
Best Prec@1: 83.010

Epoch: [196/200][0/194], Time 0.143 (0.143), Loss 0.0088 (0.0088)
11/16 11:25 EPOCH: 196 Train: Time 0.040 (0.043), Loss 0.0108 (0.0089)
===> Calculating KNN centroids.
Test: [0/157], Time 0.109 (0.109), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:25 EPOCH: 196 Val: Prec@1 81.510 Prec@5 99.020
11/16 11:25 many acc 85.21, med acc 66.70, few acc 0.00
Best Prec@1: 83.010

Epoch: [197/200][0/194], Time 0.130 (0.130), Loss 0.0094 (0.0094)
11/16 11:25 EPOCH: 197 Train: Time 0.040 (0.043), Loss 0.0077 (0.0088)
===> Calculating KNN centroids.
Test: [0/157], Time 0.115 (0.115), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:26 EPOCH: 197 Val: Prec@1 82.570 Prec@5 99.030
11/16 11:26 many acc 85.54, med acc 70.70, few acc 0.00
Best Prec@1: 83.010

Epoch: [198/200][0/194], Time 0.145 (0.145), Loss 0.0056 (0.0056)
11/16 11:26 EPOCH: 198 Train: Time 0.040 (0.043), Loss 0.0066 (0.0093)
===> Calculating KNN centroids.
Test: [0/157], Time 0.102 (0.102), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:26 EPOCH: 198 Val: Prec@1 82.800 Prec@5 99.050
11/16 11:26 many acc 85.64, med acc 71.45, few acc 0.00
Best Prec@1: 83.010

Epoch: [199/200][0/194], Time 0.144 (0.144), Loss 0.0117 (0.0117)
11/16 11:26 EPOCH: 199 Train: Time 0.040 (0.043), Loss 0.0061 (0.0084)
===> Calculating KNN centroids.
Test: [0/157], Time 0.104 (0.104), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:26 EPOCH: 199 Val: Prec@1 81.950 Prec@5 99.010
11/16 11:26 many acc 85.11, med acc 69.30, few acc 0.00
Best Prec@1: 83.010

Epoch: [200/200][0/194], Time 0.133 (0.133), Loss 0.0107 (0.0107)
11/16 11:26 EPOCH: 200 Train: Time 0.040 (0.043), Loss 0.0085 (0.0087)
===> Calculating KNN centroids.
Test: [0/157], Time 0.105 (0.105), Prec@1 95.312 (95.312), Prec@5 98.438 (98.438)
11/16 11:26 EPOCH: 200 Val: Prec@1 82.390 Prec@5 99.120
11/16 11:26 many acc 85.34, med acc 70.60, few acc 0.00
Best Prec@1: 83.010

It took 1:00:15.68 to execute the program
